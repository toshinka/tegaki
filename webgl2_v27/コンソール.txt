config.js:509 âœ… config.js v8.14.3 Phase 1.7 ç­†åœ§å¯¾å¿œç‰ˆ loaded
config.js:510    ğŸ”§ thinning: 0.7 (ç­†åœ§ã«ã‚ˆã‚‹å¤ªã•å¤‰åŒ–æœ‰åŠ¹)
config.js:511    ğŸ”§ smoothing: 0.4 (é©åº¦ãªè£œé–“)
    ğŸ”§ streamline: 0.3 (å®‰å®šåŒ–)
 âœ… coordinate-system.js Phase 1.3 åˆæœŸåŒ–å¤±æ•—è¨ºæ–­å¼·åŒ–ç‰ˆ loaded
    ğŸ”§ worldContaineré…å»¶å–å¾—å¯¾å¿œ
    ğŸ”§ åˆæœŸåŒ–å¤±æ•—æ™‚ã®è©³ç´°è¨ºæ–­ãƒ­ã‚°è¿½åŠ 
    ğŸ”§ dumpState()ãƒ‡ãƒãƒƒã‚°ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
 âœ… data-models.js (backgroundColorè¿½åŠ ç‰ˆ) loaded
 âœ… batch-api.js (Phase 6: Historyçµ±åˆç‰ˆ) loaded
 âœ… popup-manager.js (quick-accessé™¤å¤–å¯¾å¿œç‰ˆ) loaded
 âœ… state-manager.js (Phase 8å®Œå…¨å®Ÿè£…ç‰ˆ) loaded
 âœ… settings-manager.js Phase 2 loaded
    ğŸ”§ exportResolution è¨­å®šé …ç›®è¿½åŠ 
 âœ… layer-transform.js Phase 6 loaded
    ğŸ”§ flipLayer(): confirmTransform()å‰Šé™¤ - åè»¢æ™‚ã®ç”»åƒæ¶ˆå¤±ã‚’è§£æ±º
 âœ… system/checker-utils.js çµ±ä¸€å®Ÿè£…ç‰ˆ loaded
 âœ… layer-system.js Phase 8å®Œæˆç‰ˆ loaded
    âœ… getLayerById() ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
    âœ… LayerModel.id ç¢ºå®Ÿå–å¾—ä¿è¨¼
    âœ… history.js ã¨ã®çµ±åˆå¯¾å¿œå®Œäº†
 âœ… drawing-clipboard.js Phase 1 loaded
    ğŸ”§ cutActiveLayer(): æç”»ã®ã¿å‰Šé™¤ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ä¿æŒï¼‰
    ğŸ¨ ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ”ãƒ¼ã€åˆ‡ã‚Šå–ã‚Š
 âœ… history.js Phase 4 mask snapshotå¯¾å¿œå®Œå…¨ç‰ˆ loaded
    âœ… pushEraseMask() å®Ÿè£…
    âœ… beginAction/endAction/addPoint å®Ÿè£…
 âœ… gl-texture-bridge.js Phase 5å®Œå…¨ç‰ˆ (PixiJS v8å¯¾å¿œ) loaded
    âœ… WebGLTexture â†’ PIXI.Spriteå¤‰æ›å®Ÿè£…å®Œäº†
    âœ… PixiJS v8: Texture.from()ç›´æ¥ä½¿ç”¨ï¼ˆå®šæ•°å•é¡Œè§£æ±ºï¼‰
    âœ… WebGPUäº’æ›API (createSpriteFromGPUTexture) å¯¾å¿œ
 [GLMSDFPipeline] âœ… Phase 1.8 Rollbackä¿®æ­£ç‰ˆ loaded
    âš ï¸ Phase 1.7ã®éå‰°ä¿®æ­£ã‚’å–ã‚Šæ¶ˆã—
    âœ… aPosition: [0, bounds.width/height] â†’ uResolutionã§æ­£è¦åŒ–
 [GLStrokeProcessor] âœ… Singleton instance created
 âœ… webgl2-drawing-layer.js Phase 1 å®Œå…¨ä¿®æ­£ç‰ˆ loaded
    ğŸ“Œ window.WebGLContext (ä¸»è¦)
    ğŸ“Œ window.WebGL2DrawingLayer (äº’æ›)
 âœ… gl-mask-layer.js Phase 6å®Œå…¨ç‰ˆ loaded
    âœ… Circle mask renderingå®Ÿè£…
    âœ… Additive blendå¯¾å¿œ
    âœ… Compose Passçµ±åˆæº–å‚™å®Œäº†
 âœ… pointer-handler.js Phase 1 loaded
    ğŸ”§ pressureæ­£è¦åŒ–ä¿®æ­£ï¼ˆãƒã‚¦ã‚¹=0, ãƒšãƒ³=e.pressureï¼‰
    ğŸ”§ EventEmitteré¢¨APIå®Ÿè£…ï¼ˆ.on / .offï¼‰
 âœ… pressure-handler.js Phase 1 loaded
    ğŸ”§ ãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ³æœªç¢ºå®šæ™‚ã«rawå€¤è¿”å´ï¼ˆ0.5å›ºå®šå‰Šé™¤ï¼‰
 âœ… stroke-recorder.js Phase 0 loaded
    âœ“ è‡ªå‹•åˆæœŸåŒ–å®Œäº†ï¼ˆinitialize()ä¸è¦ï¼‰
    âœ“ Localåº§æ¨™è¨˜éŒ²å°‚ç”¨ï¼ˆåº§æ¨™å¤‰æ›ãªã—ï¼‰
    âœ“ PerfectFreehandäº’æ›å½¢å¼å¯¾å¿œ
 âœ… stroke-renderer.js (WebGL2ç§»è¡Œç‰ˆ) loaded
    ğŸ”§ WebGPU â†’ WebGL2 å‚ç…§å¤‰æ›´å®Œäº†
 âœ… thumbnail-system.js (v1.1: çµ±ä¸€ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”å¯¾å¿œ) loaded
 âœ… brush-settings.js (Phase 3-D Clean) loaded
 âœ… BlendMode definitions loaded
 âœ… vector-operations.js Phase 1å®Œå…¨ç‰ˆ loaded
    âœ“ window.VectorOperations.generateStrokePolygon(points, size)
    âœ“ config.js perfectFreehandè¨­å®šè‡ªå‹•é©ç”¨
    ğŸ”¥ PerfectFreehandçµ±åˆåŸºç›¤å®Œæˆ
brush-core.js:739 âœ… brush-core.js Phase 2.2 åº§æ¨™ã‚ºãƒ¬å®Œå…¨ä¿®æ­£ç‰ˆ loaded
brush-core.js:740    âœ… Spriteã‚¹ã‚±ãƒ¼ãƒ«ä¿®æ­£: 512å›ºå®š â†’ bounds.width/height
brush-core.js:741    âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼é€æ˜åº¦: å®Ÿéš›ã®å€¤ã«ä¿®æ­£
brush-core.js:742    âœ… ãƒ†ã‚¯ã‚¹ãƒãƒ£å†åˆ©ç”¨ç¶­æŒ
fill-tool.js:269 âœ… fill-tool.js (WebGPUç«¶åˆä¿®æ­£ç‰ˆ) loaded
fill-tool.js:270    âŒ ç‹¬è‡ªWebGPUåˆæœŸåŒ–ã‚’å‰Šé™¤
fill-tool.js:271    âœ… æ—¢å­˜ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å‚ç…§ã®ã¿
drawing-engine.js:678 âœ… drawing-engine.js v8.14.2 Phase 1.1 åº§æ¨™ã‚ºãƒ¬å®Œå…¨ä¿®æ­£ç‰ˆ loaded
drawing-engine.js:679    ğŸ”§ CoordinateSystemåˆæœŸåŒ–è‡ªå‹•ä¿®å¾©æ©Ÿèƒ½è¿½åŠ 
drawing-engine.js:680    ğŸ”§ NaN/Infinityæ¤œå‡ºå¼·åŒ–ï¼ˆå…¨ã‚¹ãƒ†ãƒƒãƒ—ï¼‰
drawing-engine.js:681    ğŸ”§ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å®Œå…¨åŒ–
drawing-engine.js:682    ğŸ”§ ãƒ‡ãƒãƒƒã‚°ã‚³ãƒãƒ³ãƒ‰: window.TegakiDebug.drawing.*
quick-export-ui.js:292 âœ… quick-export-ui.js (ç„¡åŠ¹åŒ–ç‰ˆ) loaded
export-manager.js:531 âœ… export-manager.js v8.33.0 loaded
export-manager.js:532    ğŸ”§ PNGâ†’APNGç¶­æŒ / WEBPâ†’WebMè‡ªå‹•åˆ‡æ›¿å¯¾å¿œ
png-exporter.js:255 âœ… png-exporter.js v8.29.0 loaded
png-exporter.js:256    ğŸ”§ generatePreview()ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
png-exporter.js:257    ğŸ”§ ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°å¼·åŒ–
png-exporter.js:258    ğŸ”§ Blobç”Ÿæˆã®ç¢ºå®Ÿæ€§å‘ä¸Š
webp-exporter.js:249 âœ… webp-exporter.js v8.33.0 loaded (é™æ­¢ç”»WEBPå°‚ç”¨)
webp-exporter.js:250    âš ï¸ è¤‡æ•°ãƒ•ãƒ¬ãƒ¼ãƒ æ™‚ã¯WebMæ¨å¥¨ï¼ˆã‚¢ãƒ«ãƒ•ã‚¡å€¤ç¶­æŒãƒ»è»½é‡ï¼‰
psd-exporter.js:170 âœ… psd-exporter.js v8.18.0 loaded (Phase 5: ãƒœã‚¿ãƒ³é…ç½®ç”¨)
psd-exporter.js:171    âš ï¸ å®Ÿè£…ã¯å°†æ¥ãƒ•ã‚§ãƒ¼ã‚ºã§è¿½åŠ äºˆå®š
psd-exporter.js:172    âœ“ ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§é–‹ç™ºä¸­ã‚’é€šçŸ¥
apng-exporter.js:281 âœ… apng-exporter.js v8.31.0 loaded
mp4-exporter.js:30 âœ… mp4-exporter.js (Phase 8å®Œæˆç‰ˆ) loaded
dom-builder.js:527 âœ… dom-builder.js v8.19.0 loaded
dom-builder.js:528    ğŸ”§ ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒœã‚¿ãƒ³: PNG/WEBP/PSDï¼ˆGIF/PDFå‰Šé™¤ï¼‰
dom-builder.js:529    âœ“ Systemæƒ…å ±è¡¨ç¤ºï¼ˆWebGPU/GPUæ¤œå‡ºï¼‰
slider-utils.js:265 âœ… slider-utils.js v8.14.0 loaded
slider-utils.js:266    ğŸ”§ PointerEventé…ä¿¡å•é¡Œä¿®æ­£å®Œäº†
keyboard-handler.js:486 âœ… keyboard-handler.js Phase 6å®Œæˆç‰ˆ loaded
keyboard-handler.js:487    âœ… BS/DEL: æç”»å‰Šé™¤ãŒæ­£å¸¸å‹•ä½œ
keyboard-handler.js:488    âœ… Undo/Redo: childrenå‚ç…§ä¿æŒã§å®Œå…¨å¾©å…ƒ
keyboard-handler.js:489    ğŸ”§ åè»¢å‡¦ç†: ç”»åƒæ¶ˆå¤±å•é¡Œè§£æ±º
layer-panel-renderer.js:663 âœ… layer-panel-renderer.js (Phase 5+6å¯¾å¿œç‰ˆ) loaded
layer-panel-renderer.js:664    âœ“ layer:panel-update-requested ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
layer-panel-renderer.js:665    âœ“ LayerSystemã‹ã‚‰ã®ç›´æ¥å‘¼ã³å‡ºã—å®Œå…¨æ’é™¤
status-display-renderer.js:317 âœ… ui/status-display-renderer.js å®Œå…¨æ”¹ä¿®ç‰ˆ loaded
timeline-thumbnail-utils.js:258 âœ… ui/timeline-thumbnail-utils.js (Phase 3å®Œå…¨ç‰ˆ) loaded
timeline-thumbnail-utils.js:259    âœ“ Phase 1: layer:transform-updated è³¼èª­è¿½åŠ 
timeline-thumbnail-utils.js:260    âœ“ Phase 3: throttleæœ€é©åŒ–ï¼ˆ100msï¼‰
timeline-thumbnail-utils.js:261    âœ“ Phase 3: immediate ãƒ•ãƒ©ã‚°å¯¾å¿œ
timeline-thumbnail-utils.js:262    âœ“ ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚µãƒ ãƒã‚¤ãƒ«ãŒãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰å½¢ã«å³åº§è¿½å¾“
timeline-ui.js:981 âœ… timeline-ui.js (Phase 4å®Œäº†: ãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰å½¢é€£æºç‰ˆ) loaded
album-popup.js:473 âœ… album-popup.js (FRAMEæ”¹ä¿®ç‰ˆ) loaded
settings-popup.js:649 âœ… settings-popup.js Phase 1 loaded
settings-popup.js:650    ğŸ”§ ui:open-settings ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ ï¼ˆCtrl+, å¯¾å¿œï¼‰
quick-access-popup.js:740 âœ… quick-access-popup.js v8.13.17 loaded
export-popup.js:557 âœ… export-popup.js v8.29.0 loaded
export-popup.js:558    ğŸ”§ PNGâ†’APNGç¶­æŒ / WEBPâ†’WebMè‡ªå‹•åˆ‡æ›¿UIå¯¾å¿œ
ui-panels.js:420 âœ… ui-panels.js v8.13.15 loaded
ui-panels.js:421    ğŸ¨ ã‚µã‚¤ãƒ‰ãƒãƒ¼è»½é‡ãƒ‡ã‚¶ã‚¤ãƒ³: ã‚ªãƒ¬ãƒ³ã‚¸æ ã®ã¿
ui-panels.js:422    ğŸ¯ SVGè‰²çµ±ä¸€: å¸¸ã«var(--futaba-maroon)
core-runtime.js:578 âœ… core-runtime.js (Phase 5 - UIä¾‹å¤–ä¿®æ­£ç‰ˆ) loaded
core-engine.js:767 âœ… core-engine.js Phase 4-Cå®Œå…¨ç‰ˆ loaded
core-engine.js:768    ğŸ”§ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çµ±åˆå®Œäº†
core-engine.js:769    ğŸ”§ Master Loop: pointer â†’ preview â†’ render
core-initializer.js:629 âœ… core-initializer.js Phase 1.2.2 CoordinateSystemåˆæœŸåŒ–ä¿®æ­£ç‰ˆ loaded
core-initializer.js:630    â­ CoreEngine.initialize()å®Œäº†å¾Œã«CoordinateSystemåˆæœŸåŒ–
core-initializer.js:631    â­ worldContainer.position/scaleæœªå®šç¾©ã‚¨ãƒ©ãƒ¼ã®å›é¿
core-initializer.js:632    â­ å…ƒãƒ•ã‚¡ã‚¤ãƒ«ã®å…¨ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»æ©Ÿèƒ½ã‚’å®Œå…¨ç¶™æ‰¿
index.html:111 ğŸš€ WebGL2 MSDFç‰ˆ èµ·å‹•ä¸­...
core-initializer.js:367 [CoreInit] Initializing CoordinateSystem...
coordinate-system.js:43 [CoordinateSystem] initialize() called {canvas: true, worldContainer: true, canvasSize: '1920x1080'}
coordinate-system.js:64 [CoordinateSystem] âœ… Initialized successfully
core-initializer.js:217 [CoreInit] âœ… CoordinateSystem initialized
core-initializer.js:374 [CoreInit] CoordinateSystem state: {initialized: true, canvas: '1920x1080', worldContainer: {â€¦}}
popup-manager.js:16 âœ… PopupManager initialized
popup-manager.js:42 ğŸ“‹ Popup "settings" registered (priority: 1)
popup-manager.js:42 ğŸ“‹ Popup "quickAccess" registered (priority: 2)
popup-manager.js:42 ğŸ“‹ Popup "album" registered (priority: 3)
popup-manager.js:42 ğŸ“‹ Popup "resize" registered (priority: 4)
popup-manager.js:102 ğŸ”§ Initializing all popups...
popup-manager.js:87 âœ… Popup "settings" initialized successfully
popup-manager.js:87 âœ… Popup "quickAccess" initialized successfully
popup-manager.js:87 âœ… Popup "album" initialized successfully
popup-manager.js:87 âœ… Popup "resize" initialized successfully
popup-manager.js:118 ğŸ“Š Popup initialization: 4 ready, 0 deferred
webgl2-drawing-layer.js:94 [WebGL2DrawingLayer] âœ… Initialized {canvasSize: '1920x1080', maxTextureSize: 16384, extensions: Array(3)}
core-initializer.js:244 [WebGL2] Drawing Layer initialized
gl-stroke-processor.js:48 [GLStrokeProcessor] âœ… Initialized (Phase 1.6)
core-initializer.js:253 [WebGL2] GLStrokeProcessor initialized
gl-msdf-pipeline.js:66 [GLMSDFPipeline] âœ… Initialized (Phase 1.8)
core-initializer.js:258 [WebGL2] GLMSDFPipeline initialized
gl-texture-bridge.js:51 [GLTextureBridge] âœ… Initialized (PixiJS v8)
core-initializer.js:266 [WebGL2] GLTextureBridge initialized
gl-mask-layer.js:82 [GLMaskLayer] âœ… Initialized {width: 400, height: 400}
core-initializer.js:278 [WebGL2] GLMaskLayer initialized
stroke-renderer.js:76 [StrokeRenderer] âœ… Initialized (WebGL2 mode)
core-initializer.js:293 [WebGL2] StrokeRenderer initialized
core-initializer.js:295 [WebGL2] âœ… Phase 6 initialization complete
core-initializer.js:419 [App] Re-initializing BrushCore with WebGL2 components
core-initializer.js:455 [App] BrushCore already initialized, components updated
core-initializer.js:458 [App] âœ… BrushCore re-initialized with WebGL2 (Phase 6.1) {msdfAvailable: true, maskAvailable: true, initialized: true}
index.html:113 âœ… WebGL2åˆæœŸåŒ–å®Œäº†
popup-manager.js:42 ğŸ“‹ Popup "export" registered (priority: 5)
popup-manager.js:87 âœ… Popup "export" initialized successfully
// ================================================================================
// BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆï¼ˆå¼•æ•°å½¢å¼ä¿®æ­£ï¼‰
// ================================================================================

console.log('=== BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆ ===');

window.brushCore = {
  strokeRecorder: window.strokeRecorder,
  glStrokeProcessor: window.GLStrokeProcessor,
  glMSDFPipeline: window.GLMSDFPipeline,
  glTextureBridge: window.GLTextureBridge,
  glMaskLayer: window.GLMaskLayer,
  
  isDrawing: false,
  currentPreviewSprite: null,
  updateThrottle: null,
  
  startStroke(localX, localY, pressure) {
    console.log('[BrushCore] startStroke:', localX, localY, pressure);
    this.isDrawing = true;
    this.strokeRecorder.startStroke(localX, localY, pressure);
  },
  
  updateStroke(localX, localY, pressure) {
    if (!this.isDrawing) return;
    this.strokeRecorder.addPoint(localX, localY, pressure);
    
    if (this.updateThrottle) clearTimeout(this.updateThrottle);
    this.updateThrottle = setTimeout(() => {
      this._updatePreview();
    }, 50);
  },
  
  async _updatePreview() {
    const points = this.strokeRecorder.getRawPoints();
    if (points.length < 2) return;
    
    console.log('[BrushCore] _updatePreview, points:', points.length);
    
    try {
      const size = window.brushSettings?.size || 10;
      
      // 1. ãƒãƒªã‚´ãƒ³ç”Ÿæˆ
      const vertexData = this.glStrokeProcessor.createPolygonVertexBuffer(points, size);
      console.log('[BrushCore] Vertex data:', {
        vertexCount: vertexData.vertexCount,
        bounds: vertexData.bounds
      });
      
      // 2. GPUè»¢é€
      const gpuVertexBuffer = this.glStrokeProcessor.uploadToGPU(
        vertexData.buffer,
        window.WebGLContext.gl.STATIC_DRAW,
        7
      );
      
      // 3. ã‚¨ãƒƒã‚¸ãƒãƒƒãƒ•ã‚¡ç”Ÿæˆ
      const edgeData = this.glStrokeProcessor.createEdgeBuffer(points, size);
      const gpuEdgeBuffer = this.glStrokeProcessor.uploadToGPU(
        edgeData.buffer,
        window.WebGLContext.gl.STATIC_DRAW,
        4
      );
      
      console.log('[BrushCore] GPU buffers created:', {
        vertex: !!gpuVertexBuffer.glBuffer,
        edge: !!gpuEdgeBuffer.glBuffer
      });
      
      // 4. MSDFç”Ÿæˆï¼ˆæ­£ã—ã„å¼•æ•°å½¢å¼ï¼‰
      // âŒ é–“é•ã„: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’æ¸¡ã™
      // âœ… æ­£ã—ã„: ç”Ÿãƒ‡ãƒ¼ã‚¿ï¼ˆFloat32Arrayï¼‰ã‚’æ¸¡ã™
      const msdfResult = await this.glMSDFPipeline.generateMSDF(
        edgeData.buffer,        // âœ… Float32Arrayï¼ˆç”Ÿãƒ‡ãƒ¼ã‚¿ï¼‰
        vertexData.bounds,
        null,
        {},
        vertexData.buffer,      // âœ… Float32Arrayï¼ˆç”Ÿãƒ‡ãƒ¼ã‚¿ï¼‰
        vertexData.vertexCount,
        edgeData.edgeCount || (edgeData.buffer.length / 4)
      );
      
      console.log('[BrushCore] MSDF result:', msdfResult);
      
      if (!msdfResult || !msdfResult.texture) {
        console.error('âŒ MSDFç”Ÿæˆå¤±æ•—');
        return;
      }
      
      // 5. Spriteç”Ÿæˆ
      const sprite = await this.glTextureBridge.createSpriteFromGLTexture(
        msdfResult.texture,
        msdfResult.width,
        msdfResult.height
      );
      
      console.log('[BrushCore] Sprite created:', sprite);
      
      if (!sprite) {
        console.error('âŒ Spriteç”Ÿæˆå¤±æ•—');
        return;
      }
      
      // 6. Spriteé…ç½®
      sprite.x = vertexData.bounds.minX;
      sprite.y = vertexData.bounds.minY;
      sprite.width = vertexData.bounds.width;
      sprite.height = vertexData.bounds.height;
      sprite.alpha = window.brushSettings?.opacity || 1;
      
      // 7. ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«è¿½åŠ 
      const activeLayer = window.layerManager.getActiveLayer();
      
      if (!activeLayer) {
        console.error('âŒ ActiveLayer ãŒå­˜åœ¨ã—ãªã„');
        return;
      }
      
      const container = activeLayer.drawingContainer || activeLayer.container || activeLayer;
      
      if (!container || !container.addChild) {
        console.error('âŒ Container ãŒç„¡åŠ¹:', {
          drawingContainer: !!activeLayer.drawingContainer,
          container: !!activeLayer.container,
          hasAddChild: !!activeLayer.addChild
        });
        return;
      }
      
      // å¤ã„ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‰Šé™¤
      if (this.currentPreviewSprite) {
        container.removeChild(this.currentPreviewSprite);
        this.currentPreviewSprite.destroy();
      }
      
      container.addChild(sprite);
      this.currentPreviewSprite = sprite;
      
      console.log('[BrushCore] âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°å®Œäº†');
      
    } catch (error) {
      console.error('[BrushCore] âŒ ã‚¨ãƒ©ãƒ¼:', error);
      console.error(error.stack);
    }
  },
  
  finalizeStroke() {
    console.log('[BrushCore] finalizeStroke');
    
    if (this.updateThrottle) {
      clearTimeout(this.updateThrottle);
      this.updateThrottle = null;
    }
    
    if (this.currentPreviewSprite) {
      this.currentPreviewSprite = null;
    }
    
    const points = this.strokeRecorder.getRawPoints();
    console.log('[BrushCore] Final points:', points.length);
    
    this.strokeRecorder.endStroke();
    this.isDrawing = false;
  }
};

console.log('âœ… BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆæ§‹ç¯‰å®Œäº†');

// æç”»ãƒ†ã‚¹ãƒˆ
console.log('\n=== æœ€çµ‚æç”»ãƒ†ã‚¹ãƒˆ ===');

setTimeout(async () => {
  console.log('ğŸ¨ æç”»é–‹å§‹...');
  window.brushCore.startStroke(600, 400, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(650, 450, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(700, 450, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(750, 400, 0.5);
  
  await new Promise(r => setTimeout(r, 200));
  window.brushCore.finalizeStroke();
  
  console.log('âœ… æç”»å®Œäº† - ç”»é¢ã«ç·šãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ï¼');
}, 1000);

console.log('\n================================================================================');
console.log('BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆï¼ˆå¼•æ•°å½¢å¼ä¿®æ­£ï¼‰');
console.log('é‡è¦: Float32Array ã‚’ç›´æ¥æ¸¡ã™ã‚ˆã†ã«ä¿®æ­£');
console.log('1ç§’å¾Œã«æç”»ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™');
console.log('================================================================================');
VM751:5 === BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆ ===
VM751:167 âœ… BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆæ§‹ç¯‰å®Œäº†
VM751:170 
=== æœ€çµ‚æç”»ãƒ†ã‚¹ãƒˆ ===
VM751:191 
================================================================================
VM751:192 BrushCore æœ€çµ‚ä¿®æ­£ç‰ˆï¼ˆå¼•æ•°å½¢å¼ä¿®æ­£ï¼‰
VM751:193 é‡è¦: Float32Array ã‚’ç›´æ¥æ¸¡ã™ã‚ˆã†ã«ä¿®æ­£
VM751:194 1ç§’å¾Œã«æç”»ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¾ã™
VM751:195 ================================================================================
undefined
VM751:173 ğŸ¨ æç”»é–‹å§‹...
VM751:19 [BrushCore] startStroke: 600 400 0.5
VM751:38 [BrushCore] _updatePreview, points: 2
VM751:45 [BrushCore] Vertex data: {vertexCount: 147, bounds: {â€¦}}
VM751:65 [BrushCore] GPU buffers created: {vertex: true, edge: true}
gl-msdf-pipeline.js:610 [GLMSDFPipeline] Error: TypeError: Failed to execute 'bindBuffer' on 'WebGL2RenderingContext': parameter 2 is not of type 'WebGLBuffer'.
    at GLMSDFPipeline._drawStroke (gl-msdf-pipeline.js:372:10)
    at GLMSDFPipeline.renderPass (gl-msdf-pipeline.js:531:14)
    at GLMSDFPipeline.generateMSDF (gl-msdf-pipeline.js:593:14)
    at Object._updatePreview (<anonymous>:73:52)
    at <anonymous>:30:12
generateMSDF @ gl-msdf-pipeline.js:610
_updatePreview @ VM751:73
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:177
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:83 [BrushCore] MSDF result: null
VM751:86 âŒ MSDFç”Ÿæˆå¤±æ•—
_updatePreview @ VM751:86
await in _updatePreview
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:177
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:38 [BrushCore] _updatePreview, points: 3
VM751:45 [BrushCore] Vertex data: {vertexCount: 129, bounds: {â€¦}}
VM751:65 [BrushCore] GPU buffers created: {vertex: true, edge: true}
gl-msdf-pipeline.js:610 [GLMSDFPipeline] Error: TypeError: Failed to execute 'bindBuffer' on 'WebGL2RenderingContext': parameter 2 is not of type 'WebGLBuffer'.
    at GLMSDFPipeline._drawStroke (gl-msdf-pipeline.js:372:10)
    at GLMSDFPipeline.renderPass (gl-msdf-pipeline.js:531:14)
    at GLMSDFPipeline.generateMSDF (gl-msdf-pipeline.js:593:14)
    at Object._updatePreview (<anonymous>:73:52)
    at <anonymous>:30:12
generateMSDF @ gl-msdf-pipeline.js:610
_updatePreview @ VM751:73
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:180
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:83 [BrushCore] MSDF result: null
VM751:86 âŒ MSDFç”Ÿæˆå¤±æ•—
_updatePreview @ VM751:86
await in _updatePreview
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:180
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:38 [BrushCore] _updatePreview, points: 4
VM751:45 [BrushCore] Vertex data: {vertexCount: 135, bounds: {â€¦}}
VM751:65 [BrushCore] GPU buffers created: {vertex: true, edge: true}
gl-msdf-pipeline.js:610 [GLMSDFPipeline] Error: TypeError: Failed to execute 'bindBuffer' on 'WebGL2RenderingContext': parameter 2 is not of type 'WebGLBuffer'.
    at GLMSDFPipeline._drawStroke (gl-msdf-pipeline.js:372:10)
    at GLMSDFPipeline.renderPass (gl-msdf-pipeline.js:531:14)
    at GLMSDFPipeline.generateMSDF (gl-msdf-pipeline.js:593:14)
    at Object._updatePreview (<anonymous>:73:52)
    at <anonymous>:30:12
generateMSDF @ gl-msdf-pipeline.js:610
_updatePreview @ VM751:73
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:183
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:83 [BrushCore] MSDF result: null
VM751:86 âŒ MSDFç”Ÿæˆå¤±æ•—
_updatePreview @ VM751:86
await in _updatePreview
ï¼ˆåŒ¿åï¼‰ @ VM751:30
setTimeout
updateStroke @ VM751:29
ï¼ˆåŒ¿åï¼‰ @ VM751:183
setTimeout
ï¼ˆåŒ¿åï¼‰ @ VM751:172
VM751:148 [BrushCore] finalizeStroke
VM751:160 [BrushCore] Final points: 4
VM751:188 âœ… æç”»å®Œäº† - ç”»é¢ã«ç·šãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ï¼
// ================================================================================
// gl-msdf-pipeline.js ã® _drawStroke ãƒ¡ã‚½ãƒƒãƒ‰è©³ç´°ç¢ºèª
// ================================================================================

console.log('=== _drawStroke ãƒ¡ã‚½ãƒƒãƒ‰è©³ç´°ç¢ºèª ===');

const pipeline = window.GLMSDFPipeline;

// _drawStroke ãƒ¡ã‚½ãƒƒãƒ‰ã®å…¨æ–‡ã‚’è¡¨ç¤º
console.log('_drawStroke å®šç¾©:');
console.log(pipeline._drawStroke.toString());

console.log('\n=== generateMSDF ãƒ¡ã‚½ãƒƒãƒ‰å…¨æ–‡ç¢ºèª ===');
console.log(pipeline.generateMSDF.toString());

console.log('\n================================================================================');
console.log('ä¸Šè¨˜ã®å‡ºåŠ›ã‹ã‚‰ã€generateMSDF ãŒå†…éƒ¨ã§ã©ã®ã‚ˆã†ã« GPU è»¢é€ã‚’è¡Œã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„');
console.log('ç‰¹ã« vertexBufferData ã®æ‰±ã„æ–¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„');
console.log('================================================================================');
VM755:5 === _drawStroke ãƒ¡ã‚½ãƒƒãƒ‰è©³ç´°ç¢ºèª ===
VM755:10 _drawStroke å®šç¾©:
VM755:11 _drawStroke(program, vbo, vertexCount, bounds, resolution) {
      const gl = this.gl;
      
      gl.bindBuffer(gl.ARRAY_BUFFER, vbo);
      
      const stride = 7 * 4;  // 7 floats = 28 bytes
      
      const aPosition = gl.getAttribLocation(program, 'aPosition');
      if (aPosition >= 0) {
        gl.enableVertexAttribArray(aPosition);
        gl.vertexAttribPointer(aPosition, 2, gl.FLOAT, false, stride, 0);
      }
      
      const aTexCoord = gl.getAttribLocation(program, 'aTexCoord');
      if (aTexCoord >= 0) {
        gl.enableVertexAttribArray(aTexCoord);
        gl.vertexAttribPointer(aTexCoord, 2, gl.FLOAT, false, stride, 8);
      }
      
      const aReserved = gl.getAttribLocation(program, 'aReserved');
      if (aReserved >= 0) {
        gl.enableVertexAttribArray(aReserved);
        gl.vertexAttribPointer(aReserved, 3, gl.FLOAT, false, stride, 16);
      }
      
      // âœ… Phase 1.8: uResolutionã®ã¿è¨­å®šï¼ˆuBoundsSizeã¯ä¸è¦ï¼‰
      const uResolution = gl.getUniformLocation(program, 'uResolution');
      if (uResolution) {
        gl.uniform2f(uResolution, resolution.width, resolution.height);
      }
      
      gl.drawArrays(gl.TRIANGLES, 0, vertexCount);
      
      if (aPosition >= 0) gl.disableVertexAttribArray(aPosition);
      if (aTexCoord >= 0) gl.disableVertexAttribArray(aTexCoord);
      if (aReserved >= 0) gl.disableVertexAttribArray(aReserved);
      gl.bindBuffer(gl.ARRAY_BUFFER, null);
    }
VM755:13 
=== generateMSDF ãƒ¡ã‚½ãƒƒãƒ‰å…¨æ–‡ç¢ºèª ===
VM755:14 async generateMSDF(edgeBufferData, bounds, existingMSDF = null, settings = {}, vertexBufferData = null, vertexCount = 0, edgeCount = 0) {
      if (!this.initialized) {
        console.error('[GLMSDFPipeline] Not initialized');
        return null;
      }
      
      if (edgeCount === 0 || !vertexBufferData || vertexCount === 0) {
        console.warn('[GLMSDFPipeline] Invalid parameters');
        return null;
      }
      
      const width = this.textureSize;
      const height = this.textureSize;
      
      try {
        const seedFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: true });
        if (!seedFBO) return null;
        
        this.clearSeedTexture(seedFBO, width, height);
        this.seedInitPass(edgeBufferData, seedFBO, width, height, edgeCount);
        
        const jfaResult = this.executeJFA(seedFBO.texture, width, height);
        if (!jfaResult) {
          window.WebGL2DrawingLayer.deleteFBO(seedFBO);
          return null;
        }
        
        const msdfFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: false });
        if (!msdfFBO) return null;
        this.encodePass(jfaResult.resultTexture, msdfFBO, width, height);
        
        const outputFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: false });
        if (!outputFBO) return null;
        
        this.renderPass(msdfFBO.texture, outputFBO, width, height, settings, vertexBufferData, vertexCount, bounds);
        
        // Cleanup
        window.WebGL2DrawingLayer.deleteFBO(seedFBO);
        if (jfaResult.tempFBO) {
          window.WebGL2DrawingLayer.deleteFBO(jfaResult.tempFBO.a);
          window.WebGL2DrawingLayer.deleteFBO(jfaResult.tempFBO.b);
        }
        window.WebGL2DrawingLayer.deleteFBO(msdfFBO);
        
        return {
          texture: outputFBO.texture,
          width: width,
          height: height
        };
        
      } catch (error) {
        console.error('[GLMSDFPipeline] Error:', error);
        return null;
      }
    }
VM755:16 
================================================================================
VM755:17 ä¸Šè¨˜ã®å‡ºåŠ›ã‹ã‚‰ã€generateMSDF ãŒå†…éƒ¨ã§ã©ã®ã‚ˆã†ã« GPU è»¢é€ã‚’è¡Œã£ã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ãã ã•ã„
VM755:18 ç‰¹ã« vertexBufferData ã®æ‰±ã„æ–¹ã‚’ç¢ºèªã—ã¦ãã ã•ã„
VM755:19 ================================================================================
undefined
// ================================================================================
// BrushCore å®Œå…¨ä¿®æ­£ç‰ˆï¼ˆWebGLBuffer ã‚’ç›´æ¥æ¸¡ã™ï¼‰
// ================================================================================

console.log('=== BrushCore å®Œå…¨ä¿®æ­£ç‰ˆï¼ˆWebGLBufferç›´æ¥ï¼‰ ===');

window.brushCore = {
  strokeRecorder: window.strokeRecorder,
  glStrokeProcessor: window.GLStrokeProcessor,
  glMSDFPipeline: window.GLMSDFPipeline,
  glTextureBridge: window.GLTextureBridge,
  glMaskLayer: window.GLMaskLayer,
  
  isDrawing: false,
  currentPreviewSprite: null,
  updateThrottle: null,
  
  // GPUè»¢é€æ¸ˆã¿ãƒãƒƒãƒ•ã‚¡ã‚’ä¿æŒ
  gpuVertexBuffer: null,
  gpuEdgeBuffer: null,
  
  startStroke(localX, localY, pressure) {
    console.log('[BrushCore] startStroke:', localX, localY, pressure);
    this.isDrawing = true;
    this.strokeRecorder.startStroke(localX, localY, pressure);
  },
  
  updateStroke(localX, localY, pressure) {
    if (!this.isDrawing) return;
    this.strokeRecorder.addPoint(localX, localY, pressure);
    
    if (this.updateThrottle) clearTimeout(this.updateThrottle);
    this.updateThrottle = setTimeout(() => {
      this._updatePreview();
    }, 50);
  },
  
  async _updatePreview() {
    const points = this.strokeRecorder.getRawPoints();
    if (points.length < 2) return;
    
    console.log('[BrushCore] _updatePreview, points:', points.length);
    
    try {
      const size = window.brushSettings?.size || 10;
      const gl = window.WebGLContext.gl;
      
      // 1. ãƒãƒªã‚´ãƒ³ç”Ÿæˆ
      const vertexData = this.glStrokeProcessor.createPolygonVertexBuffer(points, size);
      
      // 2. GPUè»¢é€
      const gpuVertex = this.glStrokeProcessor.uploadToGPU(
        vertexData.buffer,
        gl.STATIC_DRAW,
        7
      );
      
      // 3. ã‚¨ãƒƒã‚¸ãƒãƒƒãƒ•ã‚¡ç”Ÿæˆ
      const edgeData = this.glStrokeProcessor.createEdgeBuffer(points, size);
      const gpuEdge = this.glStrokeProcessor.uploadToGPU(
        edgeData.buffer,
        gl.STATIC_DRAW,
        4
      );
      
      console.log('[BrushCore] GPUè»¢é€å®Œäº†:', {
        vertexBuffer: gpuVertex.glBuffer,
        edgeBuffer: gpuEdge.glBuffer,
        vertexCount: vertexData.vertexCount
      });
      
      // 4. generateMSDF ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ç›´æ¥ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
      const width = this.glMSDFPipeline.textureSize || 512;
      const height = this.glMSDFPipeline.textureSize || 512;
      
      // SeedåˆæœŸåŒ–
      const seedFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: true });
      this.glMSDFPipeline.clearSeedTexture(seedFBO, width, height);
      this.glMSDFPipeline.seedInitPass(edgeData.buffer, seedFBO, width, height, edgeData.edgeCount || (edgeData.buffer.length / 4));
      
      // JFAå®Ÿè¡Œ
      const jfaResult = this.glMSDFPipeline.executeJFA(seedFBO.texture, width, height);
      
      // ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰
      const msdfFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: false });
      this.glMSDFPipeline.encodePass(jfaResult.resultTexture, msdfFBO, width, height);
      
      // ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ï¼ˆWebGLBuffer ã‚’ç›´æ¥æ¸¡ã™ï¼‰
      const outputFBO = window.WebGL2DrawingLayer.createFBO(width, height, { float: false });
      
      // âœ… ä¿®æ­£: renderPass ã®ç¬¬6å¼•æ•°ã‚’ WebGLBuffer ã«ã™ã‚‹
      const originalRenderPass = this.glMSDFPipeline.renderPass.bind(this.glMSDFPipeline);
      
      gl.bindFramebuffer(gl.FRAMEBUFFER, outputFBO.fbo);
      gl.viewport(0, 0, width, height);
      gl.enable(gl.BLEND);
      gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
      gl.clearColor(0, 0, 0, 0);
      gl.clear(gl.COLOR_BUFFER_BIT);
      
      gl.useProgram(this.glMSDFPipeline.renderProgram);
      
      const uMSDFTexLoc = gl.getUniformLocation(this.glMSDFPipeline.renderProgram, 'uMSDFTex');
      const uBrushColorLoc = gl.getUniformLocation(this.glMSDFPipeline.renderProgram, 'uBrushColor');
      const uOpacityLoc = gl.getUniformLocation(this.glMSDFPipeline.renderProgram, 'uOpacity');
      
      gl.activeTexture(gl.TEXTURE0);
      gl.bindTexture(gl.TEXTURE_2D, msdfFBO.texture);
      gl.uniform1i(uMSDFTexLoc, 0);
      
      gl.uniform4f(uBrushColorLoc, 0.5, 0, 0, 1.0);
      gl.uniform1f(uOpacityLoc, 1.0);
      
      // âœ… WebGLBuffer ã‚’ç›´æ¥æ¸¡ã™
      this.glMSDFPipeline._drawStroke(
        this.glMSDFPipeline.renderProgram,
        gpuVertex.glBuffer,  // âœ… WebGLBuffer
        vertexData.vertexCount,
        vertexData.bounds,
        { width, height }
      );
      
      gl.bindFramebuffer(gl.FRAMEBUFFER, null);
      gl.bindTexture(gl.TEXTURE_2D, null);
      
      console.log('[BrushCore] MSDFç”Ÿæˆå®Œäº†');
      
      // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
      window.WebGL2DrawingLayer.deleteFBO(seedFBO);
      if (jfaResult.tempFBO) {
        window.WebGL2DrawingLayer.deleteFBO(jfaResult.tempFBO.a);
        window.WebGL2DrawingLayer.deleteFBO(jfaResult.tempFBO.b);
      }
      window.WebGL2DrawingLayer.deleteFBO(msdfFBO);
      
      // 5. Spriteç”Ÿæˆ
      const sprite = await this.glTextureBridge.createSpriteFromGLTexture(
        outputFBO.texture,
        width,
        height
      );
      
      console.log('[BrushCore] Sprite created:', sprite);
      
      if (!sprite) {
        console.error('âŒ Spriteç”Ÿæˆå¤±æ•—');
        return;
      }
      
      // 6. Spriteé…ç½®
      sprite.x = vertexData.bounds.minX;
      sprite.y = vertexData.bounds.minY;
      sprite.width = vertexData.bounds.width;
      sprite.height = vertexData.bounds.height;
      sprite.alpha = window.brushSettings?.opacity || 1;
      
      // 7. ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«è¿½åŠ 
      const activeLayer = window.layerManager.getActiveLayer();
      const container = activeLayer.drawingContainer || activeLayer.container || activeLayer;
      
      if (!container || !container.addChild) {
        console.error('âŒ Containerç„¡åŠ¹');
        return;
      }
      
      // å¤ã„ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å‰Šé™¤
      if (this.currentPreviewSprite) {
        container.removeChild(this.currentPreviewSprite);
        this.currentPreviewSprite.destroy();
      }
      
      container.addChild(sprite);
      this.currentPreviewSprite = sprite;
      
      console.log('[BrushCore] âœ… æç”»æˆåŠŸï¼');
      
    } catch (error) {
      console.error('[BrushCore] âŒ ã‚¨ãƒ©ãƒ¼:', error);
      console.error(error.stack);
    }
  },
  
  finalizeStroke() {
    console.log('[BrushCore] finalizeStroke');
    
    if (this.updateThrottle) {
      clearTimeout(this.updateThrottle);
      this.updateThrottle = null;
    }
    
    if (this.currentPreviewSprite) {
      this.currentPreviewSprite = null;
    }
    
    this.strokeRecorder.endStroke();
    this.isDrawing = false;
  }
};

console.log('âœ… BrushCore å®Œå…¨ä¿®æ­£ç‰ˆæ§‹ç¯‰å®Œäº†');

// æç”»ãƒ†ã‚¹ãƒˆ
setTimeout(async () => {
  console.log('ğŸ¨ æœ€çµ‚æç”»ãƒ†ã‚¹ãƒˆé–‹å§‹...');
  window.brushCore.startStroke(700, 300, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(750, 350, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(800, 350, 0.5);
  
  await new Promise(r => setTimeout(r, 100));
  window.brushCore.updateStroke(850, 300, 0.5);
  
  await new Promise(r => setTimeout(r, 200));
  window.brushCore.finalizeStroke();
  
  console.log('âœ… ãƒ†ã‚¹ãƒˆå®Œäº† - ç”»é¢ã«ç·šãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ï¼');
}, 1000);

console.log('\n================================================================================');
console.log('å®Œå…¨ä¿®æ­£ç‰ˆ: generateMSDF ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ç›´æ¥ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ');
console.log('WebGLBuffer ã‚’ _drawStroke ã«ç›´æ¥æ¸¡ã™');
console.log('================================================================================');
VM762:5 === BrushCore å®Œå…¨ä¿®æ­£ç‰ˆï¼ˆWebGLBufferç›´æ¥ï¼‰ ===
VM762:200 âœ… BrushCore å®Œå…¨ä¿®æ­£ç‰ˆæ§‹ç¯‰å®Œäº†
VM762:222 
================================================================================
VM762:223 å®Œå…¨ä¿®æ­£ç‰ˆ: generateMSDF ã‚’ãƒã‚¤ãƒ‘ã‚¹ã—ã¦ç›´æ¥ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Ÿè¡Œ
VM762:224 WebGLBuffer ã‚’ _drawStroke ã«ç›´æ¥æ¸¡ã™
VM762:225 ================================================================================
undefined
VM762:204 ğŸ¨ æœ€çµ‚æç”»ãƒ†ã‚¹ãƒˆé–‹å§‹...
VM762:23 [BrushCore] startStroke: 700 300 0.5
VM762:42 [BrushCore] _updatePreview, points: 2
VM762:66 [BrushCore] GPUè»¢é€å®Œäº†: {vertexBuffer: WebGLBuffer, edgeBuffer: WebGLBuffer, vertexCount: 147}
VM762:126 [BrushCore] MSDFç”Ÿæˆå®Œäº†
VM762:143 [BrushCore] Sprite created: $tÂ {_events: i, _eventsCount: 0, uid: 18, _updateFlags: 15, renderGroup: null,Â â€¦}
VM762:175 [BrushCore] âœ… æç”»æˆåŠŸï¼
VM762:42 [BrushCore] _updatePreview, points: 3
VM762:66 [BrushCore] GPUè»¢é€å®Œäº†: {vertexBuffer: WebGLBuffer, edgeBuffer: WebGLBuffer, vertexCount: 129}
VM762:126 [BrushCore] MSDFç”Ÿæˆå®Œäº†
VM762:143 [BrushCore] Sprite created: $tÂ {_events: i, _eventsCount: 0, uid: 19, _updateFlags: 15, renderGroup: null,Â â€¦}
VM762:175 [BrushCore] âœ… æç”»æˆåŠŸï¼
VM762:42 [BrushCore] _updatePreview, points: 4
VM762:66 [BrushCore] GPUè»¢é€å®Œäº†: {vertexBuffer: WebGLBuffer, edgeBuffer: WebGLBuffer, vertexCount: 135}
VM762:126 [BrushCore] MSDFç”Ÿæˆå®Œäº†
VM762:143 [BrushCore] Sprite created: $tÂ {_events: i, _eventsCount: 0, uid: 20, _updateFlags: 15, renderGroup: null,Â â€¦}
VM762:175 [BrushCore] âœ… æç”»æˆåŠŸï¼
VM762:184 [BrushCore] finalizeStroke
VM762:219 âœ… ãƒ†ã‚¹ãƒˆå®Œäº† - ç”»é¢ã«ç·šãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã¯ãšã§ã™ï¼
