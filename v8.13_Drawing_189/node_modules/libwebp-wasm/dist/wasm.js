import load from "./libwebp";
let wasmModule;
export const init = () => {
    return load();
};
let bindMap;
export const initBindMap = async () => {
    if (!wasmModule) {
        wasmModule = await init();
    }
    if (bindMap)
        return bindMap;
    if (!wasmModule) {
        throw new Error("wasm init error");
    }
    const _createBuffer = wasmModule.cwrap("create_buffer", "number", ["number"]);
    const _freeBuffer = wasmModule.cwrap("destroy_buffer", null, ["number"]);
    const _decode = wasmModule.cwrap("decode_mux_all", "number", [
        "number",
        "number",
    ]);
    const _encode = wasmModule.cwrap("encode", "number", [
        "number",
        "number",
        "number",
        "number",
    ]);
    const _createEnc = wasmModule.cwrap("create_enc", "number", [
        "number",
        "number",
    ]);
    const _addFrame = wasmModule.cwrap("add_frame", "number", [
        "number",
        "number",
        "number",
        "number",
    ]);
    const _saveEnc = wasmModule.cwrap("save_enc", "number", ["number", "number"]);
    const _getSize = wasmModule.cwrap("get_size", "number", [
        "number",
        "number",
    ]);
    bindMap = {
        _createBuffer,
        _freeBuffer,
        _decode,
        _encode,
        wasmModule,
        _createEnc,
        _addFrame,
        _saveEnc,
        _getSize,
    };
    return bindMap;
};
export const destroy = () => {
    wasmModule = undefined;
    bindMap = undefined;
};
//# sourceMappingURL=wasm.js.map