{"version":3,"file":"check-image-type.cjs.production.min.js","sources":["../src/type.ts","../src/index.ts"],"sourcesContent":["export type Input = Uint8Array;\r\n\r\nexport const WEBP = {\r\n  ext: \"webp\",\r\n  mime: \"image/webp\",\r\n} as const;\r\nexport type WEBP_TYPE = typeof WEBP;\r\n\r\nexport const JPG = {\r\n  ext: \"jpg\",\r\n  mime: \"image/jpeg\",\r\n} as const;\r\nexport type JPG_TYPE = typeof JPG;\r\n\r\nexport const PNG = {\r\n  ext: \"png\",\r\n  mime: \"image/png\",\r\n} as const;\r\nexport type PNG_TYPE = typeof PNG;\r\n\r\nexport const BMP = {\r\n  ext: \"bmp\",\r\n  mime: \"image/bmp\",\r\n} as const;\r\nexport type BMP_TYPE = typeof BMP;\r\n\r\nexport const GIF = {\r\n  ext: \"gif\",\r\n  mime: \"image/gif\",\r\n} as const;\r\nexport type GIF_TYPE = typeof GIF;\r\n\r\nexport const AVIF = {\r\n  ext: \"avif\",\r\n  mime: \"image/avif\",\r\n} as const;\r\nexport type AVIF_TYPE = typeof AVIF;\r\n\r\nexport const HEIC = {\r\n  ext: \"heic\",\r\n  mime: \"image/heic\",\r\n} as const;\r\nexport type HEIC_TYPE = typeof HEIC;\r\n\r\nexport const BPG = {\r\n  ext: \"bpg\",\r\n  mime: \"image/bpg\",\r\n} as const;\r\nexport type BPG_TYPE = typeof BPG;\r\n\r\nexport const ICO = {\r\n  ext: \"ico\",\r\n  mime: \"image/ico\",\r\n} as const;\r\nexport type ICO_TYPE = typeof ICO;\r\n\r\nexport const PSD = {\r\n  ext: \"psd\",\r\n  mime: \"image/vnd.adobe.photoshop\",\r\n} as const;\r\nexport type PSD_TYPE = typeof PSD;\r\n\r\nexport const JXR = {\r\n  ext: \"jxr\",\r\n  mime: \"image/vnd.ms-photo\",\r\n} as const;\r\nexport type JXR_TYPE = typeof JXR;\r\nexport const FLIF = {\r\n  ext: \"flif\",\r\n  mime: \"image/flif\",\r\n} as const;\r\nexport type FLIF_TYPE = typeof FLIF;\r\n\r\nexport const ICNS = {\r\n  ext: \"icns\",\r\n  mime: \"image/icns\",\r\n} as const;\r\nexport type ICNS_TYPE = typeof ICNS;\r\nexport const ORF = {\r\n  ext: \"orf\",\r\n  mime: \"image/x-olympus-orf\",\r\n} as const;\r\nexport type ORF_TYPE = typeof ORF;\r\nexport const XCF = {\r\n  ext: \"xcf\",\r\n  mime: \"image/x-xcf\",\r\n} as const;\r\nexport type XCF_TYPE = typeof XCF;\r\nexport const RW2 = {\r\n  ext: \"rw2\",\r\n  mime: \"image/x-panasonic-rw2\",\r\n} as const;\r\nexport type RW2_TYPE = typeof RW2;\r\nexport const KTX = {\r\n  ext: \"ktx\",\r\n  mime: \"image/ktx\",\r\n} as const;\r\nexport type KTX_TYPE = typeof KTX;\r\nexport const JXL = {\r\n  ext: \"jxl\",\r\n  mime: \"image/jxl\",\r\n} as const;\r\nexport type JXL_TYPE = typeof JXL;\r\nexport const CUR = {\r\n  ext: \"cur\",\r\n  mime: \"image/x-icon\",\r\n} as const;\r\nexport type CUR_TYPE = typeof CUR;\r\nexport const RAF = {\r\n  ext: \"raf\",\r\n  mime: \"image/x-fujifilm-raf\",\r\n} as const;\r\nexport type RAF_TYPE = typeof RAF;\r\n\r\nexport type ImageType =\r\n  | WEBP_TYPE\r\n  | PNG_TYPE\r\n  | JPG_TYPE\r\n  | GIF_TYPE\r\n  | BMP_TYPE\r\n  | AVIF_TYPE\r\n  | HEIC_TYPE\r\n  | BPG_TYPE\r\n  | ICO_TYPE\r\n  | PSD_TYPE\r\n  | JXR_TYPE\r\n  | FLIF_TYPE\r\n  | ICNS_TYPE\r\n  | ORF_TYPE\r\n  | XCF_TYPE\r\n  | RW2_TYPE\r\n  | KTX_TYPE\r\n  | JXL_TYPE\r\n  | RAF_TYPE\r\n  | CUR_TYPE\r\nexport type ImageMime = ImageType[\"mime\"];\r\nexport type ImageExt = ImageType[\"ext\"];\r\n","import {\r\n  ImageType,\r\n  Input,\r\n  WEBP,\r\n  JPG,\r\n  PNG,\r\n  GIF,\r\n  BMP,\r\n  AVIF,\r\n  HEIC,\r\n  BPG,\r\n  ICO,\r\n  PSD,\r\n  JXR,\r\n  FLIF,\r\n  ICNS,\r\n  ORF,\r\n  XCF,\r\n  RW2,\r\n  KTX,\r\n  JXL,\r\n  CUR,\r\n  RAF,\r\n} from \"./type\";\r\n\r\nexport * from \"./type\";\r\n\r\ntype Option = {\r\n  offset: number;\r\n};\r\nconst defaultOption: Option = {\r\n  offset: 0,\r\n} as const;\r\n\r\nconst check = (\r\n  buffer: Input,\r\n  data: number[],\r\n  option?: Partial<Option>\r\n): boolean => {\r\n  const { offset } = { ...defaultOption, ...option };\r\n  return data.every((v, k) => buffer[k + offset] === v);\r\n};\r\n\r\nconst checkString = (buffer: Input, str: string, option?: Partial<Option>) => {\r\n  return check(\r\n    buffer,\r\n    Array.from(str).map((i) => i.charCodeAt(0)),\r\n    option\r\n  );\r\n};\r\nexport const isBMP = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 2) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x42, 0x4d]);\r\n};\r\n\r\nexport const isGIF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 3) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x47, 0x49, 0x46]);\r\n};\r\n\r\nexport const isJPG = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 3) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0xff, 0xd8, 0xff]);\r\n};\r\nexport const isJXR = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 3) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x49, 0x49, 0xbc]);\r\n};\r\nexport const isFLIF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 4) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"FLIF\");\r\n};\r\nexport const isXCF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"gimp xcf \");\r\n};\r\nexport const isORF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x49, 0x49, 0x52, 0x4f, 0x08, 0x00, 0x00, 0x00, 0x18]);\r\n};\r\nexport const isRW2 = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [\r\n    0x49,\r\n    0x49,\r\n    0x55,\r\n    0x00,\r\n    0x18,\r\n    0x00,\r\n    0x00,\r\n    0x00,\r\n    0x88,\r\n    0xe7,\r\n    0x74,\r\n    0xd8,\r\n  ]);\r\n};\r\nexport const isPNG = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 8) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x89, 0x50, 0x4e, 0x47, 0x0d, 0x0a, 0x1a, 0x0a]);\r\n};\r\n\r\nexport const isWEBP = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"WEBP\", { offset: 8 });\r\n};\r\nexport const isICNS = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"icns\");\r\n};\r\nexport const isAVIF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"ftypavif\", { offset: 4 });\r\n};\r\nexport const isHEIC = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return (\r\n    checkString(buffer, \"ftyp\", { offset: 4 }) &&\r\n    (checkString(buffer, \"mif1\", { offset: 8 }) ||\r\n      checkString(buffer, \"msf1\", { offset: 8 }) ||\r\n      checkString(buffer, \"heic\", { offset: 8 }) ||\r\n      checkString(buffer, \"heix\", { offset: 8 }) ||\r\n      checkString(buffer, \"hevc\", { offset: 8 }) ||\r\n      checkString(buffer, \"hevx\", { offset: 8 }))\r\n  );\r\n};\r\n\r\nexport const isBPG = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x42, 0x50, 0x47, 0xfb]);\r\n};\r\nexport const isICO = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x00, 0x00, 0x01, 0x00]);\r\n};\r\nexport const isPSD = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"8BPS\");\r\n};\r\nexport const isKTX = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [\r\n    0xab,\r\n    0x4b,\r\n    0x54,\r\n    0x58,\r\n    0x20,\r\n    0x31,\r\n    0x31,\r\n    0xbb,\r\n    0x0d,\r\n    0x0a,\r\n    0x1a,\r\n    0x0a,\r\n  ]);\r\n};\r\nexport const isJXL = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return (\r\n    check(buffer, [0xff, 0x0a]) ||\r\n    check(buffer, [\r\n      0x00,\r\n      0x00,\r\n      0x00,\r\n      0x0c,\r\n      0x4a,\r\n      0x58,\r\n      0x4c,\r\n      0x20,\r\n      0x0d,\r\n      0x0a,\r\n      0x87,\r\n      0x0a,\r\n    ])\r\n  );\r\n};\r\nexport const isCUR = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return check(buffer, [0x00, 0x00, 0x02, 0x00]);\r\n};\r\nexport const isRAF = (buffer: Input) => {\r\n  if (!buffer || buffer.length < 12) {\r\n    return false;\r\n  }\r\n  return checkString(buffer, \"FUJIFILMCCD-RAW\");\r\n};\r\nconst pipe: [(buffer: Input) => boolean, ImageType][] = [\r\n  [isJPG, JPG],\r\n  [isPNG, PNG],\r\n  [isGIF, GIF],\r\n  [isWEBP, WEBP],\r\n  [isBMP, BMP],\r\n  [isAVIF, AVIF],\r\n  [isHEIC, HEIC],\r\n  [isICO, ICO],\r\n  [isBPG, BPG],\r\n  [isPSD, PSD],\r\n  [isJXR, JXR],\r\n  [isFLIF, FLIF],\r\n  [isICNS, ICNS],\r\n  [isXCF, XCF],\r\n  [isRW2, RW2],\r\n  [isKTX, KTX],\r\n  [isJXL, JXL],\r\n  [isCUR, CUR],\r\n  [isORF, ORF],\r\n  [isRAF, RAF],\r\n];\r\nexport const checkImage = (buffer: Input): ImageType | undefined => {\r\n  for (const [fun, type] of pipe) {\r\n    if (fun(buffer)) return type;\r\n  }\r\n  return undefined;\r\n};\r\n"],"names":["WEBP","ext","mime","JPG","PNG","BMP","GIF","AVIF","HEIC","BPG","ICO","PSD","JXR","FLIF","ICNS","ORF","XCF","RW2","KTX","JXL","CUR","RAF","defaultOption","offset","check","buffer","data","option","every","v","k","checkString","str","Array","from","map","i","charCodeAt","isBMP","length","isGIF","isJPG","isJXR","isFLIF","isXCF","isORF","isRW2","isPNG","isWEBP","isICNS","isAVIF","isHEIC","isBPG","isICO","isPSD","isKTX","isJXL","isCUR","isRAF","pipe","type","fun"],"mappings":"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"}