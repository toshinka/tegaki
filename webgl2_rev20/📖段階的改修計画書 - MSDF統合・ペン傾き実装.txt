================================================================================
ãƒ–ãƒ©ã‚¦ã‚¶ãŠçµµã‹ããƒ„ãƒ¼ãƒ« - æ®µéšçš„æ”¹ä¿®è¨ˆç”»æ›¸
MSDFçµ±åˆå®Ÿè£…ãƒ»ãƒšãƒ³å‚¾ãå®Ÿè£…ãƒ»å¤–éƒ¨ãƒ„ãƒ¼ãƒ«æµç”¨çµ±åˆ
Rev.19 â†’ Rev.20 ç§»è¡Œè¨ˆç”»
================================================================================

â–  ç¾çŠ¶åˆ†æï¼ˆRev.19æ™‚ç‚¹ï¼‰

ã€åº§æ¨™å¤‰æ›ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€‘
ğŸ“ coordinate-system.js âœ…
  - screenClientToCanvas() / canvasToWorld() / worldToLocal() å®Ÿè£…æ¸ˆã¿
  - DPIè£œæ­£ãƒ»é€†è¡Œåˆ—è¨ˆç®—ãŒæ­£å¸¸å‹•ä½œ
  ğŸ”§ Penpotåº§æ¨™ç³»ãƒ­ã‚¸ãƒƒã‚¯ã¨ã®æ¯”è¼ƒãƒ¬ãƒ“ãƒ¥ãƒ¼æœªå®Ÿæ–½

ğŸ“ camera-system.js âœ…
  - worldContainer transformç®¡ç†
  - ã‚ºãƒ¼ãƒ ãƒ»ãƒ‘ãƒ³æ©Ÿèƒ½å®Ÿè£…æ¸ˆã¿

ã€æç”»ã‚¨ãƒ³ã‚¸ãƒ³åŸºç›¤ã€‘
ğŸ“ drawing-engine.js âœ…
  - PointerEvent â†’ Localåº§æ¨™å¤‰æ›
  - ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯é–‹å§‹å‡¦ç†
  âŒ ãƒšãƒ³å‚¾ãï¼ˆtiltX/tiltYï¼‰æœªçµ±åˆ

ğŸ“„ pointer-handler.js âœ…
  - PointerEventæ•æ‰
  âŒ tiltX/tiltY/twist å–å¾—æœªå®Ÿè£…

ğŸ“„ pressure-handler.js âœ…
  - ç­†åœ§å–å¾—ãƒ»æ­£è¦åŒ–
  ğŸ”§ å‚¾ãé€£æºã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æœªå®Ÿè£…

ã€ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯å‡¦ç†ã€‘
ğŸ“„ stroke-recorder.js âœ…
  - Localåº§æ¨™è¨˜éŒ²
  - åº§æ¨™å¤‰æ›ãªã—ï¼ˆæ­£å¸¸ï¼‰
  âŒ å‚¾ããƒ‡ãƒ¼ã‚¿ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æœªè¿½åŠ 

ğŸ“„ stroke-renderer.js ğŸ”
  - PerfectFreehand â†’ ãƒãƒªã‚´ãƒ³åŒ–
  ğŸ”§ PixiJSå…¬å¼Meshç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯æœªçµ±åˆ
  âŒ å‚¾ããƒ™ãƒ¼ã‚¹ã®å¹…å¤‰èª¿æœªå®Ÿè£…

ã€WebGL2ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€‘
ğŸ“ webgl2-drawing-layer.js âš ï¸
  - çµ±åˆãƒ»å‡ºåŠ›ãƒ¬ã‚¤ãƒ¤ãƒ¼
  ğŸ”§ MSDFçµ±åˆæœªå®Œäº†

ğŸ“„ gl-msdf-pipeline.js âš ï¸
  - JFAï¼ˆJump Flooding Algorithmï¼‰å®Ÿè£…æ¸ˆã¿
  - seed-init / jfa-pass / encode ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼å­˜åœ¨
  âŒ stroke-renderer ã¨ã®é€£æºæœªå®Ÿè£…
  âŒ render.frag.glsl ã§ã®MSDFæç”»æœªå®Œæˆ

ğŸ“„ gl-stroke-processor.js ğŸ”
  - ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯â†’WebGLé ‚ç‚¹è»¢é€
  ğŸ”§ MSDFç”¨é ‚ç‚¹å±æ€§æœªå¯¾å¿œ

ğŸ“„ gl-texture-bridge.js âœ…
  - Pixi â†” WebGL2 ãƒ†ã‚¯ã‚¹ãƒãƒ£å…±æœ‰

ã€ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã€‘
ğŸ“„ shaders/seed-init.frag.glsl âœ…
ğŸ“„ shaders/jfa-pass.frag.glsl âœ…
ğŸ“„ shaders/encode.frag.glsl âœ…
ğŸ“„ shaders/render.vert.glsl âœ…
ğŸ“„ shaders/render.frag.glsl âš ï¸
  - MSDFæç”»ãƒ­ã‚¸ãƒƒã‚¯æœªå®Œæˆ
  ğŸ”§ ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹ãƒ»ã‚¨ãƒƒã‚¸è£œæ­£æœªå®Ÿè£…

ã€ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«ã€‘
ğŸ“„ data-models.js ğŸ”§
  - StrokeDataæ§‹é€ 
  âŒ tiltX, tiltY, twist ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰æœªå®šç¾©

ã€å±¥æ­´ç®¡ç†ã€‘
ğŸ“ history.js âœ…
  - window.historyManagerå®Ÿè£…æ¸ˆã¿
  ğŸ”§ Penpot History Managerã¨ã®æ¯”è¼ƒæ”¹å–„ä½™åœ°ã‚ã‚Š

ã€UIãƒ»è¨­å®šã€‘
ğŸ“„ brush-settings.js âœ…
  - ãƒ–ãƒ©ã‚·ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ç®¡ç†
  âŒ å‚¾ãæ„Ÿåº¦è¨­å®šUIæœªå®Ÿè£…

================================================================================

â–  å¤–éƒ¨ãƒ„ãƒ¼ãƒ«æµç”¨è¨ˆç”»

ã€Phase 1: PixiJS v8 å…¬å¼ã‚µãƒ³ãƒ—ãƒ«çµ±åˆã€‘
ç›®çš„: webgl-geometry-layer.js ã®Meshç”Ÿæˆã‚’å…¬å¼å®Ÿè£…ã§ç½®æ›

æµç”¨å…ƒURL:
  https://pixijs.com/8.x/examples
  - advanced-graphics.html
  - mesh-basic.html
  - triangle-mesh.html

æµç”¨å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«:
  ğŸ“„ stroke-renderer.js
  ğŸ”§ æ”¹ä¿®å†…å®¹:
    - PerfectFreehandå‡ºåŠ›â†’Pixi.Meshç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ã‚’å…¬å¼ä¾‹ã§ç½®æ›
    - VBO/IBOè»¢é€å‡¦ç†ã‚’æœ€é©åŒ–
    - é ‚ç‚¹å±æ€§: position(vec2), color(vec4), uv(vec2), tilt(vec2) è¿½åŠ 

  æ–°è¦ä½œæˆ:
  ğŸ“„ webgl-geometry-layer.js (ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³è¨˜è¼‰ã‚ã‚Šãƒ»æœªå®Ÿè£…)
    - Pixiå…¬å¼Mesh APIãƒ©ãƒƒãƒ‘ãƒ¼
    - Earcutå‡ºåŠ›â†’WebGL2é ‚ç‚¹ãƒãƒƒãƒ•ã‚¡è»¢é€
    - gl-stroke-processor.js ã‹ã‚‰åˆ†é›¢

æ‰€è¦æ™‚é–“: 1-2æ™‚é–“
å‰ææ¡ä»¶: stroke-renderer.js ã®ç¾è¡Œãƒãƒªã‚´ãƒ³åŒ–ãƒ­ã‚¸ãƒƒã‚¯ç†è§£

ã€Phase 2: Penpot åº§æ¨™å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯æ¯”è¼ƒæ”¹å–„ã€‘
ç›®çš„: coordinate-system.js ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æœ€é©åŒ–

æµç”¨å…ƒURL:
  https://github.com/penpot/penpot/tree/main/frontend/src/app/main/ui/workspace/canvas
  - viewport.cljs
  - coordinates.cljs

ğŸ”§ æ”¹ä¿®å†…å®¹:
  ğŸ“ coordinate-system.js
    - worldToLocal() æ‰‹å‹•é€†ç®—ã®ç²¾åº¦æ¤œè¨¼
    - Penpotã®è¡Œåˆ—ã‚¹ã‚¿ãƒƒã‚¯ç®¡ç†ã¨ã®æ¯”è¼ƒ
    - è¦ªãƒã‚§ãƒ¼ãƒ³é¡æŸ»ã®æœ€é©åŒ–ï¼ˆã‚­ãƒ£ãƒƒã‚·ãƒ¥æ¤œè¨ï¼‰

  âš ï¸ æ³¨æ„: ClojureScript â†’ JavaScriptå¤‰æ›å¿…è¦
  ğŸ“ ä½œæ¥­: ãƒ­ã‚¸ãƒƒã‚¯ç†è§£å¾Œã«æ”¹å–„ç‚¹ã®ã¿å–ã‚Šè¾¼ã¿

æ‰€è¦æ™‚é–“: 1-2æ™‚é–“
å„ªå…ˆåº¦: ä¸­ï¼ˆç¾çŠ¶å‹•ä½œã—ã¦ã„ã‚‹ãŸã‚ï¼‰

ã€Phase 3: Penpot History Manager å‚è€ƒæ”¹å–„ã€‘
ç›®çš„: history.js ã® Undo/Redo æ§‹é€ æ”¹å–„

æµç”¨å…ƒURL:
  https://github.com/penpot/penpot/blob/main/frontend/src/app/main/data/workspace/undo.cljs

ğŸ”§ æ”¹ä¿®å†…å®¹:
  ğŸ“ history.js
    - ã‚³ãƒãƒ³ãƒ‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã®æœ€é©åŒ–
    - ãƒ¡ã‚¿ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ‹¡å¼µï¼ˆlayerId, strokeId, timestampï¼‰
    - ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–ï¼ˆå¤§é‡ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯å¯¾å¿œï¼‰

æ‰€è¦æ™‚é–“: 2-3æ™‚é–“
å„ªå…ˆåº¦: ä½ï¼ˆç¾çŠ¶æ©Ÿèƒ½ã—ã¦ã„ã‚‹ãŸã‚ Phase 5 ä»¥é™ã§å®Ÿæ–½ï¼‰

================================================================================

â–  MSDFçµ±åˆå®Ÿè£…è¨ˆç”»

ã€ç¾çŠ¶å•é¡Œç‚¹ã€‘
âŒ gl-msdf-pipeline.js ãŒå­¤ç«‹ã—ã¦ã„ã‚‹
âŒ stroke-renderer â†’ MSDFç”Ÿæˆ â†’ render.frag.glsl ã®é€£æºæœªå®Ÿè£…
âŒ MSDFæç”»ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ãŒæœªå®Œæˆ

ã€çµ±åˆãƒ•ãƒ­ãƒ¼è¨­è¨ˆã€‘
ğŸ”€ ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼:
  drawing-engine (pointerup)
    â†’ stroke-recorder (Localåº§æ¨™è¨˜éŒ²)
    â†’ stroke-renderer (ãƒãƒªã‚´ãƒ³åŒ–)
    â†’ webgl-geometry-layer (Meshç”Ÿæˆ) â† ã€Phase 1ã§å®Ÿè£…ã€‘
    â†’ gl-msdf-pipeline (MSDFç”Ÿæˆ) â† ã€Phase 4ã§çµ±åˆã€‘
    â†’ webgl2-drawing-layer (åˆæˆãƒ»æç”») â† ã€Phase 4ã§çµ±åˆã€‘
    â†’ render.frag.glsl (MSDFæç”») â† ã€Phase 4ã§å®Ÿè£…ã€‘

ã€Phase 4: MSDFçµ±åˆå®Ÿè£…ã€‘

Step 4-1: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«æ‹¡å¼µ
ğŸ“„ data-models.js
  ğŸ”§ StrokeData æ§‹é€ è¿½åŠ :
    - msdfTexture: WebGLTexture | null
    - msdfBounds: {minX, minY, maxX, maxY}
    - msdfResolution: number (default: 512)

Step 4-2: gl-stroke-processor æ‹¡å¼µ
ğŸ“„ gl-stroke-processor.js
  ğŸ”§ æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ :
    - prepareMSDFVertices(strokeData)
      - ãƒãƒªã‚´ãƒ³é ‚ç‚¹ â†’ MSDFç”¨UVåº§æ¨™è¨ˆç®—
      - ãƒã‚¦ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãƒœãƒƒã‚¯ã‚¹ç®—å‡º
    - uploadMSDFAttributes(vertices, uvs)
      - WebGL2ãƒãƒƒãƒ•ã‚¡è»¢é€

Step 4-3: gl-msdf-pipeline çµ±åˆ
ğŸ“„ gl-msdf-pipeline.js
  ğŸ”§ æ—¢å­˜å®Ÿè£…ãƒ¬ãƒ“ãƒ¥ãƒ¼:
    - JFAå®Ÿè£…ç¢ºèªï¼ˆseed-init â†’ jfa-pass â†’ encodeï¼‰
    - FBOãƒã‚§ãƒ¼ãƒ³ç¢ºèª
  
  ğŸ”§ æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ :
    - generateMSDFTexture(strokeData)
      - ãƒãƒªã‚´ãƒ³ãƒ©ã‚¹ã‚¿ãƒ©ã‚¤ã‚º â†’ seed-init
      - JFAãƒ‘ã‚¹å®Ÿè¡Œï¼ˆlog2(resolution)å›ï¼‰
      - encodeå®Ÿè¡Œ â†’ RGBAãƒ†ã‚¯ã‚¹ãƒãƒ£å‡ºåŠ›
    - bindMSDFTexture(texture, unit)

Step 4-4: render.frag.glsl å®Ÿè£…
ğŸ“„ shaders/render.frag.glsl
  âŒ ç¾çŠ¶æœªå®Œæˆéƒ¨åˆ†ã‚’å®Ÿè£…:
    - MSDFè·é›¢å ´ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°
    - median(r,g,b) è¨ˆç®—
    - ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹ï¼ˆsmoothstep + fwidthï¼‰
    - ã‚¨ãƒƒã‚¸è£œæ­£ï¼ˆç­†åœ§ãƒ™ãƒ¼ã‚¹é–¾å€¤èª¿æ•´ï¼‰

  ğŸ”§ ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ã‚³ãƒ¼ãƒ‰è¿½åŠ :
    uniform sampler2D u_msdfTexture;
    uniform float u_strokeWidth;
    uniform float u_pixelRange;
    
    float median(vec3 rgb) {
      return max(min(rgb.r, rgb.g), min(max(rgb.r, rgb.g), rgb.b));
    }
    
    void main() {
      vec4 msdf = texture(u_msdfTexture, v_uv);
      float dist = median(msdf.rgb);
      float width = u_strokeWidth * v_pressure; // ç­†åœ§åæ˜ 
      float alpha = smoothstep(0.5 - u_pixelRange, 0.5 + u_pixelRange, dist);
      gl_FragColor = vec4(v_color.rgb, v_color.a * alpha);
    }

Step 4-5: webgl2-drawing-layer çµ±åˆ
ğŸ“ webgl2-drawing-layer.js
  ğŸ”§ renderStroke() ãƒ¡ã‚½ãƒƒãƒ‰ä¿®æ­£:
    - MSDFç”Ÿæˆãƒ•ãƒ©ã‚°ç¢ºèª
    - gl-msdf-pipeline.generateMSDFTexture() å‘¼ã³å‡ºã—
    - render.frag.glsl ã¸ã®uniformè¨­å®š
    - Meshæç”»å®Ÿè¡Œ

æ‰€è¦æ™‚é–“: 4-6æ™‚é–“
ä¾å­˜é–¢ä¿‚: Phase 1 å®Œäº†å¾Œã«å®Ÿæ–½

================================================================================

â–  ãƒšãƒ³å‚¾ãå®Ÿè£…è¨ˆç”»

ã€Phase 5: ãƒšãƒ³å‚¾ãçµ±åˆå®Ÿè£…ã€‘

Step 5-1: PointerEventæ‹¡å¼µ
ğŸ“„ pointer-handler.js
  ğŸ”§ handlePointerMove() ä¿®æ­£:
    - event.tiltX, event.tiltY, event.twist å–å¾—
    - æ­£è¦åŒ–å‡¦ç†ï¼ˆ-90ã€œ90åº¦ â†’ -1ã€œ1ï¼‰
    - twistã®è§’åº¦â†’ãƒ©ã‚¸ã‚¢ãƒ³å¤‰æ›

  ğŸ”§ æ–°è¦ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ :
    - normalizeTilt(tiltX, tiltY)
      - ç¯„å›²ãƒã‚§ãƒƒã‚¯ãƒ»ã‚¯ãƒ©ãƒ³ãƒ—
      - ãƒ‡ãƒƒãƒ‰ã‚¾ãƒ¼ãƒ³å‡¦ç†ï¼ˆÂ±5åº¦ä»¥å†…ã¯0æ‰±ã„ï¼‰

Step 5-2: ãƒ‡ãƒ¼ã‚¿ãƒ¢ãƒ‡ãƒ«æ‹¡å¼µ
ğŸ“„ data-models.js
  ğŸ”§ StrokePoint æ§‹é€ è¿½åŠ :
    - tiltX: number (-1ã€œ1)
    - tiltY: number (-1ã€œ1)
    - twist: number (0ã€œ2Ï€)
    - tiltMagnitude: number (0ã€œ1, å‚¾ãé‡)
    - tiltAngle: number (0ã€œ2Ï€, å‚¾ãæ–¹å‘)

Step 5-3: stroke-recorder æ‹¡å¼µ
ğŸ“„ stroke-recorder.js
  ğŸ”§ recordPoint() ä¿®æ­£:
    - tilt/twist ãƒ‡ãƒ¼ã‚¿è¿½åŠ 
    - tiltMagnitude = sqrt(tiltXÂ² + tiltYÂ²)
    - tiltAngle = atan2(tiltY, tiltX)

Step 5-4: stroke-renderer å‚¾ãé€£æº
ğŸ“„ stroke-renderer.js
  ğŸ”§ æ–°è¦æ©Ÿèƒ½è¿½åŠ :
    - calculateTiltWidth(point, baseWidth)
      - å‚¾ãé‡ã«å¿œã˜ãŸå¹…å¤‰èª¿
      - è¨­å®š: tiltSensitivity (0ã€œ1)
    - calculateTiltRotation(point)
      - ãƒ–ãƒ©ã‚·å½¢çŠ¶ã®å›è»¢ï¼ˆæ¥•å††ãƒšãƒ³ç”¨ï¼‰

Step 5-5: brush-settings æ‹¡å¼µ
ğŸ“„ brush-settings.js
  ğŸ”§ è¨­å®šé …ç›®è¿½åŠ :
    - tiltSensitivity: 0.5 (å‚¾ãæ„Ÿåº¦)
    - tiltAffectsWidth: true (å¹…å¤‰èª¿ON/OFF)
    - tiltAffectsRotation: false (å›è»¢ON/OFF)
    - tiltWidthMin: 0.3 (æœ€å°å¹…æ¯”ç‡)
    - tiltWidthMax: 1.5 (æœ€å¤§å¹…æ¯”ç‡)

Step 5-6: WebGL2ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼å¯¾å¿œ
ğŸ“„ shaders/render.vert.glsl
  ğŸ”§ é ‚ç‚¹å±æ€§è¿½åŠ :
    attribute vec2 a_tilt; // tiltX, tiltY
    attribute float a_twist;
    varying vec2 v_tilt;
    varying float v_twist;

ğŸ“„ shaders/render.frag.glsl
  ğŸ”§ å‚¾ããƒ™ãƒ¼ã‚¹æç”»:
    - v_tilt ã‚’ä½¿ã£ãŸæ¥•å††å½¢çŠ¶
    - v_twist ã«ã‚ˆã‚‹å›è»¢

Step 5-7: UIå®Ÿè£…
ğŸ“„ ui/settings-popup.js
  ğŸ”§ å‚¾ãè¨­å®šUIè¿½åŠ :
    - ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼: å‚¾ãæ„Ÿåº¦
    - ãƒˆã‚°ãƒ«: å¹…å¤‰èª¿ãƒ»å›è»¢ON/OFF
    - ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‚¾ãå¯è¦–åŒ–

æ‰€è¦æ™‚é–“: 3-4æ™‚é–“
ä¾å­˜é–¢ä¿‚: Phase 4 å®Œäº†å¾Œã«å®Ÿæ–½

================================================================================

â–  æ®µéšçš„å®Ÿè£…ãƒ•ãƒ­ãƒ¼ï¼ˆæ¨å¥¨é †åºï¼‰

ã€Week 1ã€‘
Phase 1: PixiJS v8 å…¬å¼ã‚µãƒ³ãƒ—ãƒ«çµ±åˆ
  â†’ webgl-geometry-layer.js å®Ÿè£…
  â†’ stroke-renderer.js æ”¹ä¿®
  æœŸå¾…æˆæœ: Meshç”Ÿæˆã®æœ€é©åŒ–ãƒ»å®‰å®šåŒ–

Phase 4-1ã€œ4-3: MSDFçµ±åˆï¼ˆå‰åŠï¼‰
  â†’ data-models.js æ‹¡å¼µ
  â†’ gl-stroke-processor.js æ‹¡å¼µ
  â†’ gl-msdf-pipeline.js ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»çµ±åˆ
  æœŸå¾…æˆæœ: MSDFãƒ†ã‚¯ã‚¹ãƒãƒ£ç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å®Œæˆ

ã€Week 2ã€‘
Phase 4-4ã€œ4-5: MSDFçµ±åˆï¼ˆå¾ŒåŠï¼‰
  â†’ render.frag.glsl å®Ÿè£…
  â†’ webgl2-drawing-layer.js çµ±åˆ
  æœŸå¾…æˆæœ: MSDFæç”»å®Œå…¨å‹•ä½œ

Phase 5-1ã€œ5-4: ãƒšãƒ³å‚¾ãå®Ÿè£…ï¼ˆå‰åŠï¼‰
  â†’ pointer-handler.js æ‹¡å¼µ
  â†’ data-models.js æ‹¡å¼µ
  â†’ stroke-recorder.js æ‹¡å¼µ
  â†’ stroke-renderer.js å‚¾ãé€£æº
  æœŸå¾…æˆæœ: å‚¾ããƒ‡ãƒ¼ã‚¿å–å¾—ãƒ»è¨˜éŒ²å®Œäº†

ã€Week 3ã€‘
Phase 5-5ã€œ5-7: ãƒšãƒ³å‚¾ãå®Ÿè£…ï¼ˆå¾ŒåŠï¼‰
  â†’ brush-settings.js æ‹¡å¼µ
  â†’ WebGL2ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼å¯¾å¿œ
  â†’ UIå®Ÿè£…
  æœŸå¾…æˆæœ: å‚¾ãæ¤œå‡ºãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³å®Œå…¨å‹•ä½œï¼ˆ120Hzå¯¾å¿œï¼‰

Phase 2: Penpot åº§æ¨™å¤‰æ›ãƒ¬ãƒ“ãƒ¥ãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  â†’ coordinate-system.js æœ€é©åŒ–
  æœŸå¾…æˆæœ: åº§æ¨™å¤‰æ›ç²¾åº¦å‘ä¸Š

ã€Week 4ã€œã€‘
Phase 3: Penpot History Manager æ”¹å–„ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰
  â†’ history.js æœ€é©åŒ–
  æœŸå¾…æˆæœ: Undo/Redoé«˜é€ŸåŒ–ãƒ»ãƒ¡ãƒ¢ãƒªåŠ¹ç‡åŒ–

çµ±åˆãƒ†ã‚¹ãƒˆãƒ»ãƒ‡ãƒãƒƒã‚°
  â†’ æ¶²ã‚¿ãƒ–å®Ÿæ©Ÿãƒ†ã‚¹ãƒˆï¼ˆ120Hzç¢ºèªï¼‰
  â†’ å‚¾ããƒ»ç­†åœ§ãƒ»ãƒ„ã‚¤ã‚¹ãƒˆåŒæ™‚å‹•ä½œç¢ºèª
  â†’ MSDFæç”»å“è³ªãƒã‚§ãƒƒã‚¯

================================================================================

â–  æ³¨æ„äº‹é …ãƒ»åˆ¶ç´„ç¢ºèª

ã€ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³éµå®ˆã€‘
âœ… åº§æ¨™å¤‰æ›ä¸€æœ¬åŒ–: drawing-engine ã®ã¿ãŒå¤‰æ›ã‚ªãƒ¼ãƒŠãƒ¼
âœ… äºŒé‡å¤‰æ›ç¦æ­¢: stroke-recorder ã¯åº§æ¨™å¤‰æ›ãªã—
âœ… Pixi toLocal()/toGlobal() ä½¿ç”¨ç¦æ­¢
âœ… CPU ãƒ©ã‚¹ã‚¿ãƒ©ã‚¤ã‚ºç¦æ­¢: å…¨ã¦GPUå‡¦ç†
âœ… Canvas2D ä½¿ç”¨ç¦æ­¢ï¼ˆãƒ‡ãƒãƒƒã‚°é™¤ãï¼‰
âœ… DPRå›ºå®š1.0
âœ… Historyç™»éŒ²: pointerupæ™‚ã®ã¿

ã€ä¾å­˜é–¢ä¿‚ç®¡ç†ã€‘
ğŸ“ drawing-engine.js
  â”œâ”€ ğŸ“„ pointer-handler.js (PointerEventå–å¾—)
  â”œâ”€ ğŸ“„ pressure-handler.js (ç­†åœ§å‡¦ç†)
  â”œâ”€ ğŸ“ coordinate-system.js (åº§æ¨™å¤‰æ›)
  â””â”€ ğŸ“„ stroke-recorder.js (è¨˜éŒ²)

ğŸ“„ stroke-recorder.js
  â””â”€ ğŸ“„ stroke-renderer.js (ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°)

ğŸ“„ stroke-renderer.js
  â”œâ”€ ğŸ“„ webgl-geometry-layer.js (Meshç”Ÿæˆ) â† Phase 1
  â””â”€ ğŸ“„ gl-stroke-processor.js (é ‚ç‚¹è»¢é€)

ğŸ“„ gl-stroke-processor.js
  â””â”€ ğŸ“„ gl-msdf-pipeline.js (MSDFç”Ÿæˆ) â† Phase 4

ğŸ“„ gl-msdf-pipeline.js
  â”œâ”€ ğŸ“„ seed-init.frag.glsl
  â”œâ”€ ğŸ“„ jfa-pass.frag.glsl
  â””â”€ ğŸ“„ encode.frag.glsl

ğŸ“ webgl2-drawing-layer.js (çµ±åˆãƒ»å‡ºåŠ›)
  â”œâ”€ ğŸ“„ render.vert.glsl
  â””â”€ ğŸ“„ render.frag.glsl â† Phase 4

ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€‘
âœ… window.CoordinateSystem
âœ… window.cameraSystem
âœ… window.layerManager
âœ… window.historyManager (æ—§ window.History å»ƒæ­¢æ¸ˆã¿)
âœ… window.WebGLContext (WebGL2çµ±åˆç®¡ç†)
âœ… window.PixiUI (Pixi UIå°‚ç”¨ã€WebGLæ“ä½œç¦æ­¢)

ã€ç¦æ­¢äº‹é …å†ç¢ºèªã€‘
âŒ äºŒé‡å¤‰æ›
âŒ Pixi.Graphics æœ¬ç•ªæç”»ä½¿ç”¨
âŒ CPU SDF/MSDF è¨ˆç®—
âŒ strokeTypeåˆ†é›¢å®Ÿè£…
âŒ å¾ªç’°ä¾å­˜

================================================================================

â–  å®Œäº†åˆ¤å®šåŸºæº–

ã€Phase 1 å®Œäº†æ¡ä»¶ã€‘
âœ… webgl-geometry-layer.js å‹•ä½œç¢ºèª
âœ… PixiJSå…¬å¼Meshç”Ÿæˆã‚³ãƒ¼ãƒ‰ã§æç”»æˆåŠŸ
âœ… VBO/IBOè»¢é€æ­£å¸¸

ã€Phase 4 å®Œäº†æ¡ä»¶ã€‘
âœ… MSDFãƒ†ã‚¯ã‚¹ãƒãƒ£ç”Ÿæˆç¢ºèª
âœ… render.frag.glsl ã§ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹æç”»
âœ… ç­†åœ§ãƒ™ãƒ¼ã‚¹å¹…å¤‰èª¿å‹•ä½œ

ã€Phase 5 å®Œäº†æ¡ä»¶ã€‘
âœ… æ¶²ã‚¿ãƒ–ã§tiltX/tiltYå–å¾—ç¢ºèª
âœ… å‚¾ããƒ™ãƒ¼ã‚¹å¹…å¤‰èª¿å‹•ä½œ
âœ… 120Hzãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒ¬ãƒ¼ãƒˆç¶­æŒ
âœ… twistï¼ˆã²ã­ã‚Šå›è»¢ï¼‰æ¤œå‡ºå‹•ä½œ

ã€å…¨ä½“å®Œäº†æ¡ä»¶ã€‘
âœ… ProcreateDreams / ToonSquid2 ç›¸å½“ã®ãƒšãƒ³å“è³ªé”æˆ
âœ… åº§æ¨™å¤‰æ›ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å˜ä¸€è²¬å‹™ç¶­æŒ
âœ… WebGL2 / PixiJS è²¬å‹™åˆ†é›¢ç¶­æŒ
âœ… Historyç™»éŒ²æ­£å¸¸å‹•ä½œ
âœ… file:// ç›´é–‹ãå‹•ä½œç¢ºèª

================================================================================
End of Document
================================================================================