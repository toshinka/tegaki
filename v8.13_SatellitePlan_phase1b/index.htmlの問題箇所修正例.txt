<!-- ğŸ”¥ ç·Šæ€¥ä¿®æ­£ï¼šindex.htmlã®å•é¡Œç®‡æ‰€ä¿®æ­£ä¾‹ -->

<!-- 
ERROR: index.html:788 Uncaught TypeError: Cannot destructure property 'CoreEngine' of 'window.TegakiCore' as it is undefined.

ä¿®æ­£å‰ï¼ˆã‚¨ãƒ©ãƒ¼ã®åŸå› ï¼‰:
const { CoreEngine } = window.TegakiCore;
const coreEngine = new CoreEngine(app);

ä¿®æ­£å¾Œï¼ˆå®‰å…¨ãªæ›¸ãæ–¹ï¼‰:
-->

<script>
// ğŸ”¥ ç·Šæ€¥ä¿®æ­£ï¼šæ§‹é€ åŒ–ä»£å…¥ã‚¨ãƒ©ãƒ¼ã®ä¿®æ­£
// window.TegakiCoreãŒç¢ºå®Ÿã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
if (!window.TegakiCore) {
    console.error('CRITICAL: TegakiCore not loaded. Check core-engine.js loading.');
    throw new Error('core-engine.js dependency missing');
}

// ğŸ”¥ ä¿®æ­£æ–¹æ³•1: ç›´æ¥ã‚¢ã‚¯ã‚»ã‚¹ï¼ˆæ¨å¥¨ï¼‰
const CoreEngine = window.TegakiCore.CoreEngine;
if (!CoreEngine) {
    console.error('CRITICAL: CoreEngine class not found in TegakiCore');
    throw new Error('CoreEngine class missing');
}

// ğŸ”¥ ä¿®æ­£æ–¹æ³•2: åˆæœŸåŒ–é–¢æ•°ã‚’ä½¿ç”¨ï¼ˆã‚ˆã‚Šå®‰å…¨ï¼‰
// const coreEngine = window.TegakiCore.initialize(app);

// å¾“æ¥é€šã‚Šã®åˆæœŸåŒ–
const coreEngine = new CoreEngine(app);
const drawingApp = coreEngine.initialize();

// ã‚°ãƒ­ãƒ¼ãƒãƒ«å‚ç…§ã‚’è¨­å®šï¼ˆä»–ã®ã‚³ãƒ¼ãƒ‰ã¨ã®äº’æ›æ€§ã®ãŸã‚ï¼‰
window.drawingApp = drawingApp;

console.log('âœ… TEGAKI initialization completed successfully (EMERGENCY FIX)');
</script>

<!-- 
è¿½åŠ ã®å®‰å…¨å¯¾ç­–ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿é †åºã®ç¢ºä¿ï¼‰:

1. config.js
2. coordinate-system.js  â† ğŸ”¥ ç·Šæ€¥ä¿®æ­£ç‰ˆã‚’ä½¿ç”¨
3. ui-panels.js
4. core-engine.js       â† ğŸ”¥ ç·Šæ€¥ä¿®æ­£ç‰ˆã‚’ä½¿ç”¨
5. main.jsï¼ˆã¾ãŸã¯index.htmlå†…ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆéƒ¨åˆ†ï¼‰

å„ãƒ•ã‚¡ã‚¤ãƒ«ãŒç¢ºå®Ÿã«èª­ã¿è¾¼ã¾ã‚Œã¦ã„ã‚‹ã‹ãƒã‚§ãƒƒã‚¯:
-->

<script>
// ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ç¢ºèªï¼ˆãƒ‡ãƒãƒƒã‚°ç”¨ï¼‰
const checkDependencies = () => {
    const dependencies = [
        { name: 'TEGAKI_CONFIG', obj: window.TEGAKI_CONFIG },
        { name: 'CoordinateSystem', obj: window.CoordinateSystem },
        { name: 'UIController', obj: window.UIController },
        { name: 'TegakiCore', obj: window.TegakiCore }
    ];
    
    let allLoaded = true;
    
    dependencies.forEach(dep => {
        if (!dep.obj) {
            console.error(`âŒ ${dep.name} not loaded`);
            allLoaded = false;
        } else {
            console.log(`âœ… ${dep.name} loaded successfully`);
        }
    });
    
    return allLoaded;
};

// åˆæœŸåŒ–å‰ã«ä¾å­˜é–¢ä¿‚ã‚’ãƒã‚§ãƒƒã‚¯
if (!checkDependencies()) {
    console.error('CRITICAL: Some dependencies are missing. Cannot initialize TEGAKI.');
} else {
    console.log('ğŸ”¥ All dependencies loaded successfully - proceeding with EMERGENCY FIX initialization');
}
</script>