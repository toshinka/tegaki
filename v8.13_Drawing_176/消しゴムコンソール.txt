config.js:500 âœ… config.js v8.14.0 loaded (Phase 1: DPR=1å›ºå®šåŒ–)
config.js:501    ğŸš¨ renderer.resolution = 1 (devicePixelRatioå‚ç…§ã‚’å‰Šé™¤)
 âœ… data-models.js (backgroundColorè¿½åŠ ç‰ˆ) loaded
 âœ… batch-api.js (Phase 6: Historyçµ±åˆç‰ˆ) loaded
 âœ… popup-manager.js (quick-accessé™¤å¤–å¯¾å¿œç‰ˆ) loaded
 âœ… state-manager.js (Phase 8å®Œå…¨å®Ÿè£…ç‰ˆ) loaded
 âœ… settings-manager.js Phase 2 loaded
    ğŸ”§ exportResolution è¨­å®šé …ç›®è¿½åŠ 
 âœ… layer-transform.js Phase 6 loaded
    ğŸ”§ flipLayer(): confirmTransform()å‰Šé™¤ - åè»¢æ™‚ã®ç”»åƒæ¶ˆå¤±ã‚’è§£æ±º
 âœ… system/checker-utils.js çµ±ä¸€å®Ÿè£…ç‰ˆ loaded
 âœ… layer-system.js Phase 5 loaded
    ğŸ”§ Vã‚­ãƒ¼ã‚¤ãƒ™ãƒ³ãƒˆçµ±ä¸€: keyboard:vkey-state-changed
    ğŸ”§ selectNextLayer(), selectPrevLayer(): ãƒ¬ã‚¤ãƒ¤ãƒ¼é¸æŠæ©Ÿèƒ½å®Œå‚™
 âœ… drawing-clipboard.js Phase 1 loaded
    ğŸ”§ cutActiveLayer(): æç”»ã®ã¿å‰Šé™¤ï¼ˆãƒ¬ã‚¤ãƒ¤ãƒ¼ä¿æŒï¼‰
    ğŸ¨ ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ”ãƒ¼ã€åˆ‡ã‚Šå–ã‚Š
 âœ… history.js (Phase 3: Redo nullå‚ç…§ä¿®æ­£ç‰ˆ) loaded
 âœ… system/drawing/webgpu/webgpu-capabilities.js loaded
 âœ… webgpu-compute-sdf.js (Phase 1é–‰é ˜åŸŸæ¤œå‡ºä¿®æ­£ç‰ˆ) loaded
 âœ… system/drawing/msdf/msdf-brush-shader.js loaded
 âœ… pointer-handler.js (Phase 2: ãƒ’ãƒ¥ãƒ¼ãƒªã‚¹ãƒ†ã‚£ãƒƒã‚¯è¿½åŠ ç‰ˆ) loaded
    âœ“ pointerType="mouse" with pressure/tilt â†’ auto-corrects to "pen"
 âœ… pressure-handler.js (Phase 4: ã‚°ãƒ­ãƒ¼ãƒãƒ«å…¬é–‹ç‰ˆ) loaded
    âœ“ è·é›¢ãƒ™ãƒ¼ã‚¹ãƒ•ã‚£ãƒ«ã‚¿å¯¾å¿œ
    âœ“ window.PressureHandler ã¨ã—ã¦å…¬é–‹
 âœ… curve-interpolator.js (Phase 3) loaded
    - Catmull-Rom ã‚¹ãƒ—ãƒ©ã‚¤ãƒ³è£œé–“
curve-interpolator.js:207    - é©å¿œçš„ã‚µãƒ³ãƒ—ãƒªãƒ³ã‚°å¯¾å¿œ
curve-interpolator.js:208    - tiltX/Y/twist ãƒ‡ãƒ¼ã‚¿è£œé–“å¯¾å¿œ
stroke-recorder.js:87 âœ… stroke-recorder.js (è­¦å‘Šãƒ­ã‚°å‰Šæ¸›ç‰ˆ) loaded
stroke-recorder.js:88    âœ“ ä¸è¦ãªè­¦å‘Šãƒ­ã‚°ã‚’å‰Šé™¤
stroke-recorder.js:89    âœ“ DRYåŸå‰‡æº–æ‹ 
sdf-brush-shader.js:142 âœ… sdf-brush-shader.js (Phase 1-FIX: ãƒšãƒ³å°‚ç”¨) loaded
sdf-brush-shader.js:143    âœ“ æ¶ˆã—ã‚´ãƒ ãƒ¢ãƒ¼ãƒ‰å‰Šé™¤
sdf-brush-shader.js:144    âœ“ ãƒšãƒ³æç”»ã«ç‰¹åŒ–
sdf-mesh-builder.js:308 âœ… sdf-mesh-builder.js (Phase 3-B) loaded
sdf-mesh-builder.js:309    âœ“ Segment mesh generation
sdf-mesh-builder.js:310    âœ“ Optimized batch mesh generation
sdf-mesh-builder.js:311    âœ“ Preview mesh with simplification
sdf-mesh-builder.js:312    âœ“ Custom shader support
stroke-renderer.js:496 âœ… stroke-renderer.js (Phase 1-FIX) loaded
stroke-renderer.js:497    ğŸ”§ æ¶ˆã—ã‚´ãƒ : Shaderä¸ä½¿ç”¨ + blendMode=erase
stroke-renderer.js:498    âœ… ãƒšãƒ³: SDF/MSDF Shaderä½¿ç”¨
stroke-renderer.js:499    âœ… PixiJS v8 BlendModeäº’æ›
thumbnail-system.js:507 âœ… thumbnail-system.js (v1.1: çµ±ä¸€ã‚¢ã‚¹ãƒšã‚¯ãƒˆæ¯”å¯¾å¿œ) loaded
brush-settings.js:222 âœ… brush-settings.js (Phase 3-D Clean) loaded
brush-core.js:372 âœ… brush-core.js (Phase 1-FIX) loaded
brush-core.js:373    ğŸ”§ æ¶ˆã—ã‚´ãƒ ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ ã‚’ä¿®æ­£
brush-core.js:374    ğŸ”§ tool/mode è¨˜éŒ²ã‚’çµ±ä¸€
fill-tool.js:334 âœ… fill-tool.js (Phase 1å®Œå…¨ä¿®æ­£ç‰ˆ) loaded
drawing-engine.js:244 âœ… drawing-engine.js (Phase 4 - Fillå¯¾å¿œç‰ˆ) loaded
drawing-engine.js:245    âœ“ fill ãƒ¢ãƒ¼ãƒ‰æ™‚ã« canvas:pointerdown ã‚¤ãƒ™ãƒ³ãƒˆç™ºè¡Œ
drawing-engine.js:246    âœ“ localX/localY ã‚’å«ã‚€ã‚¤ãƒ™ãƒ³ãƒˆãƒšã‚¤ãƒ­ãƒ¼ãƒ‰
quick-export-ui.js:292 âœ… quick-export-ui.js (ç„¡åŠ¹åŒ–ç‰ˆ) loaded
export-manager.js:263 âœ… export-manager.js (é«˜DPIå¯¾å¿œç‰ˆ) loaded
export-manager.js:264    âœ“ renderToCanvas ã§ resolution é©ç”¨
export-manager.js:265    âœ“ å‡ºåŠ›æ™‚ã«é«˜DPIç¶­æŒ
png-exporter.js:124 âœ… png-exporter.js (é«˜DPIå¯¾å¿œç‰ˆ) loaded
png-exporter.js:125    âœ“ resolution="auto" ã§ç”»é¢DPIé©ç”¨
png-exporter.js:126    âœ“ æç”»ä½“é¨“ã¨å‡ºåŠ›ã®æ•´åˆæ€§ç¢ºä¿
apng-exporter.js:236 âœ… apng-exporter.js (CUTâ†’FRAMEå®Œå…¨ä¿®æ­£ç‰ˆ) loaded
gif-exporter.js:300 âœ… gif-exporter.js (CUTâ†’FRAMEå®Œå…¨ä¿®æ­£ç‰ˆ) loaded
webp-exporter.js:289 âœ… webp-exporter.js (é™æ­¢ç”»ãƒ»å‹•ç”»è‡ªå‹•åˆ¤å®šå¯¾å¿œç‰ˆ) loaded
mp4-exporter.js:30 âœ… mp4-exporter.js (Phase 8å®Œæˆç‰ˆ) loaded
dom-builder.js:495 âœ… dom-builder.js v8.13.3 loaded
dom-builder.js:496    âœ“ å¡—ã‚Šã¤ã¶ã—ã‚¢ã‚¤ã‚³ãƒ³è¿½åŠ  (æ¶ˆã—ã‚´ãƒ ã®ä¸‹)
slider-utils.js:234 âœ… slider-utils.js v8.13.10 loaded
slider-utils.js:235    ğŸ”§ PointerEventå®Œå…¨å¯¾å¿œï¼ˆã‚¿ãƒ–ãƒ¬ãƒƒãƒˆãƒšãƒ³å¼•ã£ã‹ã‹ã‚Šè§£æ¶ˆï¼‰
slider-utils.js:236    ğŸ”§ æ…£æ€§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«å®Ÿè£…ï¼ˆvelocityè¨ˆç®—ï¼‰
slider-utils.js:237    ğŸ”§ requestAnimationFrameæœ€é©åŒ–
keyboard-handler.js:486 âœ… keyboard-handler.js Phase 6å®Œæˆç‰ˆ loaded
keyboard-handler.js:487    âœ… BS/DEL: æç”»å‰Šé™¤ãŒæ­£å¸¸å‹•ä½œ
keyboard-handler.js:488    âœ… Undo/Redo: childrenå‚ç…§ä¿æŒã§å®Œå…¨å¾©å…ƒ
keyboard-handler.js:489    ğŸ”§ åè»¢å‡¦ç†: ç”»åƒæ¶ˆå¤±å•é¡Œè§£æ±º
layer-panel-renderer.js:663 âœ… layer-panel-renderer.js (Phase 5+6å¯¾å¿œç‰ˆ) loaded
layer-panel-renderer.js:664    âœ“ layer:panel-update-requested ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
layer-panel-renderer.js:665    âœ“ LayerSystemã‹ã‚‰ã®ç›´æ¥å‘¼ã³å‡ºã—å®Œå…¨æ’é™¤
status-display-renderer.js:113 âœ… ui/status-display-renderer.js loaded
timeline-thumbnail-utils.js:258 âœ… ui/timeline-thumbnail-utils.js (Phase 3å®Œå…¨ç‰ˆ) loaded
timeline-thumbnail-utils.js:259    âœ“ Phase 1: layer:transform-updated è³¼èª­è¿½åŠ 
timeline-thumbnail-utils.js:260    âœ“ Phase 3: throttleæœ€é©åŒ–ï¼ˆ100msï¼‰
timeline-thumbnail-utils.js:261    âœ“ Phase 3: immediate ãƒ•ãƒ©ã‚°å¯¾å¿œ
timeline-thumbnail-utils.js:262    âœ“ ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ã‚µãƒ ãƒã‚¤ãƒ«ãŒãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰å½¢ã«å³åº§è¿½å¾“
timeline-ui.js:981 âœ… timeline-ui.js (Phase 4å®Œäº†: ãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰å½¢é€£æºç‰ˆ) loaded
album-popup.js:473 âœ… album-popup.js (FRAMEæ”¹ä¿®ç‰ˆ) loaded
settings-popup.js:649 âœ… settings-popup.js Phase 1 loaded
settings-popup.js:650    ğŸ”§ ui:open-settings ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ ï¼ˆCtrl+, å¯¾å¿œï¼‰
quick-access-popup.js:740 âœ… quick-access-popup.js v8.13.17 loaded
export-popup.js:492 âœ… export-popup.js (é«˜DPIå¯¾å¿œç‰ˆ) loaded
export-popup.js:493    âœ“ é«˜DPIå‡ºåŠ›ã‚ªãƒ—ã‚·ãƒ§ãƒ³è¿½åŠ 
export-popup.js:494    âœ“ resolution="auto" ã‚’ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé©ç”¨
ui-panels.js:420 âœ… ui-panels.js v8.13.15 loaded
ui-panels.js:421    ğŸ¨ ã‚µã‚¤ãƒ‰ãƒãƒ¼è»½é‡ãƒ‡ã‚¶ã‚¤ãƒ³: ã‚ªãƒ¬ãƒ³ã‚¸æ ã®ã¿
ui-panels.js:422    ğŸ¯ SVGè‰²çµ±ä¸€: å¸¸ã«var(--futaba-maroon)
core-runtime.js:570 âœ… core-runtime.js (Phase 4 - Fillå¯¾å¿œç‰ˆ) loaded
core-runtime.js:571    âœ“ api.tool.setFill() è¿½åŠ 
core-runtime.js:572    âœ“ api.tool.set("fill") ã‚µãƒãƒ¼ãƒˆ
core-engine.js:715 âœ… core-engine.js (Phase 3ä¿®æ­£ç‰ˆ - UnifiedKeyHandlerä¿®æ­£) loaded
core-initializer.js:437 âœ… core-initializer.js (Phase 2æ”¹ä¿®ç‰ˆ - ExportManageråˆæœŸåŒ–ä¸€å…ƒåŒ–) loaded
core-engine.js:181 [CoreEngine] Constructor complete (Phase 6 - DIPæ”¹å–„)
core-engine.js:182    âœ“ BrushSettings created: true
brush-core.js:95 âœ… [BrushCore] Initialized (Phase 1-FIX)
popup-manager.js:16 âœ… PopupManager initialized
popup-manager.js:42 ğŸ“‹ Popup "settings" registered (priority: 1)
popup-manager.js:42 ğŸ“‹ Popup "quickAccess" registered (priority: 2)
popup-manager.js:42 ğŸ“‹ Popup "album" registered (priority: 3)
popup-manager.js:42 ğŸ“‹ Popup "resize" registered (priority: 4)
popup-manager.js:102 ğŸ”§ Initializing all popups...
popup-manager.js:87 âœ… Popup "settings" initialized successfully
popup-manager.js:87 âœ… Popup "quickAccess" initialized successfully
popup-manager.js:87 âœ… Popup "album" initialized successfully
popup-manager.js:87 âœ… Popup "resize" initialized successfully
popup-manager.js:118 ğŸ“Š Popup initialization: 4 ready, 0 deferred
index.html:106 âœ… Application initialized (Phase 4-B: MSDFå®Œå…¨çµ±åˆç‰ˆ)
popup-manager.js:42 ğŸ“‹ Popup "export" registered (priority: 5)
popup-manager.js:87 âœ… Popup "export" initialized successfully
// ğŸ” renderFinalStroke ã®æˆ»ã‚Šå€¤ã‚’è©³ã—ãèª¿æŸ»
const originalRenderFinal = window.strokeRenderer.renderFinalStroke;
window.strokeRenderer.renderFinalStroke = async function(strokeData, settings) {
    console.log('ğŸ” === renderFinalStroke START ===');
    console.log('ğŸ” strokeData:', strokeData);
    console.log('ğŸ” strokeData.points.length:', strokeData.points?.length);
    console.log('ğŸ” settings.mode:', settings?.mode);
    
    const result = await originalRenderFinal.call(this, strokeData, settings);
    
    console.log('ğŸ” === renderFinalStroke END ===');
    console.log('ğŸ” Result:', result);
    console.log('ğŸ” Result is null?', result === null);
    console.log('ğŸ” Result is undefined?', result === undefined);
    console.log('ğŸ” Result type:', typeof result);
    
    if (result) {
        console.log('ğŸ” Result.constructor:', result.constructor?.name);
        console.log('ğŸ” Result.blendMode:', result.blendMode);
    }
    
    return result;
};

// ã“ã®çŠ¶æ…‹ã§æ¶ˆã—ã‚´ãƒ ã‚’ä½¿ã£ã¦ãã ã•ã„
async Æ’ (strokeData, settings) {
    console.log('ğŸ” === renderFinalStroke START ===');
    console.log('ğŸ” strokeData:', strokeData);
    console.log('ğŸ” strokeData.points.length:', strokeData.points?.lengtâ€¦
VM287:4 ğŸ” === renderFinalStroke START ===
VM287:5 ğŸ” strokeData: {points: Array(155), isSingleDot: false, duration: 709}
VM287:6 ğŸ” strokeData.points.length: 155
VM287:7 ğŸ” settings.mode: eraser
VM287:11 ğŸ” === renderFinalStroke END ===
VM287:12 ğŸ” Result: orÂ {_events: i, _eventsCount: 0, uid: 21, _updateFlags: 15, renderGroup: null,Â â€¦}
VM287:13 ğŸ” Result is null? false
VM287:14 ğŸ” Result is undefined? false
VM287:15 ğŸ” Result type: object
VM287:18 ğŸ” Result.constructor: or
VM287:19 ğŸ” Result.blendMode: erase
// ğŸ” brush-core.js ã® finalizeStroke ã‚’å®Œå…¨ãƒˆãƒ¬ãƒ¼ã‚¹
const originalFinalize = window.BrushCore.finalizeStroke;
window.BrushCore.finalizeStroke = async function() {
    console.log('ğŸ” === finalizeStroke START ===');
    
    const activeLayer = this.layerManager.getActiveLayer();
    console.log('ğŸ” Active layer:', activeLayer);
    console.log('ğŸ” Children before:', activeLayer.children.length);
    
    const strokeData = this.strokeRecorder.endStroke();
    console.log('ğŸ” strokeData.points:', strokeData.points.length);
    
    const settings = this._getCurrentSettings();
    console.log('ğŸ” settings.mode:', settings.mode);
    
    const graphics = await this.strokeRenderer.renderFinalStroke(strokeData, settings);
    console.log('ğŸ” graphics returned:', graphics);
    console.log('ğŸ” graphics is truthy?', !!graphics);
    console.log('ğŸ” if (graphics) will pass?', graphics ? 'YES' : 'NO');
    
    if (graphics) {
        console.log('ğŸ” INSIDE if(graphics) block');
        console.log('ğŸ” About to call activeLayer.addChild');
        activeLayer.addChild(graphics);
        console.log('ğŸ” addChild completed');
        console.log('ğŸ” Children after:', activeLayer.children.length);
    } else {
        console.log('ğŸ” graphics is falsy, skipping addChild');
    }
    
    console.log('ğŸ” === finalizeStroke END ===');
    
    return originalFinalize.call(this);
};

// ã“ã®çŠ¶æ…‹ã§æ¶ˆã—ã‚´ãƒ ã‚’ä½¿ã£ã¦ãã ã•ã„
async Æ’ () {
    console.log('ğŸ” === finalizeStroke START ===');
    
    const activeLayer = this.layerManager.getActiveLayer();
    console.log('ğŸ” Active layer:', activeLayer);
    console.log('ğŸ” Childreâ€¦
VM297:4 ğŸ” === finalizeStroke START ===
VM297:7 ğŸ” Active layer: ZÂ {_events: i, _eventsCount: 0, uid: 17, _updateFlags: 0, renderGroup: Pi,Â â€¦}
VM297:8 ğŸ” Children before: 3
VM297:11 ğŸ” strokeData.points: 217
VM297:14 ğŸ” settings.mode: eraser
VM287:4 ğŸ” === renderFinalStroke START ===
VM287:5 ğŸ” strokeData: {points: Array(217), isSingleDot: false, duration: 1216}
VM287:6 ğŸ” strokeData.points.length: 217
VM287:7 ğŸ” settings.mode: eraser
VM287:11 ğŸ” === renderFinalStroke END ===
VM287:12 ğŸ” Result: orÂ {_events: i, _eventsCount: 0, uid: 23, _updateFlags: 15, renderGroup: null,Â â€¦}
VM287:13 ğŸ” Result is null? false
VM287:14 ğŸ” Result is undefined? false
VM287:15 ğŸ” Result type: object
VM287:18 ğŸ” Result.constructor: or
VM287:19 ğŸ” Result.blendMode: erase
VM297:17 ğŸ” graphics returned: orÂ {_events: i, _eventsCount: 0, uid: 23, _updateFlags: 15, renderGroup: null,Â â€¦}
VM297:18 ğŸ” graphics is truthy? true
VM297:19 ğŸ” if (graphics) will pass? YES
VM297:22 ğŸ” INSIDE if(graphics) block
VM297:23 ğŸ” About to call activeLayer.addChild
VM297:25 ğŸ” addChild completed
VM297:26 ğŸ” Children after: 4
VM297:31 ğŸ” === finalizeStroke END ===
VM287:4 ğŸ” === renderFinalStroke START ===
VM287:5 ğŸ” strokeData: {points: Array(0), isSingleDot: false}
VM287:6 ğŸ” strokeData.points.length: 0
VM287:7 ğŸ” settings.mode: eraser
VM287:11 ğŸ” === renderFinalStroke END ===
VM287:12 ğŸ” Result: orÂ {_events: i, _eventsCount: 0, uid: 24, _updateFlags: 15, renderGroup: null,Â â€¦}
VM287:13 ğŸ” Result is null? false
VM287:14 ğŸ” Result is undefined? false
VM287:15 ğŸ” Result type: object
VM287:18 ğŸ” Result.constructor: or
VM287:19 ğŸ” Result.blendMode: erase
