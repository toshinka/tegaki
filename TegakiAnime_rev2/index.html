<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¨ Tegaki Anime v2.0 - Konva.js + WebGL2 Raster</title>
    <link rel="stylesheet" href="styles/main.css">
</head>

<body>
    <div id="app"></div>

    <!-- ========================================
         External Libraries (CDN - é–‹ç™ºä¸­)
         æœ¬ç•ª: libs/ãƒ•ã‚©ãƒ«ãƒ€ã«æ ¼ç´
         ======================================== -->
    
    <!-- Konva.js -->
    <script src="https://cdn.jsdelivr.net/npm/konva@9/konva.min.js"></script>
    
    <!-- PixiJS v8 -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@8/dist/pixi.min.js"></script>
    
    <!-- UPNG (APNG/PNGåœ§ç¸®) -->
    <script src="https://cdn.jsdelivr.net/npm/upng-js@2/UPNG.js"></script>
    
    <!-- GSAP (ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³) -->
    <script src="https://cdn.jsdelivr.net/npm/gsap@3/dist/gsap.min.js"></script>

    <!-- ========================================
         Assets - å…±é€šUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
         ======================================== -->
    <script src="assets/ui-components.js"></script>

    <!-- ========================================
         Config
         ======================================== -->
    <script src="config.js"></script>

    <!-- ========================================
         System - åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ 
         ======================================== -->
    <script src="system/event-bus.js"></script>
    <script src="system/state-manager.js"></script>
    <script src="system/settings-manager.js"></script>
    <script src="system/history.js"></script>
    <script src="system/camera-system.js"></script>
    <script src="system/popup-manager.js"></script>

    <!-- ========================================
         Layers - Konvaãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†
         ======================================== -->
    <script src="layers/konva-layer-manager.js"></script>
    <script src="layers/layer-folder-system.js"></script>
    <script src="layers/thumbnail-generator.js"></script>

    <!-- ========================================
         Drawing - WebGL2ãƒ©ã‚¹ã‚¿ãƒ¼æç”»
         ======================================== -->
    <script src="drawing/raster-brush-engine.js"></script>
    <script src="drawing/pressure-handler.js"></script>
    <script src="drawing/pointer-handler.js"></script>
    <script src="drawing/brush-settings.js"></script>
    <script src="drawing/fill-tool.js"></script>

    <!-- ========================================
         Timeline - ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
         ======================================== -->
    <script src="timeline/frame-system.js"></script>
    <script src="timeline/animation-controller.js"></script>
    <script src="timeline/virtual-album.js"></script>

    <!-- ========================================
         Export - ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
         ======================================== -->
    <script src="export/export-manager.js"></script>
    <script src="export/clipboard-exporter.js"></script>
    <script src="export/apng-exporter.js"></script>
    <script src="export/png-exporter.js"></script>

    <!-- ========================================
         UI - ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
         ======================================== -->
    <script src="ui/layer-panel.js"></script>
    <script src="ui/timeline-panel.js"></script>
    <script src="ui/settings-popup.js"></script>
    <script src="ui/album-popup.js"></script>
    <script src="ui/keyboard-handler.js"></script>

    <!-- ========================================
         Core - åˆæœŸåŒ–ãƒ»ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—
         ======================================== -->
    <script src="core-runtime.js"></script>
    <script src="core-engine.js"></script>

    <script>
        window.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('ğŸš€ Tegaki Anime v2.0 èµ·å‹•ä¸­...');
                console.log('ğŸ“¦ Dependencies:', {
                    Konva: !!window.Konva,
                    PIXI: !!window.PIXI,
                    UPNG: !!window.UPNG,
                    gsap: !!window.gsap,
                    UIComponents: !!window.UIComponents
                });

                if (!window.Konva) {
                    throw new Error('Konva.js ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                if (!window.PIXI) {
                    throw new Error('PixiJS ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }
                if (!window.UIComponents) {
                    throw new Error('UIComponents ãŒèª­ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã›ã‚“');
                }

                // Core RuntimeåˆæœŸåŒ–
                if (window.CoreRuntime && window.CoreRuntime.initialize) {
                    await window.CoreRuntime.initialize();
                    console.log('âœ… Tegaki Anime v2.0 åˆæœŸåŒ–å®Œäº†');
                } else {
                    console.error('âŒ CoreRuntime.initialize ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
                }

            } catch (error) {
                console.error('âŒ åˆæœŸåŒ–å¤±æ•—:', error);
                alert('åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
            }
        });
    </script>
</body>
</html>