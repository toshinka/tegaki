{"version":3,"file":"lzw.mjs","sources":["../../../../node_modules/gifuct-js/lib/lzw.js"],"sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.lzw = void 0;\n\n/**\r\n * javascript port of java LZW decompression\r\n * Original java author url: https://gist.github.com/devunwired/4479231\r\n */\nvar lzw = function lzw(minCodeSize, data, pixelCount) {\n  var MAX_STACK_SIZE = 4096;\n  var nullCode = -1;\n  var npix = pixelCount;\n  var available, clear, code_mask, code_size, end_of_information, in_code, old_code, bits, code, i, datum, data_size, first, top, bi, pi;\n  var dstPixels = new Array(pixelCount);\n  var prefix = new Array(MAX_STACK_SIZE);\n  var suffix = new Array(MAX_STACK_SIZE);\n  var pixelStack = new Array(MAX_STACK_SIZE + 1); // Initialize GIF data stream decoder.\n\n  data_size = minCodeSize;\n  clear = 1 << data_size;\n  end_of_information = clear + 1;\n  available = clear + 2;\n  old_code = nullCode;\n  code_size = data_size + 1;\n  code_mask = (1 << code_size) - 1;\n\n  for (code = 0; code < clear; code++) {\n    prefix[code] = 0;\n    suffix[code] = code;\n  } // Decode GIF pixel stream.\n\n\n  var datum, bits, count, first, top, pi, bi;\n  datum = bits = count = first = top = pi = bi = 0;\n\n  for (i = 0; i < npix;) {\n    if (top === 0) {\n      if (bits < code_size) {\n        // get the next byte\n        datum += data[bi] << bits;\n        bits += 8;\n        bi++;\n        continue;\n      } // Get the next code.\n\n\n      code = datum & code_mask;\n      datum >>= code_size;\n      bits -= code_size; // Interpret the code\n\n      if (code > available || code == end_of_information) {\n        break;\n      }\n\n      if (code == clear) {\n        // Reset decoder.\n        code_size = data_size + 1;\n        code_mask = (1 << code_size) - 1;\n        available = clear + 2;\n        old_code = nullCode;\n        continue;\n      }\n\n      if (old_code == nullCode) {\n        pixelStack[top++] = suffix[code];\n        old_code = code;\n        first = code;\n        continue;\n      }\n\n      in_code = code;\n\n      if (code == available) {\n        pixelStack[top++] = first;\n        code = old_code;\n      }\n\n      while (code > clear) {\n        pixelStack[top++] = suffix[code];\n        code = prefix[code];\n      }\n\n      first = suffix[code] & 0xff;\n      pixelStack[top++] = first; // add a new string to the table, but only if space is available\n      // if not, just continue with current table until a clear code is found\n      // (deferred clear code implementation as per GIF spec)\n\n      if (available < MAX_STACK_SIZE) {\n        prefix[available] = old_code;\n        suffix[available] = first;\n        available++;\n\n        if ((available & code_mask) === 0 && available < MAX_STACK_SIZE) {\n          code_size++;\n          code_mask += available;\n        }\n      }\n\n      old_code = in_code;\n    } // Pop a pixel off the pixel stack.\n\n\n    top--;\n    dstPixels[pi++] = pixelStack[top];\n    i++;\n  }\n\n  for (i = pi; i < npix; i++) {\n    dstPixels[i] = 0; // clear missing pixels\n  }\n\n  return dstPixels;\n};\n\nexports.lzw = lzw;"],"names":["lzw_1"],"mappings":"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"}