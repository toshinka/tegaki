{"version":3,"file":"CheckBox.js","sources":["../src/CheckBox.ts"],"sourcesContent":["import { Text } from '@pixi/text';\nimport { Signal } from 'typed-signals';\nimport { Switcher } from './Switcher';\nimport { cleanup } from './utils/helpers/cleanup';\nimport { PixiText, PixiTextClass, PixiTextStyle } from './utils/helpers/text';\nimport { getView, type GetViewSettings } from './utils/helpers/view';\n\ntype CheckBoxStyle = {\n    checked: GetViewSettings;\n    unchecked: GetViewSettings;\n    text?: PixiTextStyle;\n    textOffset?: {\n        x?: number;\n        y?: number;\n    };\n};\n\nexport type CheckBoxOptions = {\n    style: CheckBoxStyle;\n    text?: string;\n    TextClass?: PixiTextClass;\n    checked?: boolean;\n};\n\n/**\n * Creates a container-based checkbox element.\n * @example\n *  new CheckBox({\n *     style: {\n *         unchecked: `switch_off.png`,\n *         checked: `switch_on.png`,\n *     }\n *  });\n */\nexport class CheckBox extends Switcher\n{\n    //* Text label */\n    label!: PixiText;\n\n    /** Signal emitted when checkbox state changes. */\n    onCheck: Signal<(state: boolean) => void>;\n\n    protected _style: CheckBoxStyle;\n    protected _textClass: PixiTextClass;\n\n    constructor(options: CheckBoxOptions)\n    {\n        super();\n\n        this._textClass = options.TextClass ?? Text;\n        this.text = options.text;\n\n        this.style = options.style;\n\n        this.checked = options.checked;\n\n        this.triggerEvents = ['onPress'];\n\n        this.innerView.cursor = 'pointer';\n\n        this.onCheck = new Signal();\n\n        this.onChange.connect(() => this.onCheck.emit(this.checked));\n    }\n\n    protected addLabel(text?: string, style?: PixiTextStyle)\n    {\n        if (!text) return;\n\n        this.label = new this._textClass(text ?? '', style ?? this._style?.text);\n        this.addChild(this.label);\n\n        this.label.cursor = 'pointer';\n        this.label.eventMode = 'static';\n        this.label.on('pointertap', () => (this.checked = !this.checked));\n    }\n\n    /** Setter, which sets a checkbox text. */\n    set text(text: string)\n    {\n        if (!text)\n        {\n            cleanup(this.label);\n\n            this.label = undefined;\n\n            return;\n        }\n\n        this.label ? (this.label.text = text) : this.addLabel(text);\n\n        this.alignLabel();\n    }\n\n    /** Getter, which returns a checkbox text. */\n    get text(): string | ''\n    {\n        return this.label?.text ?? '';\n    }\n\n    /** Setter, which sets a checkbox style settings. */\n    set style(style: CheckBoxStyle)\n    {\n        // Preserve checked state for the end of the method\n        const wasChecked = this.checked;\n\n        this._style = style;\n\n        const { unchecked, checked } = style;\n\n        const uncheckedView = getView(unchecked);\n        const checkedView = getView(checked);\n\n        this.views = [uncheckedView, checkedView];\n\n        if (wasChecked)\n        {\n            checkedView.visible = true;\n            this.active = 1;\n        }\n        else\n        {\n            uncheckedView.visible = true;\n        }\n\n        if (this.label)\n        {\n            if (style.text)\n            {\n                if ('style' in this.label)\n                {\n                    this.label.style = style.text;\n                }\n                else\n                {\n                    Object.assign(this.label, style.text);\n                }\n            }\n\n            this.alignLabel();\n        }\n    }\n\n    /** Getter, which returns a checkbox style settings. */\n    get style(): CheckBoxStyle\n    {\n        return this._style;\n    }\n\n    /**\n     * Aligns the label to the checkbox view.\n     * This method calculates the position of the label based on the checkbox view dimensions and applies the\n     * specified text offset.\n     * This method is called after the checkbox style is set or when the label text changes.\n     * It ensures that the label is positioned correctly relative to the checkbox view.\n     * @see {@link CheckBoxStyle.textOffset} for customizing the label position.\n     */\n    alignLabel()\n    {\n        if (!this.style) return;\n        if (!this.label) return;\n        if (!this.views) return;\n\n        const { unchecked } = this.style;\n        const uncheckedView = getView(unchecked);\n\n        if (uncheckedView)\n        {\n            this.label.x = uncheckedView.width + 10 + (this.style.textOffset?.x ?? 0);\n            this.label.y = ((uncheckedView.height - this.label.height) / 2) + (this.style.textOffset?.y ?? 0);\n        }\n    }\n\n    /** Getter, which returns a checkbox state. */\n    get checked(): boolean\n    {\n        return this.active === 1;\n    }\n\n    /** Setter, which sets a checkbox state. */\n    set checked(checked: boolean)\n    {\n        this.switch(checked ? 1 : 0);\n    }\n\n    /**\n     * Setter, that sets a checkbox state without emitting a signal.\n     * @param checked\n     */\n    forceCheck(checked: boolean)\n    {\n        this.forceSwitch(checked ? 1 : 0);\n    }\n}\n"],"names":["Switcher","Text","Signal","cleanup","getView"],"mappings":"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"}