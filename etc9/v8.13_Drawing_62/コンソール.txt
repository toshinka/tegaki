config.js:523 ✅ config.js (Phase 2完全版) loaded
config.js:524    - BRUSH_DEFAULTS追加完了
event-bus.js:143 ✅ system/event-bus.js Phase 2: 優先度機能追加版 loaded
coordinate-system.js:484 ✅ coordinate-system.js (worldToLocal修正版) loaded
coordinate-system.js:485    - 修正: worldToLocal() の pivot 計算順序を修正
coordinate-system.js:486    - Vキーモード時の NaN 問題を解決
coordinate-system.js:563 ✅ Debug commands: TegakiDebug.coord.*
data-models.js:276 ✅ data-models.js (マスクスプライト不可視版) loaded
batch-api.js:382 ✅ batch-api.js (Phase 6: History統合版) loaded
popup-manager.js:357 ✅ popup-manager.js (quick-access除外対応版) loaded
camera-system.js:704 ✅ camera-system.js (v2.0: リサイズ修正版) loaded
layer-transform.js:835 ✅ layer-transform.js (Phase 1-4完全改修版) loaded
layer-transform.js:836    ✓ Phase 1: イベント発火の修正 (layer:transform-updated 発火)
layer-transform.js:837    ✓ Phase 2: 座標系 NaN 対策 (isFinite チェック)
layer-transform.js:838    ✓ Phase 3: UI受信側の整備 (イベントペイロード最適化)
layer-transform.js:839    ✓ Phase 4: ショートカット整合性 (反転機能修復)
layer-system.js:1247 ✅ layer-system.js (v2.0.1: 反転機能修復版) loaded
drawing-clipboard.js:603 ✅ drawing-clipboard.js Phase4改修版+確定イベント loaded
drawing-clipboard.js:604    - ✅ CTRL+V behavior: overwrite active layer
drawing-clipboard.js:605    - ✅ Commit events: paste:commit, operation:commit
drawing-clipboard.js:606    - ✅ Thumbnail auto-update on paste
history.js:217 ✅ history.js (Phase 3: Redo null参照修正版) loaded
animation-system.js:1459 ✅ animation-system.js (Phase 1改修版・フレーム名統一: xF形式) loaded
pressure-handler.js:183 ✅ pressure-handler.js (Phase 3: 距離ベースフィルタ追加版) loaded
pressure-handler.js:184    - applyDistanceFilter() 追加
pressure-handler.js:185    - 短距離: alpha=0.9 (即座反映)
pressure-handler.js:186    - 長距離: alpha=0.3 (スムージング強)
curve-interpolator.js:205 ✅ curve-interpolator.js (Phase 3) loaded
curve-interpolator.js:206    - Catmull-Rom スプライン補間
curve-interpolator.js:207    - 適応的サンプリング対応
curve-interpolator.js:208    - tiltX/Y/twist データ補間対応
stroke-renderer.js:247 ✅ system/drawing/stroke-renderer.js loaded (PixiJS v8完全対応版)
thumbnail-system.js:531 ✅ system/drawing/thumbnail-system.js (Phase 1-2完全版) loaded
thumbnail-system.js:532    - Phase 1: イベントフロー確立 (layer:transform-updated → thumbnail:layer-updated)
thumbnail-system.js:533    - Phase 2: throttle 実装 (100ms間隔)
thumbnail-system.js:534    - Phase 5: デバッグコマンド追加
thumbnail-system.js:535    - Debug: window.TegakiDebug.monitorThumbnails()
thumbnail-system.js:536    - Debug: window.TegakiDebug.inspectThumbnailCache()
thumbnail-system.js:537    - Debug: window.TegakiDebug.regenerateAllThumbnails()
brush-settings.js:183 ✅ brush-settings.js (API統一版) loaded
brush-settings.js:184    - ✅ getOpacity() / setOpacity() 追加
brush-settings.js:185    - ✅ brush:opacity-changed イベント購読追加
drawing-engine.js:376 ✅ drawing-engine.js (座標系完全修正版) loaded
drawing-engine.js:459 ✅ Debug commands: TegakiDebug.drawing.*
quick-export-ui.js:292 ✅ quick-export-ui.js (無効化版) loaded
export-manager.js:224 ✅ export-manager.js (CUT→FRAME完全修正版) loaded
png-exporter.js:85 ✅ png-exporter.js (単一フレーム専用・プレビュー対応) loaded
apng-exporter.js:236 ✅ apng-exporter.js (CUT→FRAME完全修正版) loaded
gif-exporter.js:300 ✅ gif-exporter.js (CUT→FRAME完全修正版) loaded
webp-exporter.js:289 ✅ webp-exporter.js (静止画・動画自動判定対応版) loaded
mp4-exporter.js:30 ✅ mp4-exporter.js (Phase 8完成版) loaded
pdf-exporter.js:225 ✅ pdf-exporter.js (CUT→FRAME完全対応版) loaded
dom-builder.js:494 ✅ dom-builder.js (ID重複解消版) loaded
dom-builder.js:495    - #pen-settings → #legacy-pen-settings に変更
dom-builder.js:496    - pen-size-slider → legacy-pen-size-slider に変更
dom-builder.js:497    - quick-access-popup.jsとのID競合を完全解消
slider-utils.js:197 ✅ ui/slider-utils.js loaded
slider-utils.js:198    - 責務: スライダーUIの統一実装
slider-utils.js:199    - DRY原則: settings-popup.js と ui-panels.js で共有
slider-utils.js:200    - API: createSlider() / createSimpleSlider()
keyboard-handler.js:318 ✅ keyboard-handler.js (P/Eサイドバー同期版) loaded
resize-popup.js:452 ✅ resize-popup.js (Phase 4完了: ロジック削減版) loaded
layer-panel-renderer.js:324 ✅ ui/layer-panel-renderer.js (data-layer-index追加版) loaded
status-display-renderer.js:138 ✅ status-display-renderer.js (Phase 1改修版) loaded
timeline-thumbnail-utils.js:185 ✅ ui/timeline-thumbnail-utils.js (Phase 1完全版) loaded
timeline-thumbnail-utils.js:186    - Phase 1: layer:transform-updated 購読追加
timeline-thumbnail-utils.js:187    - タイムラインサムネイルがレイヤー変形に追従
timeline-ui.js:981 ✅ timeline-ui.js (Phase 4完了: レイヤー変形連携版) loaded
album-popup.js:473 ✅ album-popup.js (FRAME改修版) loaded
settings-popup.js:583 ✅ settings-popup.js (即応性完全修正版) loaded
settings-popup.js:584    - CSS transition完全除去（!important付き）
settings-popup.js:585    - DOM更新を同期的に即座実行
settings-popup.js:586    - quick-access/resize-popupと完全同等の動作
quick-access-popup.js:538 ✅ quick-access-popup.js (背景ドラッグ + 閉じるボタン版) loaded
quick-access-popup.js:539    - 背景ドラッグで移動可能（スライダー/ボタン以外）
quick-access-popup.js:540    - 右上×ボタンで閉じる
quick-access-popup.js:541    - 画面外クリックで閉じない（常時開きっぱなし可能）
export-popup.js:423 ✅ export-popup.js (frameInfo修正版＋PDF有効化) loaded
ui-panels.js:408 ✅ ui-panels.js (サイドバー同期・色調整版) loaded
core-runtime.js:713 ✅ core-runtime.js (Phase 1-3完全版: ThumbnailSystem統合) loaded
core-engine.js:724 ✅ core-engine.js (Phase2完全修正版) loaded
core-initializer.js:347 ✅ core-initializer.js (完全修正版・SettingsManager＋ExportPopup対応) loaded
drawing-clipboard.js:19 DrawingClipboard: Initializing...
drawing-clipboard.js:26 ✅ DrawingClipboard initialized (Phase4改修版 + 確定イベント)
thumbnail-system.js:48 ✅ ThumbnailSystem initialized (Phase 1-2)
core-initializer.js:63 ✅ SettingsManager initialized
popup-manager.js:16 ✅ PopupManager initialized
popup-manager.js:42 📋 Popup "settings" registered (priority: 1)
popup-manager.js:42 📋 Popup "quickAccess" registered (priority: 2)
popup-manager.js:42 📋 Popup "album" registered (priority: 3)
popup-manager.js:42 📋 Popup "resize" registered (priority: 4)
popup-manager.js:102 🔧 Initializing all popups...
popup-manager.js:87 ✅ Popup "settings" initialized successfully
popup-manager.js:87 ✅ Popup "quickAccess" initialized successfully
popup-manager.js:87 ✅ Popup "album" initialized successfully
popup-manager.js:87 ✅ Popup "resize" initialized successfully
popup-manager.js:118 📊 Popup initialization: 4 ready, 0 deferred
popup-manager.js:42 📋 Popup "export" registered (priority: 5)
popup-manager.js:87 ✅ Popup "export" initialized successfully
core-initializer.js:245 ✅ ExportPopup registered and initialized
// DevTools コンソールで実行してください
console.log('=== Debug Info ===');
console.log('CoordinateSystem:', window.CoordinateSystem);
console.log('worldContainer:', window.CoordinateSystem?._getWorldContainer?.());
console.log('cameraSystem:', window.cameraSystem);
console.log('LayerTransform.coordinateSystem:', window.TegakiLayerTransform?.prototype?.coordinateSystem);

// Vキー押してドラッグ時に実行
const world = window.CoordinateSystem.screenClientToWorld(100, 100);
console.log('screenClientToWorld test:', world);
VM189:2 === Debug Info ===
VM189:3 CoordinateSystem: CoordinateSystem {app: ju, config: null, eventBus: null, cameraSystem: CameraSystem, worldContainer: Z, …}
VM189:4 worldContainer: Z {_events: i, _eventsCount: 0, uid: 2, _updateFlags: 0, renderGroup: null, …}
VM189:5 cameraSystem: CameraSystem {app: {…}, config: {…}, eventBus: EventBus, coordinateSystem: CoordinateSystem, isDragging: false, …}
VM189:6 LayerTransform.coordinateSystem: undefined
VM189:10 screenClientToWorld test: {worldX: -178, worldY: -130.5}
undefined
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 180.5, worldY: 91.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 180.5, worldY: 91}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 180, worldY: 91}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 179.5, worldY: 91}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 179, worldY: 91}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 179, worldY: 90.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 109.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 109}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 108.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 108}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 107}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 106.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 200, worldY: 105.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 104.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 103.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 102.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 101}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 100}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 99}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199.5, worldY: 97.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199, worldY: 97.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199, worldY: 96.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199, worldY: 96}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199, worldY: 95.5}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
layer-transform.js:452 [LayerTransform] screenClientToWorld returned non-finite values {worldX: 199, worldY: 95}
_handleDrag @ layer-transform.js:452
(anonymous) @ layer-transform.js:433
