================================================================================
ãƒ–ãƒ©ã‚¦ã‚¶ãŠçµµã‹ããƒ„ãƒ¼ãƒ« v8.13 - ãƒ•ãƒ­ãƒ¼ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚·ãƒ³ãƒœãƒ«ç´¢å¼•è¾å…¸
================================================================================

ã€å‡¡ä¾‹ã€‘
âœ… = æ­£å¸¸å‹•ä½œç¢ºèªæ¸ˆã¿
âš ï¸ = å•é¡Œç®‡æ‰€ãƒ»å®Ÿè£…ä¸å®Œå…¨
ğŸ”§ = æ”¹ä¿®å¿…è¦
âŒ = æœªå®Ÿè£…ãƒ»æ©Ÿèƒ½ä¸å…¨
ğŸ” = è¦èª¿æŸ»
ğŸ“ = è¦ªãƒ•ã‚¡ã‚¤ãƒ«
ğŸ“„ = å­ãƒ•ã‚¡ã‚¤ãƒ«
ğŸ”€ = ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼é–¢é€£

================================================================================
ã€1ã€‘ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå®šç¾©ä¸€è¦§è¡¨
================================================================================

ã€ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆã€‘
âœ… P                : ãƒšãƒ³ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆ
âœ… E                : æ¶ˆã—ã‚´ãƒ ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆ
âœ… V                : ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰ãƒˆã‚°ãƒ«

ã€Undo/Redoã€‘
âœ… Ctrl+Z          : å…ƒã«æˆ»ã™
âœ… Ctrl+Y          : ã‚„ã‚Šç›´ã—
âœ… Ctrl+Shift+Z    : ã‚„ã‚Šç›´ã—ï¼ˆä»£æ›¿ï¼‰

ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ - åŸºæœ¬ã€‘
âœ… Ctrl+L          : ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ 
âœ… Delete          : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®çµµã‚’å‰Šé™¤
âœ… Backspace       : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®çµµã‚’å‰Šé™¤ï¼ˆåŒä¸Šï¼‰
âš ï¸ Ctrl+Delete     : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¯ãƒªã‚¢ï¼ˆç™»éŒ²ã‚ã‚Šãƒ»å®Ÿè£…çµŒè·¯ä¸æ˜ç¢ºï¼‰
âœ… Ctrl+C          : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚³ãƒ”ãƒ¼
âœ… Ctrl+V          : ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒšãƒ¼ã‚¹ãƒˆ

ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ - ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ï¼ˆVã‚­ãƒ¼æŠ¼ä¸‹æ™‚ï¼‰ã€‘
âœ… V + â†‘           : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä¸Šã«ç§»å‹•
âœ… V + â†“           : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’ä¸‹ã«ç§»å‹•
âœ… V + â†           : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å·¦ã«ç§»å‹•
âœ… V + â†’           : ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’å³ã«ç§»å‹•
âœ… V + Shift + â†‘   : ãƒ¬ã‚¤ãƒ¤ãƒ¼æ‹¡å¤§
âœ… V + Shift + â†“   : ãƒ¬ã‚¤ãƒ¤ãƒ¼ç¸®å°
âœ… V + Shift + â†   : ãƒ¬ã‚¤ãƒ¤ãƒ¼å·¦å›è»¢
âœ… V + Shift + â†’   : ãƒ¬ã‚¤ãƒ¤ãƒ¼å³å›è»¢
âœ… V + H           : ãƒ¬ã‚¤ãƒ¤ãƒ¼æ°´å¹³åè»¢
âœ… V + Shift + H   : ãƒ¬ã‚¤ãƒ¤ãƒ¼å‚ç›´åè»¢
âœ… V + Ctrl + 0    : ãƒ¬ã‚¤ãƒ¤ãƒ¼ä½ç½®ãƒ»ã‚µã‚¤ã‚ºãƒªã‚»ãƒƒãƒˆ

ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ - éšå±¤ã€‘
âœ… â†‘               : ãƒ¬ã‚¤ãƒ¤ãƒ¼é¸æŠã‚’ä¸Šã¸ï¼ˆvMode=falseï¼‰
âœ… â†“               : ãƒ¬ã‚¤ãƒ¤ãƒ¼é¸æŠã‚’ä¸‹ã¸ï¼ˆvMode=falseï¼‰
âœ… Ctrl + â†‘        : ãƒ¬ã‚¤ãƒ¤ãƒ¼é †åºã‚’ä¸Šã’ã‚‹
âœ… Ctrl + â†“        : ãƒ¬ã‚¤ãƒ¤ãƒ¼é †åºã‚’ä¸‹ã’ã‚‹

ã€ã‚«ãƒ¡ãƒ©æ“ä½œã€‘
âœ… H               : ã‚­ãƒ£ãƒ³ãƒã‚¹æ°´å¹³åè»¢ï¼ˆvMode=falseï¼‰
âœ… Shift + H       : ã‚­ãƒ£ãƒ³ãƒã‚¹å‚ç›´åè»¢ï¼ˆvMode=falseï¼‰
âœ… Ctrl + 0        : ã‚«ãƒ¡ãƒ©ãƒªã‚»ãƒƒãƒˆï¼ˆvMode=falseï¼‰

ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³/GIFã€‘
âœ… Ctrl + â†        : å‰ã®ãƒ•ãƒ¬ãƒ¼ãƒ 
âœ… Ctrl + â†’        : æ¬¡ã®ãƒ•ãƒ¬ãƒ¼ãƒ 
âœ… Ctrl + Space    : å†ç”Ÿ/åœæ­¢
âœ… Shift + A       : ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³è¡¨ç¤ºåˆ‡æ›¿
âœ… Shift + N       : æ–°è¦ãƒ•ãƒ¬ãƒ¼ãƒ ä½œæˆ
âœ… Shift + C       : ãƒ•ãƒ¬ãƒ¼ãƒ ã‚³ãƒ”ãƒ¼

ã€UI/è¨­å®šã€‘
âœ… Ctrl + ,        : è¨­å®šã‚’é–‹ã
âœ… Ctrl + E        : ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
âœ… Q               : ã‚¯ã‚¤ãƒƒã‚¯ã‚¢ã‚¯ã‚»ã‚¹

ã€ãƒã‚¦ã‚¹/ãƒ‰ãƒ©ãƒƒã‚°æ“ä½œã€‘
âœ… Space + ãƒ‰ãƒ©ãƒƒã‚°        : ã‚­ãƒ£ãƒ³ãƒã‚¹ç§»å‹•
âœ… Space + Shift + ãƒ‰ãƒ©ãƒƒã‚° : ã‚«ãƒ¡ãƒ©æ‹¡ç¸®ãƒ»å›è»¢
âœ… å³ã‚¯ãƒªãƒƒã‚¯ + ãƒ‰ãƒ©ãƒƒã‚°    : ã‚­ãƒ£ãƒ³ãƒã‚¹ç§»å‹•
âœ… Shift + å³ã‚¯ãƒªãƒƒã‚¯ + ãƒ‰ãƒ©ãƒƒã‚° : ã‚«ãƒ¡ãƒ©æ‹¡ç¸®ãƒ»å›è»¢
âœ… ãƒ›ã‚¤ãƒ¼ãƒ«                : ã‚ºãƒ¼ãƒ 
âœ… Space + ãƒ›ã‚¤ãƒ¼ãƒ«        : ã‚ºãƒ¼ãƒ 
âœ… Space + Shift + ãƒ›ã‚¤ãƒ¼ãƒ« : å›è»¢

================================================================================
ã€2ã€‘ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå®Ÿè£…çŠ¶æ³ã®è©³ç´°æ¤œè¨¼
================================================================================

ã€2-1ã€‘âœ… å®Ÿè£…å®Œäº†ãƒ»æ­£å¸¸å‹•ä½œç¢ºèªæ¸ˆã¿

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… BS/DELã‚­ãƒ¼ã§ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®æç”»å‰Šé™¤ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ config.js                             â”‚
â”‚   - TEGAKI_KEYMAP.actions.LAYER_DELETE_DRAWINGS â”‚
â”‚   - [Delete], [Backspace]              â”‚
â”‚ ğŸ“„ keyboard-handler.js                  â”‚
â”‚   - handleAction('LAYER_DELETE_DRAWINGS') â”‚
â”‚   - deleteActiveLayerDrawings()         â”‚
â”‚   - clearLayerDrawings()                â”‚
â”‚   - restoreLayerDrawings()              â”‚
â”‚ ğŸ“„ layer-system.js                      â”‚
â”‚   - layerData.pathsé…åˆ—ã‚’ã‚¯ãƒªã‚¢          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… åè»¢ãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯ã§æ­£å¸¸ã«åè»¢        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ layer-transform.js                   â”‚
â”‚   - onFlipRequest(direction)            â”‚
â”‚ ğŸ“„ layer-system.js                      â”‚
â”‚   - flipActiveLayer(direction, bypassVKeyCheck) â”‚
â”‚   - transform.flipLayer(layer, direction, skipHistory=true) â”‚
â”‚   - Historyç™»éŒ²ã¯ä¸€åº¦ã®ã¿ï¼ˆv8.13.8ã§ä¿®æ­£ï¼‰ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Vã‚­ãƒ¼ã«ã‚ˆã‚‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ã®ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ— â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ keyboard-handler.js                  â”‚
â”‚   - vKeyPressed ãƒˆã‚°ãƒ«å¤‰æ•°ç®¡ç†           â”‚
â”‚   - TegakiEventBus.emit('keyboard:vkey-pressed') â”‚
â”‚ ğŸ“„ layer-system.js                      â”‚
â”‚   - _setupVKeyEvents()                  â”‚
â”‚   - transform.enterMoveMode()           â”‚
â”‚   - transform.exitMoveMode()            â”‚
â”‚ ğŸ“„ layer-transform.js                   â”‚
â”‚   - isVKeyPressed ãƒ•ãƒ©ã‚°ç®¡ç†             â”‚
â”‚   - ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ãƒ‘ãƒãƒ«è¡¨ç¤ºåˆ¶å¾¡       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… Vã‚­ãƒ¼+H/Shift+Hã§ãƒ¬ã‚¤ãƒ¤ãƒ¼åè»¢         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ config.js                             â”‚
â”‚   - LAYER_FLIP_HORIZONTAL (V + H)       â”‚
â”‚   - LAYER_FLIP_VERTICAL (V + Shift + H) â”‚
â”‚ ğŸ“„ keyboard-handler.js                  â”‚
â”‚   - handleAction() ã§ vModeåˆ¤å®š          â”‚
â”‚   - eventBus.emit('layer:flip-by-key')  â”‚
â”‚ ğŸ“„ layer-system.js                      â”‚
â”‚   - _setupLayerOperations()             â”‚
â”‚   - flipActiveLayer(direction, false)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… H/Shift+Hã§ã‚«ãƒ¡ãƒ©åè»¢                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ config.js                             â”‚
â”‚   - CAMERA_FLIP_HORIZONTAL (H)          â”‚
â”‚   - CAMERA_FLIP_VERTICAL (Shift + H)    â”‚
â”‚ ğŸ“„ keyboard-handler.js                  â”‚
â”‚   - handleAction('CAMERA_FLIP_HORIZONTAL') â”‚
â”‚   - eventBus.emit('camera:flip-horizontal') â”‚
â”‚ ğŸ“„ camera-system.js                     â”‚
â”‚   - _handleCameraFlipKeys()             â”‚
â”‚   - worldContainer.scaleåè»¢             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… CTRL+Zã§åè»¢ã®ã‚¢ãƒ³ãƒ‰ã‚¥                â”‚
â”‚ âœ… CTRL+Yã§åè»¢ã®ãƒªãƒ‰ã‚¥                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ history.js                           â”‚
â”‚   - undo(), redo() ãƒ¡ã‚½ãƒƒãƒ‰              â”‚
â”‚   - _manager.isApplying ãƒ•ãƒ©ã‚°ã§äºŒé‡ç™»éŒ²é˜²æ­¢ â”‚
â”‚ ğŸ“„ layer-system.js                      â”‚
â”‚   - flipActiveLayer() å†…ã§History.push()  â”‚
â”‚   - entry: { name, do, undo, meta }     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âœ… åè»¢ãƒœã‚¿ãƒ³ã®activeçŠ¶æ…‹ãŒæ­£ã—ãè¡¨ç¤º     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“„ layer-transform.js                   â”‚
â”‚   - updateFlipButtons()                 â”‚
â”‚   - scaleX/scaleYã®ç¬¦å·åˆ¤å®š              â”‚
â”‚   - .active ã‚¯ãƒ©ã‚¹ä»˜ä¸                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€2-2ã€‘âš ï¸ å•é¡Œç®‡æ‰€ãƒ»è¦èª¿æŸ»

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ LAYER_CLEAR (Ctrl+Delete)            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ config.js                             â”‚
â”‚   - LAYER_CLEARå®šç¾©ã‚ã‚Š                  â”‚
â”‚ ğŸ“„ keyboard-handler.js                  â”‚
â”‚   - handleAction('LAYER_CLEAR')         â”‚
â”‚   - eventBus.emit('layer:clear-active') â”‚
â”‚ ğŸ” å•é¡Œï¼šlayer:clear-activeã®ãƒªã‚¹ãƒŠãƒ¼ãŒ  â”‚
â”‚    ã©ã“ã«ã‚‚è¦‹å½“ãŸã‚‰ãªã„                  â”‚
â”‚ ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š                            â”‚
â”‚    1) layer-system.jsã«ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ       â”‚
â”‚    2) ä¸è¦ãªã‚‰config.jsã‹ã‚‰å‰Šé™¤          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€2-3ã€‘ğŸ” å¤šé‡å®Ÿè£…ã®ç–‘ã„ãƒ»è¦ç¢ºèª

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” Vã‚­ãƒ¼çŠ¶æ…‹ç®¡ç†ã®å¤šé‡ç®‡æ‰€               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ keyboard-handler.js                     â”‚
â”‚   - vKeyPressed å¤‰æ•°                     â”‚
â”‚ layer-system.js                         â”‚
â”‚   - vKeyPressed getter (transformçµŒç”±)   â”‚
â”‚ layer-transform.js                      â”‚
â”‚   - isVKeyPressed ãƒ•ãƒ©ã‚°                 â”‚
â”‚ camera-system.js                        â”‚
â”‚   - vKeyPressed å¤‰æ•°                     â”‚
â”‚ ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š                            â”‚
â”‚    keyboard-handler.jsã‚’å”¯ä¸€ã®çœŸå®Ÿã®æº   â”‚
â”‚    ä»–ã¯å…¨ã¦EventBusçµŒç”±ã§åŒæœŸ            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” åº§æ¨™å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰ã®é‡è¤‡                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ coordinate-system.js                    â”‚
â”‚   - screenClientToCanvas()              â”‚
â”‚   - canvasToWorld()                     â”‚
â”‚   - worldToLocal()                      â”‚
â”‚ camera-system.js                        â”‚
â”‚   - screenClientToWorld()               â”‚
â”‚   - worldToScreen()                     â”‚
â”‚   - screenToLayer()                     â”‚
â”‚   - screenToCanvas()                    â”‚
â”‚ ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š                            â”‚
â”‚    camera-systemå†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’            â”‚
â”‚    coordinate-system.jså‘¼ã³å‡ºã—ã«çµ±ä¸€    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
ã€3ã€‘ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼å…¨ä½“å›³
================================================================================

ã€3-1ã€‘ãƒ¬ã‚¤ãƒ¤ãƒ¼åè»¢ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›: V + H
    â†“
keyboard-handler.js
    â†“ handleKeyDown()
    â†“ getAction(e, {vMode: vKeyPressed})
    â†“ â†’ 'LAYER_FLIP_HORIZONTAL'
    â†“
    â†“ handleAction('LAYER_FLIP_HORIZONTAL')
    â†“ if (isVKeyPressed())
    â†“ eventBus.emit('layer:flip-by-key', {direction: 'horizontal'})
    â†“
layer-system.js
    â†“ _setupLayerOperations()
    â†“ eventBus.on('layer:flip-by-key')
    â†“ flipActiveLayer(direction, false)
    â†“
    â†“ if (!bypassVKeyCheck && !isLayerMoveMode) return
    â†“ transform.flipLayer(activeLayer, direction, skipHistory=true)
    â†“
layer-transform.js
    â†“ flipLayer(layer, direction, skipHistory)
    â†“ vectorOperations.flipPathPoints()
    â†“ if (!skipHistory) confirmTransform() â† ã‚¹ã‚­ãƒƒãƒ—ã•ã‚Œã‚‹
    â†“
layer-system.js
    â†“ History.push({ name: 'layer-flip-horizontal', do, undo })
    â†“ requestThumbnailUpdate()
    â†“ eventBus.emit('layer:transform-updated')

ã€3-2ã€‘ã‚«ãƒ¡ãƒ©åè»¢ã®ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›: H (vMode=false)
    â†“
keyboard-handler.js
    â†“ handleKeyDown()
    â†“ getAction(e, {vMode: false})
    â†“ â†’ 'CAMERA_FLIP_HORIZONTAL'
    â†“
    â†“ handleAction('CAMERA_FLIP_HORIZONTAL')
    â†“ eventBus.emit('camera:flip-horizontal')
    â†“
camera-system.js
    â†“ _handleCameraFlipKeys() â† å®Ÿéš›ã¯keydownã‚¤ãƒ™ãƒ³ãƒˆç›´æ¥
    â†“ horizontalFlipped = !horizontalFlipped
    â†“ worldContainer.scale.x *= -1
    â†“ _emitTransformChanged()

ğŸ” æ³¨æ„ï¼šcamera-system.jsã¯'camera:flip-horizontal'ã‚¤ãƒ™ãƒ³ãƒˆã‚’
ãƒªãƒƒã‚¹ãƒ³ã—ã¦ã„ãªã„ã€‚keyboardå†…ã§ç›´æ¥ç™ºç«ã—ã¦ã„ã‚‹ãŒã€
å®Ÿéš›ã®å‡¦ç†ã¯camera-systemå†…ã®_handleCameraFlipKeys()ã§
ç‹¬ç«‹ã—ã¦è¡Œã‚ã‚Œã¦ã„ã‚‹ã€‚

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼šEventBusçµŒç”±ã®çµ±ä¸€åŒ–

ã€3-3ã€‘BS/DELã‚­ãƒ¼ã§ã®æç”»å‰Šé™¤ãƒ•ãƒ­ãƒ¼

ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›: Delete or Backspace
    â†“
keyboard-handler.js
    â†“ handleKeyDown()
    â†“ getAction(e) â†’ 'LAYER_DELETE_DRAWINGS'
    â†“
    â†“ handleAction('LAYER_DELETE_DRAWINGS')
    â†“ deleteActiveLayerDrawings()
    â†“
    â†“ layerSystem.getActiveLayer()
    â†“ if (isBackground) return
    â†“ pathsBackup = structuredClone(paths)
    â†“
    â†“ History.push({
    â†“   do: clearLayerDrawings(),
    â†“   undo: restoreLayerDrawings(pathsBackup)
    â†“ })
    â†“
    â†“ clearLayerDrawings()
    â†“   - layer.layerData.paths = []
    â†“   - child.destroy()
    â†“   - eventBus.emit('layer:drawings-deleted')
    â†“   - requestThumbnailUpdate()

================================================================================
ã€4ã€‘ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆç´¢å¼•
================================================================================

ã€4-1ã€‘è¨­å®šãƒ»å®šç¾©ç³»

window.TEGAKI_CONFIG
    ğŸ“ config.js
    - canvas: {width, height}
    - pen: {size, opacity, color, pressure}
    - webgpu: {enabled, sdf, msdf}
    - camera: {minScale, maxScale, ...}
    - layer: {minX, maxX, minScale, ...}
    - background: {color}
    - history: {maxSize, autoSaveInterval}
    - thumbnail: {SIZE, RENDER_SCALE}
    - animation: {defaultFPS, ...}

window.TEGAKI_KEYMAP
    ğŸ“ config.js
    - actions: {Object}
    - getAction(event, context)
    - getKeyDisplayName(keyCode)
    - getShortcutList()

window.TEGAKI_KEYCONFIG
    ğŸ“ config.js
    âš ï¸ æ—§å¼å®šç¾©ãƒ»TEGAKI_KEYMAPã¨é‡è¤‡
    ğŸ”§ å‰Šé™¤æ¨å¥¨

window.TEGAKI_COLORS
    ğŸ“ config.js
    - futabaè‰²ãƒ‘ãƒ¬ãƒƒãƒˆå®šç¾©

ã€4-2ã€‘ã‚·ã‚¹ãƒ†ãƒ ç³»

window.TegakiEventBus
    ğŸ“ event-bus.js
    - on(event, callback, priority)
    - off(event, callback)
    - emit(event, data)
    - once(event, callback, priority)
    - EVENTS: {å®šæ•°å®šç¾©}

window.CoordinateSystem
    ğŸ“ coordinate-system.js
    - screenClientToCanvas()
    - canvasToWorld()
    - worldToLocal()
    âš ï¸ window.TEGAKI_COORDINATE_SYSTEMã¨ã®é‡è¤‡ã‚ã‚Š

window.cameraSystem
    ğŸ“ camera-system.js (TegakiCameraSystem)
    - worldContainer, canvasContainer
    - resetCanvas()
    - resizeCanvas()
    - setZoom(), pan()
    - screenToLayer(), screenToCanvas()

window.layerManager
    ğŸ“ layer-system.js (TegakiLayerSystem)
    - currentFrameContainer
    - activeLayerIndex
    - transform (TegakiLayerTransform)
    - getLayers(), getActiveLayer()
    - createLayer(), deleteLayer()
    - setActiveLayer()
    - flipActiveLayer()
    - addPathToActiveLayer()

window.History
    ğŸ“ history.js
    - push(entry)
    - undo(), redo()
    - canUndo(), canRedo()
    - _manager.isApplying

ã€4-3ã€‘æç”»ç³»

window.drawingEngine
    ğŸ“ drawing-engine.js
    - startStroke(), addStrokePoint(), endStroke()
    - pointerHandler, pressureHandler
    - strokeRecorder, strokeRenderer

window.brushSettings
    ğŸ“ brush-settings.js
    - getColor(), setColor()
    - getSize(), setSize()
    - getOpacity(), setOpacity()

window.brushCore
    ğŸ“ brush-core.js
    - currentTool ('pen' or 'eraser')
    - setTool(tool)
    - getTool()

ã€4-4ã€‘UIç³»

window.KeyboardHandler
    ğŸ“ keyboard-handler.js
    - init()
    - isVKeyPressed()
    - setVKeyPressed(state)
    - deleteActiveLayerDrawings()

window.timelineUI
    ğŸ“ timeline-ui.js
    - isVisible
    - goToPreviousCutSafe()
    - goToNextCutSafe()
    - togglePlayStop()

window.animationSystem
    ğŸ“ animation-system.js
    - createNewEmptyFrame()
    - getCurrentFrameIndex()
    - generateFrameThumbnail()

================================================================================
ã€5ã€‘ãƒ¡ã‚½ãƒƒãƒ‰è²¬å‹™ãƒãƒˆãƒªã‚¯ã‚¹
================================================================================

ã€5-1ã€‘åº§æ¨™å¤‰æ›

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¡ã‚½ãƒƒãƒ‰             â”‚ è²¬å‹™ãƒ•ã‚¡ã‚¤ãƒ«        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ screenClientToCanvas â”‚ coordinate-system.jsâ”‚
â”‚ canvasToWorld        â”‚ coordinate-system.jsâ”‚
â”‚ worldToLocal         â”‚ coordinate-system.jsâ”‚
â”‚ screenClientToWorld  â”‚ camera-system.js âš ï¸ â”‚
â”‚ worldToScreen        â”‚ camera-system.js âš ï¸ â”‚
â”‚ screenToLayer        â”‚ camera-system.js âš ï¸ â”‚
â”‚ screenToCanvas       â”‚ camera-system.js âš ï¸ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼šcamera-systemå†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’
   coordinate-system.jså‘¼ã³å‡ºã—ã«çµ±ä¸€

ã€5-2ã€‘ãƒ¬ã‚¤ãƒ¤ãƒ¼æ“ä½œ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¡ã‚½ãƒƒãƒ‰             â”‚ è²¬å‹™ãƒ•ã‚¡ã‚¤ãƒ«        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ createLayer          â”‚ layer-system.js     â”‚
â”‚ deleteLayer          â”‚ layer-system.js     â”‚
â”‚ setActiveLayer       â”‚ layer-system.js     â”‚
â”‚ flipActiveLayer      â”‚ layer-system.js     â”‚
â”‚ moveActiveLayer      â”‚ layer-system.js     â”‚
â”‚ transformActiveLayer â”‚ layer-system.js     â”‚
â”‚ reorderLayers        â”‚ layer-system.js     â”‚
â”‚ addPathToActiveLayer â”‚ layer-system.js     â”‚
â”‚ rebuildPathGraphics  â”‚ layer-system.js     â”‚
â”‚ safeRebuildLayer     â”‚ layer-system.js     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€5-3ã€‘ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ 

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¡ã‚½ãƒƒãƒ‰             â”‚ è²¬å‹™ãƒ•ã‚¡ã‚¤ãƒ«        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ flipLayer            â”‚ layer-transform.js  â”‚
â”‚ moveLayer            â”‚ layer-transform.js  â”‚
â”‚ scaleLayer           â”‚ layer-transform.js  â”‚
â”‚ rotateLayer          â”‚ layer-transform.js  â”‚
â”‚ confirmTransform     â”‚ layer-transform.js  â”‚
â”‚ enterMoveMode        â”‚ layer-transform.js  â”‚
â”‚ exitMoveMode         â”‚ layer-transform.js  â”‚
â”‚ updateTransform      â”‚ layer-transform.js  â”‚
â”‚ applyTransform       â”‚ layer-transform.js  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€5-4ã€‘ã‚«ãƒ¡ãƒ©æ“ä½œ

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¡ã‚½ãƒƒãƒ‰             â”‚ è²¬å‹™ãƒ•ã‚¡ã‚¤ãƒ«        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ resetCanvas          â”‚ camera-system.js    â”‚
â”‚ resizeCanvas         â”‚ camera-system.js    â”‚
â”‚ setZoom              â”‚ camera-system.js    â”‚
â”‚ pan                  â”‚ camera-system.js    â”‚
â”‚ _handleWheelZoom     â”‚ camera-system.js    â”‚
â”‚ _handleWheelRotation â”‚ camera-system.js    â”‚
â”‚ _handleCameraFlipKeysâ”‚ camera-system.js    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ã€5-5ã€‘Historyç®¡ç†

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ãƒ¡ã‚½ãƒƒãƒ‰             â”‚ è²¬å‹™ãƒ•ã‚¡ã‚¤ãƒ«        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ push                 â”‚ history.js          â”‚
â”‚ undo                 â”‚ history.js          â”‚
â”‚ redo                 â”‚ history.js          â”‚
â”‚ canUndo              â”‚ history.js          â”‚
â”‚ canRedo              â”‚ history.js          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

================================================================================
ã€6ã€‘ã‚¤ãƒ™ãƒ³ãƒˆåä¸€è¦§
================================================================================

ã€6-1ã€‘ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰é–¢é€£

keyboard:vkey-pressed
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupVKeyEvents()
    ğŸ“¥ camera-system.js â†’ setVKeyPressed() (é–“æ¥)

ã€6-2ã€‘ãƒ¬ã‚¤ãƒ¤ãƒ¼é–¢é€£

layer:created
    ğŸ“¤ layer-system.js â†’ createLayer()
    ğŸ“¥ æœªç¢ºèª

layer:deleted
    ğŸ“¤ layer-system.js â†’ deleteLayer()
    ğŸ“¥ æœªç¢ºèª

layer:activated
    ğŸ“¤ layer-system.js â†’ setActiveLayer()
    ğŸ“¥ layer-panel-renderer.js (æ¨æ¸¬)

layer:updated
    ğŸ“¤ layer-system.js â†’ å„ç¨®æ“ä½œ
    ğŸ“¥ æœªç¢ºèª

layer:transform-updated
    ğŸ“¤ layer-system.js â†’ flipActiveLayer()
    ğŸ“¥ æœªç¢ºèª

layer:transform-confirmed
    ğŸ“¤ layer-system.js â†’ transform.onTransformComplete
    ğŸ“¥ æœªç¢ºèª

layer:flip-by-key
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:move-by-key
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:scale-by-key
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:rotate-by-key
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:select-next
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:select-prev
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:order-up
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:order-down
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

layer:copy-request
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()
         â†’ drawing-clipboard.js

layer:paste-request
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()
         â†’ drawing-clipboard.js

âš ï¸ layer:clear-active
    ğŸ“¤ keyboard-handler.js
    âŒ ãƒªã‚¹ãƒŠãƒ¼ãŒè¦‹å½“ãŸã‚‰ãªã„

layer:drawings-deleted
    ğŸ“¤ keyboard-handler.js â†’ deleteActiveLayerDrawings()
    ğŸ“¥ æœªç¢ºèª

layer:drawings-restored
    ğŸ“¤ keyboard-handler.js â†’ restoreLayerDrawings()
    ğŸ“¥ æœªç¢ºèª

layer:panel-update-requested
    ğŸ“¤ layer-system.js â†’ _emitPanelUpdateRequest()
    ğŸ“¥ layer-panel-renderer.js

layer:status-update-requested
    ğŸ“¤ layer-system.js â†’ _emitStatusUpdateRequest()
    ğŸ“¥ status-display-renderer.js

layer:stroke-added
    ğŸ“¤ layer-system.js â†’ addPathToActiveLayer()
    ğŸ“¥ æœªç¢ºèª

layer:background-color-changed
    ğŸ“¤ layer-system.js â†’ changeBackgroundLayerColor()
    ğŸ“¥ æœªç¢ºèª

layer:opacity-changed
    ğŸ“¤ layer-system.js â†’ setLayerOpacity()
    ğŸ“¥ æœªç¢ºèª

layer:visibility-changed
    ğŸ“¤ layer-system.js â†’ toggleLayerVisibility()
    ğŸ“¥ æœªç¢ºèª

ã€6-3ã€‘ã‚«ãƒ¡ãƒ©é–¢é€£

camera:flip-horizontal
    ğŸ“¤ keyboard-handler.js
    âŒ camera-system.jsã«ãƒªã‚¹ãƒŠãƒ¼ãªã—
    ğŸ” å®Ÿè£…ã¯_handleCameraFlipKeys()ã§ç‹¬ç«‹

camera:flip-vertical
    ğŸ“¤ keyboard-handler.js
    âŒ camera-system.jsã«ãƒªã‚¹ãƒŠãƒ¼ãªã—
    ğŸ” å®Ÿè£…ã¯_handleCameraFlipKeys()ã§ç‹¬ç«‹

camera:reset
    ğŸ“¤ keyboard-handler.js
    âŒ camera-system.jsã«ãƒªã‚¹ãƒŠãƒ¼ãªã—
    ğŸ” å®Ÿè£…ã¯keydownã‚¤ãƒ™ãƒ³ãƒˆã§ç‹¬ç«‹

camera:transform-changed
    ğŸ“¤ camera-system.js â†’ å„ç¨®æ“ä½œ
    ğŸ“¥ status-display-renderer.js (æ¨æ¸¬)

camera:canvas-move-mode
    ğŸ“¤ camera-system.js
    ğŸ“¥ æœªç¢ºèª

camera:cursor-changed
    ğŸ“¤ camera-system.js
    ğŸ“¥ ui-panels.jsç­‰

camera:resized
    ğŸ“¤ camera-system.js â†’ resizeCanvas()
    ğŸ“¥ layer-system.js â†’ _setupResizeEvents()

ã€6-4ã€‘ãƒ„ãƒ¼ãƒ«é–¢é€£

tool:select
    ğŸ“¤ ä¸æ˜
    ğŸ“¥ layer-system.js â†’ _setupLayerOperations()

ui:sidebar:sync-tool
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ ui-panels.js (æ¨æ¸¬)

ã€6-5ã€‘ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³/GIFé–¢é€£

animation:system-ready
    ğŸ“¤ animation-system.js
    ğŸ“¥ layer-system.js â†’ _setupAnimationSystemIntegration()

animation:frame-applied
    ğŸ“¤ animation-system.js
    ğŸ“¥ layer-system.js

animation:frame-created
    ğŸ“¤ animation-system.js
    ğŸ“¥ layer-system.js

animation:frame-deleted
    ğŸ“¤ animation-system.js
    ğŸ“¥ layer-system.js

frame:copy-current
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ timeline-ui.jsç­‰

frame:paste-right-adjacent
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ timeline-ui.jsç­‰

frame:updated
    ğŸ“¤ layer-system.js â†’ markFrameThumbnailDirty()
    ğŸ“¥ timeline-ui.jsç­‰

ã€6-6ã€‘UIé–¢é€£

ui:toggle-timeline
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ timeline-ui.js

ui:open-settings
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ settings-popup.js

ui:toggle-export
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ export-popup.js

ui:toggle-quick-access
    ğŸ“¤ keyboard-handler.js
    ğŸ“¥ quick-access-popup.js

ã€6-7ã€‘Historyé–¢é€£

history:changed
    ğŸ“¤ history.js
    ğŸ“¥ æœªç¢ºèª

history:undo-completed
    ğŸ“¤ history.js
    ğŸ“¥ æœªç¢ºèª

history:redo-completed
    ğŸ“¤ history.js
    ğŸ“¥ æœªç¢ºèª

ã€6-8ã€‘ã‚µãƒ ãƒã‚¤ãƒ«é–¢é€£

thumbnail:layer-updated
    ğŸ“¤ layer-system.js â†’ requestThumbnailUpdate()
    ğŸ“¥ thumbnail-system.js (æ¨æ¸¬)

================================================================================
ã€7ã€‘å¤šé‡å®Ÿè£…ãƒ»é‡è¤‡ã®è©³ç´°åˆ†æ
================================================================================

ã€7-1ã€‘âš ï¸ Vã‚­ãƒ¼çŠ¶æ…‹ç®¡ç†ã®å¤šé‡å®Ÿè£…

å®Ÿè£…ç®‡æ‰€A: keyboard-handler.js
    å¤‰æ•°: vKeyPressed (let)
    æ›´æ–°: handleKeyDown() ã§ãƒˆã‚°ãƒ«
    é€šçŸ¥: eventBus.emit('keyboard:vkey-pressed')
    
å®Ÿè£…ç®‡æ‰€B: camera-system.js
    å¤‰æ•°: vKeyPressed
    æ›´æ–°: setVKeyPressed(pressed) çµŒç”±
    ç”¨é€”: ã‚«ãƒ¼ã‚½ãƒ«è¡¨ç¤ºåˆ¶å¾¡
    
å®Ÿè£…ç®‡æ‰€C: layer-transform.js
    å¤‰æ•°: isVKeyPressed
    æ›´æ–°: enterMoveMode(), exitMoveMode()
    ç”¨é€”: ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ãƒ¢ãƒ¼ãƒ‰åˆ¤å®š
    
å®Ÿè£…ç®‡æ‰€D: layer-system.js
    ã‚²ãƒƒã‚¿ãƒ¼: get vKeyPressed()
    å®Ÿè£…: return this.transform?.isVKeyPressed || false
    ç”¨é€”: å¤–éƒ¨ã‹ã‚‰ã®çŠ¶æ…‹ç¢ºèª

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š
    - keyboard-handler.jsã‚’å”¯ä¸€ã®çœŸå®Ÿã®æº(Single Source of Truth)ã¨ã™ã‚‹
    - ä»–ã®å…¨ç®‡æ‰€ã¯EventBusçµŒç”±ã§åŒæœŸ
    - camera-system.js: eventBus.on('keyboard:vkey-pressed')ã§æ›´æ–°
    - layer-transform.js: eventBus.on('keyboard:vkey-pressed')ã§æ›´æ–°
    - layer-system.js: ã‚²ãƒƒã‚¿ãƒ¼ã¯å‰Šé™¤ã€transformçµŒç”±ã§å‚ç…§

ã€7-2ã€‘âš ï¸ åº§æ¨™å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰ã®é‡è¤‡

coordinate-system.js (æ­£è¦å®Ÿè£…)
    - screenClientToCanvas(screenX, screenY)
    - canvasToWorld(canvasX, canvasY)
    - worldToLocal(worldX, worldY, layer)
    
camera-system.js (é‡è¤‡å®Ÿè£…)
    - screenClientToWorld(app, clientX, clientY)
    - worldToScreen(app, worldX, worldY)
    - screenToLayer(screenX, screenY)
    - screenToCanvas(screenX, screenY)

å•é¡Œç‚¹ï¼š
    1. åŒã˜æ©Ÿèƒ½ã‚’ç•°ãªã‚‹åå‰ã§å®Ÿè£…
    2. coordinate-system.jsã®å­˜åœ¨æ„ç¾©ãŒä¸æ˜ç¢ºåŒ–
    3. ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã‚³ã‚¹ãƒˆã®å¢—åŠ 
    4. å¤‰æ›ãƒ­ã‚¸ãƒƒã‚¯ã®ä¸æ•´åˆãƒªã‚¹ã‚¯

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š
    camera-system.jså†…ã®ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‰Šé™¤ã—ã€
    coordinate-system.jsã®çµ±ä¸€APIã‚’ä½¿ç”¨ï¼š
    
    // å‰Šé™¤å¯¾è±¡
    - screenClientToWorld() â†’ CoordinateSystem.screenClientToCanvas() + canvasToWorld()
    - worldToScreen() â†’ æ–°è¦å®Ÿè£…ãŒå¿…è¦ãªã‚‰coordinate-system.jsã«è¿½åŠ 
    - screenToLayer() â†’ CoordinateSystem.worldToLocal()ä½¿ç”¨
    - screenToCanvas() â†’ CoordinateSystem.screenClientToCanvas()ä½¿ç”¨

ã€7-3ã€‘âš ï¸ ã‚«ãƒ¡ãƒ©åè»¢ã‚¤ãƒ™ãƒ³ãƒˆã®ä¸æ•´åˆ

keyboard-handler.js
    case 'CAMERA_FLIP_HORIZONTAL':
        eventBus.emit('camera:flip-horizontal');
        
    case 'CAMERA_FLIP_VERTICAL':
        eventBus.emit('camera:flip-vertical');

camera-system.js
    âŒ 'camera:flip-horizontal' ã®ãƒªã‚¹ãƒŠãƒ¼ãªã—
    âŒ 'camera:flip-vertical' ã®ãƒªã‚¹ãƒŠãƒ¼ãªã—
    
    å®Ÿè£…ã¯ _handleCameraFlipKeys() ã§ç‹¬ç«‹:
    document.addEventListener('keydown', (e) => {
        ...
        this._handleCameraFlipKeys(e);
    });

å•é¡Œç‚¹ï¼š
    1. EventBusã§ç™ºç«ã•ã‚Œã¦ã„ã‚‹ãŒå—ä¿¡ã•ã‚Œãªã„
    2. å®Ÿéš›ã®å‡¦ç†ã¯keydownã‚¤ãƒ™ãƒ³ãƒˆã§ç›´æ¥å®Ÿè¡Œ
    3. keyboard-handler.jsã¨camera-system.jsã®äºŒé‡å‡¦ç†ã®å¯èƒ½æ€§

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š
    ãƒ‘ã‚¿ãƒ¼ãƒ³A: EventBusçµ±ä¸€
        camera-system.jsã«ä»¥ä¸‹ã‚’è¿½åŠ :
        eventBus.on('camera:flip-horizontal', () => {...});
        eventBus.on('camera:flip-vertical', () => {...});
        _handleCameraFlipKeys()å†…ã®Hã‚­ãƒ¼å‡¦ç†ã‚’å‰Šé™¤
        
    ãƒ‘ã‚¿ãƒ¼ãƒ³B: ç›´æ¥å‡¦ç†çµ±ä¸€
        keyboard-handler.jsã‹ã‚‰ä»¥ä¸‹ã‚’å‰Šé™¤:
        eventBus.emit('camera:flip-horizontal');
        eventBus.emit('camera:flip-vertical');
        camera-system.jså´ã®å‡¦ç†ã®ã¿æ®‹ã™

ã€7-4ã€‘âš ï¸ TEGAKI_KEYCONFIG ã®å»ƒæ­¢æ¨å¥¨

config.jså†…ã«2ã¤ã®ã‚­ãƒ¼ãƒãƒƒãƒ—å®šç¾©:

å®Ÿè£…A: window.TEGAKI_KEYMAP (æ–°å¼ãƒ»ä½¿ç”¨ä¸­)
    - actions: {...}
    - getAction(event, context)
    - getKeyDisplayName(keyCode)
    - getShortcutList()

å®Ÿè£…B: window.TEGAKI_KEYCONFIG (æ—§å¼ãƒ»æœªä½¿ç”¨)
    - pen: 'KeyP'
    - eraser: 'KeyE'
    - layerMode: 'KeyV'
    - canvasReset: 'Digit0'
    - horizontalFlip: 'KeyH'
    - ... (å˜ç´”ãªkey-valueãƒãƒƒãƒ—)

ä½¿ç”¨çŠ¶æ³ï¼š
    âœ… TEGAKI_KEYMAP: keyboard-handler.jsã§ä½¿ç”¨
    âŒ TEGAKI_KEYCONFIG: ã©ã“ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œã¦ã„ãªã„

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š
    TEGAKI_KEYCONFIGã‚’å®Œå…¨å‰Šé™¤

ã€7-5ã€‘âš ï¸ layer:clear-active ã‚¤ãƒ™ãƒ³ãƒˆã®æœªå®Ÿè£…

keyboard-handler.js (ç™ºç«å´)
    case 'LAYER_CLEAR':
        eventBus.emit('layer:clear-active');
        event.preventDefault();
        break;

âŒ ãƒªã‚¹ãƒŠãƒ¼ãŒå­˜åœ¨ã—ãªã„

config.js (å®šç¾©)
    LAYER_CLEAR: {
        key: 'Delete',
        ctrl: true,
        shift: false,
        description: 'ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¯ãƒªã‚¢'
    }

å•é¡Œç‚¹ï¼š
    1. Ctrl+Deleteã®ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãŒå®šç¾©ã•ã‚Œã¦ã„ã‚‹ãŒå‹•ä½œã—ãªã„
    2. layer:clear-activeã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚‹ç®‡æ‰€ãŒãªã„
    3. LAYER_DELETE_DRAWINGS (Deleteå˜ä½“) ã¨ã®æ©Ÿèƒ½é‡è¤‡

ğŸ”§ æ”¹ä¿®ææ¡ˆï¼š
    ãƒ‘ã‚¿ãƒ¼ãƒ³A: æ©Ÿèƒ½å®Ÿè£…
        layer-system.jsã«è¿½åŠ :
        eventBus.on('layer:clear-active', () => {
            // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å…¨æç”»ã‚’ã‚¯ãƒªã‚¢
            // LAYER_DELETE_DRAWINGSã¨åŒã˜å‡¦ç†
        });
        
    ãƒ‘ã‚¿ãƒ¼ãƒ³B: å‰Šé™¤
        ä¸è¦ãªã‚‰ config.js ã‹ã‚‰ LAYER_CLEARå®šç¾©ã‚’å‰Šé™¤

================================================================================
ã€8ã€‘ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ãƒ„ãƒªãƒ¼
================================================================================

ã€8-1ã€‘è¨­å®šãƒ»åŸºç›¤ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 0)

config.js
    â”œâ”€ å­: å…¨ãƒ•ã‚¡ã‚¤ãƒ« (TEGAKI_CONFIGå‚ç…§)
    â””â”€ è¦ª: ãªã—

event-bus.js
    â”œâ”€ å­: å…¨ã‚·ã‚¹ãƒ†ãƒ ãƒ•ã‚¡ã‚¤ãƒ«
    â””â”€ è¦ª: ãªã—

coordinate-system.js
    â”œâ”€ å­: camera-system.js, layer-system.js, drawing-engine.js
    â””â”€ è¦ª: ãªã—

ã€8-2ã€‘ãƒ‡ãƒ¼ã‚¿/ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 1)

data-models.js
    â”œâ”€ å­: layer-system.js
    â””â”€ è¦ª: ãªã—

history.js
    â”œâ”€ å­: layer-system.js, keyboard-handler.js
    â””â”€ è¦ª: event-bus.js

batch-api.js
    â”œâ”€ å­: ä¸æ˜
    â””â”€ è¦ª: ãªã—

ã€8-3ã€‘ã‚·ã‚¹ãƒ†ãƒ ã‚³ã‚¢ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 2)

camera-system.js
    â”œâ”€ å­: drawing-engine.js, layer-transform.js
    â”œâ”€ è¦ª: config.js, event-bus.js, coordinate-system.js
    â””â”€ ä¾å­˜: layerManager (ç›¸äº’å‚ç…§)

layer-system.js
    â”œâ”€ å­: drawing-engine.js, layer-panel-renderer.js
    â”œâ”€ è¦ª: event-bus.js, data-models.js, layer-transform.js
    â”‚       coordinate-system.js, config.js, history.js
    â””â”€ ä¾å­˜: cameraSystem, animationSystem

layer-transform.js
    â”œâ”€ å­: layer-system.js (é€†å‘ãå§”è­²)
    â”œâ”€ è¦ª: config.js, coordinate-system.js
    â””â”€ ä¾å­˜: vectorOperations, cameraSystem

ã€8-4ã€‘æç”»ã‚·ã‚¹ãƒ†ãƒ ãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 3)

drawing-engine.js
    â”œâ”€ å­: ui-panels.js, core-engine.js
    â”œâ”€ è¦ª: camera-system.js, layer-system.js
    â”‚       pointer-handler.js, pressure-handler.js
    â”‚       stroke-recorder.js, stroke-renderer.js
    â””â”€ ä¾å­˜: brushCore, brushSettings

stroke-recorder.js
    â”œâ”€ å­: drawing-engine.js
    â””â”€ è¦ª: ãªã— (ç´”ç²‹ãƒ‡ãƒ¼ã‚¿è¨˜éŒ²)

stroke-renderer.js
    â”œâ”€ å­: drawing-engine.js
    â””â”€ è¦ª: sdf-mesh-builder.js, msdf-brush-shader.js

brush-core.js
    â”œâ”€ å­: drawing-engine.js, core-runtime.js
    â””â”€ è¦ª: brushSettings

brush-settings.js
    â”œâ”€ å­: brush-core.js, drawing-engine.js
    â””â”€ è¦ª: config.js

ã€8-5ã€‘UIãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 4)

keyboard-handler.js
    â”œâ”€ å­: core-initializer.js
    â”œâ”€ è¦ª: config.js, event-bus.js, history.js
    â”‚       core-runtime.js (apiå‚ç…§)
    â””â”€ ä¾å­˜: layerSystem (window.drawingApp.layerManager)

layer-panel-renderer.js
    â”œâ”€ å­: ui-panels.js
    â””â”€ è¦ª: event-bus.js (layer:* ã‚¤ãƒ™ãƒ³ãƒˆè³¼èª­)

timeline-ui.js
    â”œâ”€ å­: core-engine.js
    â””â”€ è¦ª: animationSystem

ui-panels.js
    â”œâ”€ å­: core-initializer.js
    â””â”€ è¦ª: å„ç¨®UIç³»ãƒ•ã‚¡ã‚¤ãƒ«

ã€8-6ã€‘çµ±åˆãƒ¬ã‚¤ãƒ¤ãƒ¼ (Layer 5)

core-runtime.js
    â”œâ”€ å­: keyboard-handler.js, å„ç¨®UI
    â”œâ”€ è¦ª: å…¨ã‚·ã‚¹ãƒ†ãƒ 
    â””â”€ æä¾›: window.CoreRuntime.api

core-engine.js
    â”œâ”€ å­: core-initializer.js
    â”œâ”€ è¦ª: å…¨ã‚·ã‚¹ãƒ†ãƒ 
    â””â”€ çµ±åˆ: å…¨æ©Ÿèƒ½ã®åˆæœŸåŒ–ãƒ»é€£æº

core-initializer.js
    â”œâ”€ å­: index.html (ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ)
    â””â”€ è¦ª: core-engine.js

================================================================================
ã€9ã€‘å»ƒæ­¢ãƒ»çµ±åˆã®æ¤œè¨å¯¾è±¡
================================================================================

ã€9-1ã€‘âœ… å³åº§ã«å‰Šé™¤å¯èƒ½

1. window.TEGAKI_KEYCONFIG (config.js)
    ç†ç”±: ã©ã“ã‹ã‚‰ã‚‚å‚ç…§ã•ã‚Œã¦ã„ãªã„
    å½±éŸ¿: ãªã—
    
2. window.TEGAKI_COORDINATE_SYSTEM (ã‚‚ã—å­˜åœ¨ã™ã‚Œã°)
    ç†ç”±: window.CoordinateSystemã¨é‡è¤‡
    å½±éŸ¿: å‚ç…§ç®‡æ‰€ã‚’å…¨ã¦CoordinateSystemã«çµ±ä¸€

ã€9-2ã€‘ğŸ”§ æ”¹ä¿®å¾Œã«å‰Šé™¤å¯èƒ½

1. camera-system.jså†…ã®åº§æ¨™å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰
    - screenClientToWorld()
    - worldToScreen()
    - screenToLayer()
    - screenToCanvas()
    ç†ç”±: coordinate-system.jsã¨æ©Ÿèƒ½é‡è¤‡
    æ”¹ä¿®: coordinate-system.jsã®APIã‚’ä½¿ç”¨ã™ã‚‹ã‚ˆã†ä¿®æ­£å¾Œã«å‰Šé™¤

2. camera-system.jså†…ã®_handleCameraFlipKeys()ã®Hã‚­ãƒ¼å‡¦ç†
    ç†ç”±: EventBusçµ±ä¸€å¾Œã¯ä¸è¦
    æ”¹ä¿®: EventBusãƒªã‚¹ãƒŠãƒ¼å®Ÿè£…å¾Œã«å‰Šé™¤

3. layer-system.jså†…ã® vKeyPressed ã‚²ãƒƒã‚¿ãƒ¼
    ç†ç”±: keyboard-handler.jsã¸ã®çµ±ä¸€å¾Œã¯ä¸è¦
    æ”¹ä¿®: å‚ç…§ç®‡æ‰€ã‚’å…¨ã¦EventBusçµŒç”±ã«å¤‰æ›´å¾Œã«å‰Šé™¤

ã€9-3ã€‘â“ æ©Ÿèƒ½ç¢ºèªãŒå¿…è¦

1. LAYER_CLEAR (Ctrl+Delete)
    ç¾çŠ¶: å®šç¾©ã‚ã‚Šãƒ»å®Ÿè£…ãªã—
    ç¢ºèªäº‹é …: 
        - LAYER_DELETE_DRAWINGSã¨ã®æ©Ÿèƒ½å·®ã¯ï¼Ÿ
        - æœ¬å½“ã«å¿…è¦ãªæ©Ÿèƒ½ã‹ï¼Ÿ
    
    é¸æŠè‚¢A: å®Ÿè£…ã™ã‚‹
        â†’ layer-system.jsã«ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
    
    é¸æŠè‚¢B: å‰Šé™¤ã™ã‚‹
        â†’ config.jsã‹ã‚‰å®šç¾©å‰Šé™¤

2. camera:flip-* ã‚¤ãƒ™ãƒ³ãƒˆ
    ç¾çŠ¶: ç™ºç«ã•ã‚Œã¦ã„ã‚‹ãŒå—ä¿¡ã•ã‚Œãªã„
    ç¢ºèªäº‹é …:
        - EventBusçµ±ä¸€ã™ã¹ãã‹ï¼Ÿ
        - ç›´æ¥å‡¦ç†ã§ååˆ†ã‹ï¼Ÿ
    
    é¸æŠè‚¢A: EventBusçµ±ä¸€
        â†’ camera-system.jsã«ãƒªã‚¹ãƒŠãƒ¼è¿½åŠ 
        â†’ _handleCameraFlipKeys()ã‹ã‚‰å‡¦ç†å‰Šé™¤
    
    é¸æŠè‚¢B: ç›´æ¥å‡¦ç†ã®ã¿
        â†’ keyboard-handler.jsã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«å‰Šé™¤

ã€9-4ã€‘ğŸ” å°†æ¥çš„ãªçµ±åˆå€™è£œ

1. tool:* ã‚¤ãƒ™ãƒ³ãƒˆã¨ ui:sidebar:sync-tool
    ç¾çŠ¶: ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆæ™‚ã®UIåŒæœŸãŒåˆ†æ•£
    çµ±åˆæ¡ˆ: tool:changed ã‚¤ãƒ™ãƒ³ãƒˆã«çµ±ä¸€

2. layer:* ã‚¤ãƒ™ãƒ³ãƒˆã®æ•´ç†
    ç¾çŠ¶: 20ç¨®é¡ä»¥ä¸Šã®ã‚¤ãƒ™ãƒ³ãƒˆãŒå­˜åœ¨
    çµ±åˆæ¡ˆ: 
        - layer:state-changed ã«é›†ç´„
        - payloadã§è©³ç´°ã‚’åˆ¤æ–­
        - å¿…è¦ã«å¿œã˜ã¦å€‹åˆ¥ã‚¤ãƒ™ãƒ³ãƒˆã‚‚æ®‹ã™

================================================================================
ã€10ã€‘æ”¹ä¿®å„ªå…ˆé †ä½
================================================================================

ã€å„ªå…ˆåº¦: é«˜ (å³åº§ã«å¯¾å¿œ)ã€‘

ğŸ”§ 1. TEGAKI_KEYCONFIG ã®å‰Šé™¤
    å½±éŸ¿ç¯„å›²: ãªã—
    ä½œæ¥­æ™‚é–“: 5åˆ†
    ãƒªã‚¹ã‚¯: ãªã—
    
ğŸ”§ 2. layer:clear-active ã®å®Ÿè£… or å‰Šé™¤åˆ¤æ–­
    å½±éŸ¿ç¯„å›²: keyboard-handler.js, config.js, layer-system.js
    ä½œæ¥­æ™‚é–“: 30åˆ†
    ãƒªã‚¹ã‚¯: ä½
    
ğŸ”§ 3. camera:flip-* ã‚¤ãƒ™ãƒ³ãƒˆã®çµ±ä¸€
    å½±éŸ¿ç¯„å›²: keyboard-handler.js, camera-system.js
    ä½œæ¥­æ™‚é–“: 1æ™‚é–“
    ãƒªã‚¹ã‚¯: ä¸­ (ãƒ†ã‚¹ãƒˆå¿…é ˆ)

ã€å„ªå…ˆåº¦: ä¸­ (è¨ˆç”»çš„ã«å¯¾å¿œ)ã€‘

ğŸ”§ 4. Vã‚­ãƒ¼çŠ¶æ…‹ç®¡ç†ã®ä¸€å…ƒåŒ–
    å½±éŸ¿ç¯„å›²: keyboard-handler.js, camera-system.js,
              layer-transform.js, layer-system.js
    ä½œæ¥­æ™‚é–“: 2æ™‚é–“
    ãƒªã‚¹ã‚¯: ä¸­ (åºƒç¯„å›²ã®å¤‰æ›´)
    
ğŸ”§ 5. åº§æ¨™å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰ã®çµ±ä¸€
    å½±éŸ¿ç¯„å›²: camera-system.js, coordinate-system.js,
              drawing-engine.js (å‘¼ã³å‡ºã—å´)
    ä½œæ¥­æ™‚é–“: 3æ™‚é–“
    ãƒªã‚¹ã‚¯: é«˜ (åº§æ¨™ç³»ã®æ ¸å¿ƒéƒ¨åˆ†)

ã€å„ªå…ˆåº¦: ä½ (ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æ™‚ã«)ã€‘

ğŸ”§ 6. layer:* ã‚¤ãƒ™ãƒ³ãƒˆã®æ•´ç†
    å½±éŸ¿ç¯„å›²: å…¨ã‚·ã‚¹ãƒ†ãƒ 
    ä½œæ¥­æ™‚é–“: åŠæ—¥ä»¥ä¸Š
    ãƒªã‚¹ã‚¯: é«˜
    
ğŸ”§ 7. ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ã®æ–‡æ›¸åŒ–å¼·åŒ–
    å½±éŸ¿ç¯„å›²: å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ˜ãƒƒãƒ€ãƒ¼ã‚³ãƒ¡ãƒ³ãƒˆ
    ä½œæ¥­æ™‚é–“: 1æ—¥
    ãƒªã‚¹ã‚¯: ãªã—

================================================================================
ã€11ã€‘ãƒ†ã‚¹ãƒˆé …ç›®ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ
================================================================================

ã€åŸºæœ¬å‹•ä½œãƒ†ã‚¹ãƒˆã€‘

âœ… ãƒšãƒ³/æ¶ˆã—ã‚´ãƒ åˆ‡ã‚Šæ›¿ãˆ (P/E)
âœ… ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½åŠ  (Ctrl+L)
âœ… ãƒ¬ã‚¤ãƒ¤ãƒ¼å‰Šé™¤ã®çµµ (Delete/Backspace)
âœ… Undo/Redo (Ctrl+Z/Y)

ã€Vã‚­ãƒ¼ãƒ¢ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆã€‘

âœ… Vã‚­ãƒ¼æŠ¼ä¸‹ã§ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ ãƒ‘ãƒãƒ«è¡¨ç¤º
âœ… V + çŸ¢å°ã‚­ãƒ¼ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•
âœ… V + Shift + çŸ¢å°ã‚­ãƒ¼ã§æ‹¡å¤§ç¸®å°ãƒ»å›è»¢
âœ… V + H ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼æ°´å¹³åè»¢
âœ… V + Shift + H ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼å‚ç›´åè»¢
âœ… V + Ctrl + 0 ã§ãƒªã‚»ãƒƒãƒˆ
âœ… Vã‚­ãƒ¼é›¢è„±ã§ãƒ‘ãƒãƒ«éè¡¨ç¤º

ã€ã‚«ãƒ¡ãƒ©æ“ä½œãƒ†ã‚¹ãƒˆã€‘

âœ… H ã§ã‚­ãƒ£ãƒ³ãƒã‚¹æ°´å¹³åè»¢
âœ… Shift + H ã§ã‚­ãƒ£ãƒ³ãƒã‚¹å‚ç›´åè»¢
âœ… Ctrl + 0 ã§ã‚«ãƒ¡ãƒ©ãƒªã‚»ãƒƒãƒˆ
âœ… Space + ãƒ‰ãƒ©ãƒƒã‚°ã§ã‚­ãƒ£ãƒ³ãƒã‚¹ç§»å‹•
âœ… Space + Shift + ãƒ‰ãƒ©ãƒƒã‚°ã§æ‹¡ç¸®ãƒ»å›è»¢
âœ… ãƒ›ã‚¤ãƒ¼ãƒ«ã§ã‚ºãƒ¼ãƒ 

ã€åè»¢Historyå‹•ä½œãƒ†ã‚¹ãƒˆã€‘

âœ… V + H å¾Œã« Ctrl+Z ã§å…ƒã«æˆ»ã‚‹
âœ… V + Shift + H å¾Œã« Ctrl+Z ã§å…ƒã«æˆ»ã‚‹
âœ… H å¾Œã« Ctrl+Z ã§å…ƒã«æˆ»ã‚‹
âœ… Shift + H å¾Œã« Ctrl+Z ã§å…ƒã«æˆ»ã‚‹
âœ… åè»¢â†’Undoâ†’Redoã§æ­£ã—ãå‹•ä½œ

ã€å•é¡Œç®‡æ‰€ãƒ†ã‚¹ãƒˆã€‘

âš ï¸ Ctrl + Delete ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚¯ãƒªã‚¢
    â†’ æœŸå¾…: ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®çµµãŒå…¨å‰Šé™¤
    â†’ å®Ÿéš›: å‹•ä½œã—ãªã„ï¼ˆæœªå®Ÿè£…ï¼‰

ğŸ” Vã‚­ãƒ¼çŠ¶æ…‹ã®åŒæœŸ
    â†’ Vã‚­ãƒ¼æŠ¼ä¸‹ä¸­ã«ã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ãƒ•ã‚©ãƒ¼ã‚«ã‚¹å–ªå¤±
    â†’ æœŸå¾…: Vã‚­ãƒ¼çŠ¶æ…‹ãŒãƒªã‚»ãƒƒãƒˆã•ã‚Œã‚‹
    â†’ ç¢ºèª: keyboard-handler/camera-systemä¸¡æ–¹ã§ãƒªã‚»ãƒƒãƒˆ

ğŸ” ã‚«ãƒ¡ãƒ©åè»¢ã‚¤ãƒ™ãƒ³ãƒˆ
    â†’ H/Shift+HæŠ¼ä¸‹æ™‚
    â†’ ç¢ºèª: EventBusã§ã‚¤ãƒ™ãƒ³ãƒˆç™ºç«ã•ã‚Œã¦ã„ã‚‹ã‹
    â†’ ç¢ºèª: camera-system.jsã§å‡¦ç†ã•ã‚Œã¦ã„ã‚‹ã‹

================================================================================
ã€12ã€‘æ¨å¥¨ã•ã‚Œã‚‹æ¬¡ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³
================================================================================

ã€Phase 1: ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ— (1-2æ™‚é–“)ã€‘

1. âœ… TEGAKI_KEYCONFIGå‰Šé™¤
    ãƒ•ã‚¡ã‚¤ãƒ«: config.js
    
2. ğŸ”§ layer:clear-activeåˆ¤æ–­
    ã‚ªãƒ—ã‚·ãƒ§ãƒ³A: å‰Šé™¤ï¼ˆLAYER_DELETE_DRAWINGSã¨é‡è¤‡ï¼‰
    ã‚ªãƒ—ã‚·ãƒ§ãƒ³B: å®Ÿè£…ï¼ˆåˆ¥æ©Ÿèƒ½ã¨ã—ã¦å¿…è¦ï¼‰

3. ğŸ”§ ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã‚¤ãƒ™ãƒ³ãƒˆå®šç¾©ã®å‰Šé™¤
    èª¿æŸ»å¯¾è±¡: event-bus.js ã® EVENTSå®šæ•°

ã€Phase 2: çµ±ä¸€åŒ– (2-3æ™‚é–“)ã€‘

4. ğŸ”§ camera:flip-* ã‚¤ãƒ™ãƒ³ãƒˆã®çµ±ä¸€
    æ¨å¥¨: EventBusçµ±ä¸€ãƒ‘ã‚¿ãƒ¼ãƒ³
    
5. ğŸ”§ Vã‚­ãƒ¼çŠ¶æ…‹ç®¡ç†ã®ä¸€å…ƒåŒ–
    æ¨å¥¨: keyboard-handler.jsã‚’çœŸå®Ÿã®æºã¨ã™ã‚‹

ã€Phase 3: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚° (åŠæ—¥)ã€‘

6. ğŸ”§ åº§æ¨™å¤‰æ›ãƒ¡ã‚½ãƒƒãƒ‰ã®çµ±ä¸€
    coordinate-system.jsã«å…¨æ©Ÿèƒ½é›†ç´„
    
7. ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ãƒ˜ãƒƒãƒ€ãƒ¼ã®ä¾å­˜é–¢ä¿‚æ›´æ–°
    å„ãƒ•ã‚¡ã‚¤ãƒ«ã«æ­£ç¢ºãªè¦ªå­é–¢ä¿‚ã‚’è¨˜è¿°

ã€Phase 4: ãƒ†ã‚¹ãƒˆãƒ»æ¤œè¨¼ (2-3æ™‚é–“)ã€‘

8. âœ… å…¨ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®å‹•ä½œç¢ºèª
9. âœ… Historyã®äºŒé‡ç™»éŒ²ãƒã‚§ãƒƒã‚¯
10. âœ… ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼ã®æ•´åˆæ€§ç¢ºèª

================================================================================
ã€ä»˜éŒ²Aã€‘ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°æ±šæŸ“ã®çŠ¶æ³
================================================================================

windowç›´ä¸‹ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ:

[è¨­å®šç³»]
- TEGAKI_CONFIG
- TEGAKI_KEYMAP
- TEGAKI_KEYCONFIG âš ï¸ æœªä½¿ç”¨ãƒ»å‰Šé™¤æ¨å¥¨
- TEGAKI_COLORS
- TEGAKI_UTILS

[ã‚·ã‚¹ãƒ†ãƒ ç³»]
- TegakiEventBus
- CoordinateSystem
- TEGAKI_COORDINATE_SYSTEM âš ï¸ é‡è¤‡ã®å¯èƒ½æ€§

[ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ç³»]
- cameraSystem
- layerManager (drawingApp.layerManagerçµŒç”±ã‚‚)
- drawingEngine
- animationSystem
- timelineUI

[ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ç³»]
- KeyboardHandler
- History
- brushCore
- brushSettings
- drawingClipboard
- checkerUtils

[çµ±åˆAPIç³»]
- CoreRuntime
- CoreEngine
- CoreInitializer

[ã‚¯ãƒ©ã‚¹å®šç¾©ç³»]
- TegakiCameraSystem
- TegakiLayerSystem
- TegakiLayerTransform
- TegakiAnimationSystem
- EventBus

åˆè¨ˆ: ç´„30å€‹ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°

ğŸ”§ æ”¹ä¿®ææ¡ˆ: 
    window.Tegaki = { ... } ã®ã‚ˆã†ãª
    å˜ä¸€ã®åå‰ç©ºé–“ã«çµ±åˆã™ã‚‹ã“ã¨ã‚’æ¤œè¨

================================================================================
ã€ä»˜éŒ²Bã€‘ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°å‰Šé™¤å€™è£œ
================================================================================

å„ãƒ•ã‚¡ã‚¤ãƒ«æœ«å°¾ã®èª­ã¿è¾¼ã¿ç¢ºèªãƒ­ã‚°:
    console.log('âœ… xxx.js loaded')
    
å‰Šé™¤æ¨å¥¨ç†ç”±:
    - æœ¬ç•ªç’°å¢ƒã§ã¯ä¸è¦
    - ãƒ‡ãƒãƒƒã‚°æ™‚ã¯Network/Sourcesãƒ‘ãƒãƒ«ã§ç¢ºèªå¯èƒ½
    - éå‰°ãªã‚³ãƒ³ã‚½ãƒ¼ãƒ«å‡ºåŠ›

ä»£æ›¿æ¡ˆ:
    - window.TEGAKI_CONFIG.debugãŒtrueã®æ™‚ã®ã¿å‡ºåŠ›
    - ã¾ãŸã¯å®Œå…¨å‰Šé™¤

================================================================================
ã€ä»˜éŒ²Cã€‘æœªä½¿ç”¨export/importã®å¯èƒ½æ€§
================================================================================

æ³¨æ„: æœ¬ãƒ„ãƒ¼ãƒ«ã¯ES Modulesã‚’ä½¿ç”¨ã—ã¦ã„ãªã„ãŸã‚ã€
      export/importæ§‹æ–‡ã¯ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„ã€‚
      
å…¨ã¦ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°ã§ã®é€£æºã¨ãªã£ã¦ãŠã‚Šã€
ã“ã‚ŒãŒä¾å­˜é–¢ä¿‚ã®ä¸æ˜ç¢ºåŒ–ã®ä¸€å› ã¨ãªã£ã¦ã„ã‚‹ã€‚

å°†æ¥çš„ãªãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã®æ¤œè¨:
    1. ES ModulesåŒ–
    2. æ˜ç¤ºçš„ãªimport/export
    3. bundler (Viteç­‰) ã®å°å…¥

ãŸã ã—ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã§ç¦æ­¢ã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€
ç¾çŠ¶ç¶­æŒã‚‚é¸æŠè‚¢ã€‚

================================================================================
End of Document
================================================================================