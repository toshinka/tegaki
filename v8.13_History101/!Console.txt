✅ config.js (P/E+ドラッグ機能対応版) loaded
    🆕 tools: ペン/消しゴムのデフォルト設定追加
    🆕 sizeSlots: サイズスロット設定追加
    🆕 dragAdjustment: ドラッグ調整感度設定追加
    🆕 dragAdjustment.visual: 視覚フィードバック設定追加
 🧭 CoordinateSystem: システム統合改修版 初期化
 ✅ coordinate-system.js loaded (システム統合改修版)
 🔧 改修完了項目:
   🆕 applyLayerTransform(): 統一レイヤー変形API
   🆕 normalizeTransform(): 変形データ正規化
   🆕 combineTransforms(): 変形合成
   🆕 screenToWorld/worldToScreen(): キャッシュ対応座標変換
   🆕 localToWorld/worldToLocal(): レイヤー座標変換
   🆕 getLayerBounds(): 統一境界取得
   🆕 distance/angle/normalizeAngle(): 数学関数統合
   🆕 normalizeVector/dotProduct/crossProduct(): ベクトル計算
   🆕 diagnoseReferences(): システム統合診断
   🆕 runTransformTests(): 座標変換テスト
   🆕 runPerformanceTest(): パフォーマンス測定
   🔧 EventBus完全統合・キャッシュシステム
   🔧 LayerSystem/CameraSystem/AnimationSystem参照統合
   🔧 座標系混在問題・API断片化解消
   ✅ PixiJS v8.13 完全対応
   ✅ システム間連携強化
 ✅ data-models.js (Phase 2: meshVertices対応) loaded
 ✅ system/event-bus.js loaded
 ✅ batch-api.js (Phase 6: History統合版) loaded
tool-size-manager.js:5 Uncaught TypeError: Cannot read properties of undefined (reading 'tools')
 ✅ system/settings-manager.js loaded
    - 責務: 設定の永続化・デフォルト管理
    - SOLID原則準拠: 単一責任
    - EventBus統合: 設定変更の購読と通知
 ✅ camera-system.js (Phase 4.2: 拡縮上下修正版) loaded successfully
    - 🔥 Space+Shift+ドラッグ: 上=拡大、下=縮小に修正
    - 🔥 Space+Shift+↑: 拡大、Space+Shift+↓: 縮小に修正
 ✅ layer-transform.js loaded
 ✅ layer-system.js (GPT5案修正完全版) loaded
 ✅ drawing-clipboard.js Phase4改修版+確定イベント loaded
    - ✅ CTRL+V behavior: overwrite active layer
    - ✅ Commit events: paste:commit, operation:commit
    - ✅ Thumbnail auto-update on paste
 ✅ history.js (Phase 2: EventBus修正版) loaded
 ✅ animation-system.js (Phase 4.1: CUT自動採番対応版) loaded
 🔧 [BrushSettings] Starting registration...
brush-settings.js:296 ✅ [BrushSettings] Created window.TegakiDrawing namespace
brush-settings.js:309 ✅ [BrushSettings] Registered successfully:
brush-settings.js:310    - window.TegakiDrawing.BrushSettings: true
brush-settings.js:311    - window.BrushSettings: true
brush-settings.js:312    - globalThis.BrushSettings: true
brush-settings.js:314 ✅ brush-settings.js loaded completely
drawing-engine.js:508 ✅ drawing-engine.js v7.8 loaded (強制EventBus統合版)
export-manager.js:259 ✅ export-manager.js loaded
png-exporter.js:85 ✅ png-exporter.js (単一フレーム専用・プレビュー対応) loaded
apng-exporter.js:236 ✅ apng-exporter.js (PixiJS v8.13完全対応版) loaded
gif-exporter.js:300 ✅ gif-exporter.js (PixiJS v8.13完全対応版) loaded
slider-utils.js:197 ✅ ui/slider-utils.js loaded
slider-utils.js:198    - 責務: スライダーUIの統一実装
slider-utils.js:199    - DRY原則: settings-popup.js と ui-panels.js で共有
slider-utils.js:200    - API: createSlider() / createSimpleSlider()
drag-visual-feedback.js:182 ✅ drag-visual-feedback.js loaded (カーソル追従改善)
keyboard-handler.js:598 ✅ keyboard-handler.js loaded (P/E+ドラッグ修正版)
timeline-ui.js:977 ✅ timeline-ui.js (Phase 5.2: キー処理一元化版) loaded
timeline-ui.js:978    - 🔥 setupKeyboardShortcuts()を削除（キー処理はUnifiedKeyHandlerに一元化）
timeline-ui.js:979    - 🔥 goToPreviousCutSafe()とgoToNextCutSafe()はpublicメソッドとして維持
timeline-ui.js:980    - 🔥 togglePlayStop()もpublicメソッドとして維持
tool-size-popup.js:282 ✅ tool-size-popup.js loaded
tool-size-popup.js:283 Debug: window.ToolSizePopup.forceShow("pen") to test
core-initializer.js:455 ✅ core-initializer.js (P/E+ドラッグ対応版) loaded
core-runtime.js:781 ✅ core-runtime.js v2.1 loaded
core-runtime.js:782   ✅ Phase 12: PixiJS EventSystem統合
core-runtime.js:783   ✅ FederatedPointerEvent対応
core-runtime.js:784   ✅ stage.eventMode設定
core-runtime.js:785   ✅ 🆕 v2.1: 設定関連API追加
core-runtime.js:786      - setPressureCorrection()
core-runtime.js:787      - setSmoothing()
core-runtime.js:788      - setPressureCurve()
core-runtime.js:789      - getSettings()
core-runtime.js:790      - updateSettings()
core-runtime.js:791      - resetSettings()
core-runtime.js:792      - getSettingsManager()
core-runtime.js:793   ✅ window.startTegakiApp() registered
core-runtime.js:794   ✅ APNGExporter登録対応
core-runtime.js:795   ✅ 既存機能完全維持
core-engine.js:850 ✅ core-engine.js (GPT5案修正完全版) loaded
coordinate-system.js:63 🔗 CoordinateSystem EventBus integration configured
coordinate-system.js:47 ✅ CoordinateSystem initialized with canvas: 344x135
coordinate-system.js:757 🔄 CoordinateSystem auto-initialized
index.html:79 🚀 Starting application with Tool Size Popup...
index.html:83 📦 Checking dependencies...
index.html:84   PIXI: true
index.html:85   TegakiDrawing: true
index.html:86   BrushSettings: true
index.html:87   ToolSizeManager: false
index.html:88   ToolSizePopup: true
index.html:89   KeyboardHandler: true
drawing-clipboard.js:19 DrawingClipboard: Initializing...
drawing-clipboard.js:26 ✅ DrawingClipboard initialized (Phase4改修版 + 確定イベント)
coordinate-system.js:75 🔗 CameraSystem reference set in CoordinateSystem
coordinate-system.js:70 🔗 LayerSystem reference set in CoordinateSystem
coordinate-system.js:80 🔗 AnimationSystem reference set in CoordinateSystem
core-runtime.js:51 === CoreRuntime Phase 12: PixiJS EventSystem統合版 初期化開始 ===
core-runtime.js:203 ✅ CUT作成: CUT1 (344x135)
core-runtime.js:231 🔄 CUT切替: CUT1
core-runtime.js:101 ✅ PixiJS EventSystem設定完了
core-runtime.js:68 ✅ CoreRuntime 初期化完了（Phase 12対応）
ui-panels.js:160 [UIController] Setting up event delegation
index.html:118 ✅ Application ready!
index.html:119 📝 Usage:
index.html:120   - Click Pen/Eraser icon: Open size popup
index.html:121   - Press P/E: Switch tool (no popup)
index.html:122   - Press P/E + drag: Adjust size/opacity
index.html:123 
index.html:124 🔧 Debug commands:
index.html:125   - testToolSizePopup("pen") or testToolSizePopup("eraser")
index.html:126   - window.ToolSizePopup.getDebugInfo()
core-runtime.js:689 ✅ ExportSystem initialized (PNG/APNG/GIF/WebP)
ui-panels.js:165 [UIController] Tool button clicked: pen-tool
ui-panels.js:200 [UIController] Tool clicked: pen-tool iconClickMode: true
ui-panels.js:208 [UIController] Showing tool size popup for pen
ui-panels.js:146 [UIController] showToolSizePopup called for: pen
ui-panels.js:147 [UIController] ToolSizePopup exists: true
tool-size-popup.js:217 [ToolSizePopup] show() called for tool: pen
tool-size-popup.js:218 [ToolSizePopup] CONFIG exists: false
tool-size-popup.js:219 [ToolSizePopup] ToolSizeManager exists: false
tool-size-popup.js:222 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:33 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:36 [ToolSizePopup] CONFIG.toolSizePopup not found!
createPopupDOM @ tool-size-popup.js:36
tool-size-popup.js:224 Uncaught TypeError: Failed to execute 'appendChild' on 'Node': parameter 1 is not of type 'Node'.
ui-panels.js:165 [UIController] Tool button clicked: eraser-tool
ui-panels.js:200 [UIController] Tool clicked: eraser-tool iconClickMode: true
ui-panels.js:221 [UIController] Showing tool size popup for eraser
ui-panels.js:146 [UIController] showToolSizePopup called for: eraser
ui-panels.js:147 [UIController] ToolSizePopup exists: true
tool-size-popup.js:217 [ToolSizePopup] show() called for tool: eraser
tool-size-popup.js:218 [ToolSizePopup] CONFIG exists: false
tool-size-popup.js:219 [ToolSizePopup] ToolSizeManager exists: false
tool-size-popup.js:222 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:33 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:36 [ToolSizePopup] CONFIG.toolSizePopup not found!
createPopupDOM @ tool-size-popup.js:36
tool-size-popup.js:224 Uncaught TypeError: Failed to execute 'appendChild' on 'Node': parameter 1 is not of type 'Node'.
ui-panels.js:165 [UIController] Tool button clicked: eraser-tool
ui-panels.js:200 [UIController] Tool clicked: eraser-tool iconClickMode: true
ui-panels.js:221 [UIController] Showing tool size popup for eraser
ui-panels.js:146 [UIController] showToolSizePopup called for: eraser
ui-panels.js:147 [UIController] ToolSizePopup exists: true
tool-size-popup.js:217 [ToolSizePopup] show() called for tool: eraser
tool-size-popup.js:218 [ToolSizePopup] CONFIG exists: false
tool-size-popup.js:219 [ToolSizePopup] ToolSizeManager exists: false
tool-size-popup.js:222 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:33 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:36 [ToolSizePopup] CONFIG.toolSizePopup not found!
createPopupDOM @ tool-size-popup.js:36
tool-size-popup.js:224 Uncaught TypeError: Failed to execute 'appendChild' on 'Node': parameter 1 is not of type 'Node'.
ui-panels.js:165 [UIController] Tool button clicked: resize-tool
ui-panels.js:200 [UIController] Tool clicked: resize-tool iconClickMode: true
ui-panels.js:165 [UIController] Tool button clicked: resize-tool
ui-panels.js:200 [UIController] Tool clicked: resize-tool iconClickMode: true
testToolSizePopup("pen")    // ペン用ポップアップ
testToolSizePopup("eraser") // 消しゴム用ポップアップ
index.html:103 === Testing Tool Size Popup ===
index.html:104 ToolSizePopup exists: true
index.html:105 ToolSizeManager exists: false
index.html:106 CONFIG exists: false
index.html:107 EventBus exists: false
index.html:110 Debug info: {popupExists: false, isVisible: null, currentTool: null, slotElementsCount: 0, hasSlider: false, …}
index.html:111 Calling forceShow...
tool-size-popup.js:255 [ToolSizePopup] Force showing popup for: pen
tool-size-popup.js:217 [ToolSizePopup] show() called for tool: pen
tool-size-popup.js:218 [ToolSizePopup] CONFIG exists: false
tool-size-popup.js:219 [ToolSizePopup] ToolSizeManager exists: false
tool-size-popup.js:222 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:33 [ToolSizePopup] Creating popup DOM...
tool-size-popup.js:36 [ToolSizePopup] CONFIG.toolSizePopup not found!
createPopupDOM @ tool-size-popup.js:36
show @ tool-size-popup.js:223
forceShow @ tool-size-popup.js:256
window.testToolSizePopup @ index.html:112
(anonymous) @ VM83:1
tool-size-popup.js:224 Uncaught TypeError: Failed to execute 'appendChild' on 'Node': parameter 1 is not of type 'Node'.
    at show (tool-size-popup.js:224:21)
    at Object.forceShow (tool-size-popup.js:256:5)
    at window.testToolSizePopup (index.html:112:46)
    at <anonymous>:1:1
show @ tool-size-popup.js:224
forceShow @ tool-size-popup.js:256
window.testToolSizePopup @ index.html:112
(anonymous) @ VM83:1
window.ToolSizePopup.getDebugInfo()
{popupExists: false, isVisible: null, currentTool: null, slotElementsCount: 0, hasSlider: false, …}
window.ToolSizeManager.getState('pen')
window.ToolSizeManager.getState('eraser')
VM91:1 Uncaught TypeError: Cannot read properties of undefined (reading 'getState')
    at <anonymous>:1:24
(anonymous) @ VM91:1
window.EventBus._listeners // イベントリスナー一覧
VM95:1 Uncaught TypeError: Cannot read properties of undefined (reading '_listeners')
    at <anonymous>:1:17
(anonymous) @ VM95:1