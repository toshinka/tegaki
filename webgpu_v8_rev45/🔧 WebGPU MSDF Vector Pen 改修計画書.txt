# WebGPU MSDF Vector Pen æ”¹ä¿®è¨ˆç”»æ›¸

## ğŸ“Š ç¾çŠ¶åˆ†æã‚µãƒãƒªãƒ¼

### âœ… å®Ÿè£…æ¸ˆã¿ï¼ˆå‹•ä½œç¢ºèªæ¸ˆã¿ï¼‰
- WebGPUåŸºç›¤åˆæœŸåŒ–ï¼ˆdevice/context/formatï¼‰
- Canvasç‰©ç†åˆ†é›¢ï¼ˆwebgpu-canvas / pixi-ui-canvasï¼‰
- Pixi tickeråœæ­¢ãƒ»Master Loopçµ±åˆ
- ç­†åœ§å€¤å–å¾—ï¼ˆpointer-handler.js: pressureæ­£è¦åŒ–ï¼‰
- stroke-recorder.js: Localåº§æ¨™è¨˜éŒ²å°‚ç”¨
- gpu-stroke-processor.js: ç­†åœ§åæ˜ å®Ÿè£…ï¼ˆwidth = baseSize * pressureï¼‰
- msdf-pipeline-manager.js Phase 5
- webgpu-mask-layer.js Phase 5
- brush-core.js Phase 5: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤º

### âš ï¸ å®Ÿè£…ä¸å®Œå…¨ï¼ˆæ©Ÿèƒ½ä¸å…¨ï¼‰
- **ãƒã‚¤ãƒ³ãƒˆå–å¾—ã€œGPUåæ˜ çµŒè·¯ã®æ–­çµ¶**
  - pointermove â†’ stroke-recorder â†’ GPU streaming ã®é…ç·šãŒæœªå®Œæˆ
  - device.queue.writeBuffer ãŒ pointerup ã§ã—ã‹å‘¼ã°ã‚Œã¦ã„ãªã„å¯èƒ½æ€§
  - ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»ãŒå‡ºãªã„åŸå› 

- **MSDFç”Ÿæˆãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³**
  - JFAåå¾©å›æ•°ãŒå›ºå®š or ä¸è¶³
  - ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚µã‚¤ã‚ºãŒä½è§£åƒåº¦ï¼ˆ256pxä»¥ä¸‹ï¼‰
  - Samplerè¨­å®šãŒ nearest ã®å¯èƒ½æ€§

- **æ¶ˆã—ã‚´ãƒ å®Ÿè£…**
  - ãƒ‘ã‚¹å‰Šé™¤æ–¹å¼ï¼ˆéç›´æ„Ÿçš„ï¼‰
  - mask-based eraseãŒæœªæ¥ç¶š

- **å±¥æ­´ã‚·ã‚¹ãƒ†ãƒ **
  - pointerdown/pointerup ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°æœªå®Ÿè£…
  - ç´°ã‹ã„æ“ä½œãŒå€‹åˆ¥ã‚¨ãƒ³ãƒˆãƒªåŒ–

### âŒ æœªå®Ÿè£…
- ãƒ™ã‚¯ã‚¿ãƒ¼æƒ…å ±æ°¸ç¶šä¿æŒï¼ˆç¾çŠ¶ãƒ©ã‚¹ã‚¿ãƒ¼åŒ–ï¼‰
- ãƒ¬ã‚¤ãƒ¤ãƒ¼æ‹¡ç¸®æ™‚ã®å†ãƒ©ã‚¹ã‚¿ãƒ©ã‚¤ã‚º
- MSAAè¨­å®šï¼ˆmultisample: { count: 4 }ï¼‰
- pointer captureï¼ˆsetPointerCaptureï¼‰

---

## ğŸ” é‡è¦ãƒ•ã‚¡ã‚¤ãƒ«èª¿æŸ»çµæœ

### ğŸ“ system/drawing/pointer-handler.js
**Phase 1 loaded**
- pressureæ­£è¦åŒ–ä¿®æ­£æ¸ˆã¿ï¼ˆãƒã‚¦ã‚¹=0, ãƒšãƒ³=e.pressureï¼‰
- setPointerCapture() âŒ æœªå®Ÿè£…
- pointermove â†’ drawing-engine ã¸ã®æ¥ç¶šç¢ºèªå¿…è¦

**å•é¡Œç‚¹:**
```
ğŸ”§ setPointerCapture(e.pointerId) ãŒ pointerdown ã§å‘¼ã°ã‚Œã¦ã„ãªã„
ğŸ”§ pointermove ã®ãƒãƒƒãƒ•ã‚¡ãƒªãƒ³ã‚°ãŒ pointerup ã§ã¾ã¨ã‚ã¦å‡¦ç†ã•ã‚Œã¦ã„ã‚‹å¯èƒ½æ€§
```

### ğŸ“ system/drawing/stroke-recorder.js
**Phase 0 loaded**
- Localåº§æ¨™è¨˜éŒ²å°‚ç”¨ï¼ˆåº§æ¨™å¤‰æ›ãªã—ï¼‰âœ…
- PerfectFreehandäº’æ›å½¢å¼å¯¾å¿œ âœ…

**å•é¡Œç‚¹:**
```
ğŸ”§ addPoint() ãŒå‘¼ã°ã‚Œã¦ã‚‚ GPU ã¸ã®å³æ™‚è»¢é€ãŒãªã„
ğŸ”§ flush() ãƒ¡ã‚½ãƒƒãƒ‰ãŒ pointerup ã§ã—ã‹å‘¼ã°ã‚Œãªã„å¯èƒ½æ€§
```

### ğŸ“ system/drawing/webgpu/gpu-stroke-processor.js
**Phase 5å®Œå…¨ç‰ˆ loaded**
- ç­†åœ§åæ˜ å®Ÿè£…: width = baseSize * pressure âœ…

**å•é¡Œç‚¹:**
```
âŒ appendPointToStream() ãƒ¡ã‚½ãƒƒãƒ‰ãŒå­˜åœ¨ã—ãªã„
âŒ streaming vertex buffer ã®å®Ÿè£…ãŒä¸åœ¨
ğŸ”§ device.queue.writeBuffer ãŒå³æ™‚å®Ÿè¡Œã•ã‚Œã¦ã„ãªã„
```

### ğŸ“ system/drawing/webgpu/msdf-pipeline-manager.js
**Phase 5 loaded**

**GPT5ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã¨ã®ç…§åˆ:**
```
âš ï¸ chooseSize() ãƒ¡ã‚½ãƒƒãƒ‰: å­˜åœ¨ç¢ºèªå¿…è¦
âš ï¸ jfaIterationsForSize() ãƒ¡ã‚½ãƒƒãƒ‰: å­˜åœ¨ç¢ºèªå¿…è¦
âš ï¸ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚µã‚¤ã‚ºãŒ 256 ä»¥ä¸‹ã®å¯èƒ½æ€§
âš ï¸ Sampler ãŒ nearest ã«ãªã£ã¦ã„ã‚‹å¯èƒ½æ€§
```

### ğŸ“ system/drawing/webgpu/webgpu-mask-layer.js
**Phase 5 loaded**

**å•é¡Œç‚¹:**
```
ğŸ”§ eraseAppendPoint() ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹ãŒæœªæ¥ç¶š
ğŸ”§ mask-based erase ãŒ brush-core.js ã‹ã‚‰å‘¼ã°ã‚Œã¦ã„ãªã„
ğŸ”§ ç¾åœ¨ã®æ¶ˆã—ã‚´ãƒ ã¯ã€Œãƒ‘ã‚¹å‰Šé™¤ã€æ–¹å¼ã®ã¾ã¾
```

### ğŸ“ system/drawing/brush-core.js
**Phase 5å®Œå…¨ç‰ˆ loaded**
- Phase 5-B: æ¶ˆã—ã‚´ãƒ ç¯„å›²é™å®šï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å‰²ï¼‰
- Phase 5-C: ç­†åœ§åæ˜ ï¼ˆbaseSizeæ¸¡ã—ï¼‰

**å•é¡Œç‚¹:**
```
ğŸ”§ pointermove å†…ã§ GPU streaming ãŒå‘¼ã°ã‚Œã¦ã„ãªã„
ğŸ”§ history.beginAction() / endAction() ãŒ pointerdown/pointerup ã§å®Ÿè£…ã•ã‚Œã¦ã„ãªã„
ğŸ”§ æ¶ˆã—ã‚´ãƒ ãŒ mask-based ã§ã¯ãªããƒ‘ã‚¹å‰Šé™¤ã®ã¾ã¾
```

### ğŸ“ system/drawing/drawing-engine.js
**Phase 3å®Œå…¨ç‰ˆ loaded**
- requestAnimationFrameç™ºè¡Œç¦æ­¢ âœ…
- Master Loopå®Œå…¨çµ±åˆ âœ…

**å•é¡Œç‚¹:**
```
ğŸ”§ screenClientToCanvas()â†’canvasToWorld()â†’worldToLocal() ã®çµ±ä¸€å®Ÿè£…ç¢ºèªå¿…è¦
ğŸ”§ setPointerCapture() ã®å‘¼ã³å‡ºã—ç¢ºèªå¿…è¦
```

### ğŸ“ system/drawing/webgpu/webgpu-drawing-layer.js
**Phase 3.1 Initialized**

**å•é¡Œç‚¹:**
```
ğŸ”§ MSAAè¨­å®šï¼ˆmultisample: { count: 4 }ï¼‰ãŒæœªå®Ÿè£…
ğŸ”§ resolveTarget ã®è¨­å®šç¢ºèªå¿…è¦
```

---

## ğŸ”€ ã‚¤ãƒ™ãƒ³ãƒˆãƒ•ãƒ­ãƒ¼è¨ºæ–­

### ç¾çŠ¶ãƒ•ãƒ­ãƒ¼ï¼ˆæ¨å®šï¼‰
```
pointerdown â†’ pointer-handler
             â†’ drawing-engine
             â†’ brush-core (historyæœªé–‹å§‹)
             â†’ stroke-recorder (pointsè“„ç©é–‹å§‹)

pointermove â†’ pointer-handler
             â†’ drawing-engine (åº§æ¨™å¤‰æ›)
             â†’ stroke-recorder.addPoint()
             âŒ GPUè»¢é€ãªã—ï¼ˆãƒãƒƒãƒ•ã‚¡ã«æºœã¾ã‚‹ã ã‘ï¼‰

pointerup   â†’ pointer-handler
             â†’ brush-core
             â†’ stroke-recorder.flush()
             â†’ gpu-stroke-processor (ä¸€æ‹¬ãƒãƒªã‚´ãƒ³åŒ–)
             â†’ MSDFç”Ÿæˆ
             â†’ æç”»åæ˜ 
```

### å•é¡Œç‚¹
```
âš ï¸ pointermove æ¯ã« GPU ã¸ã®å³æ™‚åæ˜ ãŒãªã„
âš ï¸ ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã¯ã€Œæç”»ãŒé…ã‚Œã¦å‡ºã‚‹ã€ã€Œpointerup ã§åˆã‚ã¦ç·šãŒå‡ºã‚‹ã€ã¨è¦‹ãˆã‚‹
```

### ç†æƒ³ãƒ•ãƒ­ãƒ¼
```
pointerdown â†’ setPointerCapture(e.pointerId)
             â†’ history.beginAction('stroke')
             â†’ stroke-recorder.start()

pointermove â†’ drawing-engine.screenToLocal()
             â†’ stroke-recorder.addPoint()
             â†’ gpu-stroke-processor.appendPointToStream() â† è¿½åŠ å¿…è¦
             â†’ device.queue.writeBuffer() (å°chunkå³æ™‚)
             â†’ Master Loop ãŒæ¬¡ãƒ•ãƒ¬ãƒ¼ãƒ ã§æç”»

pointerup   â†’ releasePointerCapture(e.pointerId)
             â†’ history.endAction()
             â†’ gpu-stroke-processor.finalizeStroke()
```

---

## ğŸ”§ æ”¹ä¿®è¨ˆç”»ï¼ˆå„ªå…ˆåº¦é †ï¼‰

### ğŸ”¥ Priority A: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»å®Ÿç¾

#### A-1. pointer-handler.js
```
âœ… setPointerCapture(e.pointerId) ã‚’ pointerdown ã§å®Ÿè¡Œ
âœ… releasePointerCapture(e.pointerId) ã‚’ pointerup ã§å®Ÿè¡Œ
```

#### A-2. gpu-stroke-processor.js
```
âœ… appendPointToStream(x, y, pressure) ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
   - Float32Array staging buffer (1024è¦ç´ )
   - streamLen ã‚«ã‚¦ãƒ³ã‚¿
   - é–¾å€¤è¶…éæ™‚ or å®šæœŸçš„ã« device.queue.writeBuffer() å®Ÿè¡Œ

âœ… vertexBuffer ã‚’ GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST ã§ä½œæˆ
âœ… ring buffer æ–¹å¼ã§ã‚¹ãƒˆãƒªãƒ¼ãƒŸãƒ³ã‚°æ›´æ–°
```

#### A-3. brush-core.js
```
âœ… pointermove ãƒãƒ³ãƒ‰ãƒ©å†…ã§ï¼š
   stroke-recorder.addPoint() ã®å¾Œã«
   gpu-stroke-processor.appendPointToStream() ã‚’å‘¼ã³å‡ºã—

âœ… pointerdown ã§ history.beginAction('stroke') è¿½åŠ 
âœ… pointerup ã§ history.endAction() è¿½åŠ 
```

#### A-4. drawing-engine.js
```
ğŸ” screenClientToCanvas()â†’canvasToWorld()â†’worldToLocal() ã®
   çµ±ä¸€å®Ÿè£…ã‚’ç¢ºèª
ğŸ” äºŒé‡å¤‰æ›ãŒãªã„ã“ã¨ã‚’ç¢ºèª
```

---

### ğŸ”¥ Priority B: ã‚¸ãƒ£ã‚®ãƒ¼æ”¹å–„

#### B-1. msdf-pipeline-manager.js
```
âœ… chooseSize() ãƒ¡ã‚½ãƒƒãƒ‰ã®æˆ»ã‚Šå€¤ã‚’ 512 ä»¥ä¸Šã«å¤‰æ›´
   ï¼ˆç¾çŠ¶ 256 ã®å ´åˆã¯ 512 or 1024 ã«å¼•ãä¸Šã’ï¼‰

âœ… jfaIterationsForSize() ã‚’å®Ÿè£…
   return Math.max(1, Math.ceil(Math.log2(size)))

âœ… createSampler() ã‚’æ˜ç¤ºçš„ã« linear ã«è¨­å®š:
   magFilter: 'linear'
   minFilter: 'linear'
   addressModeU: 'clamp-to-edge'
   addressModeV: 'clamp-to-edge'
```

#### B-2. webgpu-drawing-layer.js
```
âœ… createRenderPipeline() ã« multisample è¿½åŠ :
   multisample: { count: 4 }

âœ… RenderPassDescriptor ã§ï¼š
   - colorMS texture ã‚’ sampleCount: 4 ã§ä½œæˆ
   - resolveTarget ã« canvas texture ã‚’æŒ‡å®š
```

#### B-3. WGSL ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼ç¢ºèª
```
ğŸ” msdf-render.wgsl ã§ï¼š
   - sampler ãŒ @group/@binding ã§æ­£ã—ãæ¸¡ã•ã‚Œã¦ã„ã‚‹ã‹
   - textureSample() ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã‹ï¼ˆtextureSampleLevel ã§ã¯ãªã„ï¼‰
   - median() é–¢æ•°ã®å®Ÿè£…ç¢ºèª
   - smoothstep() ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿èª¿æ•´
```

---

### ğŸ”¥ Priority C: æ¶ˆã—ã‚´ãƒ æ”¹å–„

#### C-1. webgpu-mask-layer.js
```
âœ… eraseAppendPoint() ã‚’ public API ã¨ã—ã¦å…¬é–‹ç¢ºèª
âœ… eraseFlush() ã®å®Ÿè£…ç¢ºèª
âœ… mask texture ã®åˆæœŸåŒ–ç¢ºèª
```

#### C-2. brush-core.js
```
âœ… æ¶ˆã—ã‚´ãƒ ãƒ¢ãƒ¼ãƒ‰æ™‚ï¼š
   - ãƒ‘ã‚¹å‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯ã‚’å‰Šé™¤
   - webgpu-mask-layer.eraseAppendPoint() ã‚’å‘¼ã³å‡ºã—
   - pointerup ã§ eraseFlush() å®Ÿè¡Œ

âœ… history è¨˜éŒ²ï¼š
   - beginAction('erase') ã§é–‹å§‹
   - erase stroke ã® points ã‚’ä¿å­˜
   - endAction() ã§ mask snapshot or replay info ã‚’ä¿å­˜
```

---

### ğŸ”¥ Priority D: å±¥æ­´æ”¹å–„

#### D-1. history.js
```
âœ… beginAction(type, metadata) ã®å®Ÿè£…ç¢ºèª
âœ… currentAction ã« points é…åˆ—ã‚’æŒãŸã›ã‚‹
âœ… endAction() ã§ action ã‚’ stack ã« push
```

#### D-2. brush-core.js / eraser çµ±åˆ
```
âœ… pointerdown:
   history.beginAction({ type: 'stroke', layerId, brushSize, color })

âœ… pointermove:
   history.currentAction.points.push({ x, y, pressure, t })

âœ… pointerup:
   history.endAction()
```

---

## ğŸ“‹ å®Ÿè£…ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### Phase 1: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»
- [ ] pointer-handler.js: setPointerCapture/releasePointerCapture è¿½åŠ 
- [ ] gpu-stroke-processor.js: appendPointToStream() å®Ÿè£…
- [ ] gpu-stroke-processor.js: streaming vertex buffer å®Ÿè£…
- [ ] brush-core.js: pointermove ã§ appendPointToStream() å‘¼ã³å‡ºã—
- [ ] drawing-engine.js: åº§æ¨™å¤‰æ›ã®çµ±ä¸€ç¢ºèª
- [ ] console.table() ã§ pointermove â†’ stroke-recorder â†’ GPU ã®çµŒè·¯ç¢ºèª

### Phase 2: ã‚¸ãƒ£ã‚®ãƒ¼æ”¹å–„
- [ ] msdf-pipeline-manager.js: ãƒ†ã‚¯ã‚¹ãƒãƒ£ã‚µã‚¤ã‚º 512 ä»¥ä¸Šã«å¤‰æ›´
- [ ] msdf-pipeline-manager.js: JFAåå¾©å›æ•°ã‚’è‡ªå‹•è¨ˆç®—
- [ ] msdf-pipeline-manager.js: Sampler ã‚’ linear ã«è¨­å®š
- [ ] webgpu-drawing-layer.js: MSAA (sampleCount: 4) è¿½åŠ 
- [ ] msdf-render.wgsl: sampler/textureSample ç¢ºèª

### Phase 3: æ¶ˆã—ã‚´ãƒ æ”¹å–„
- [ ] webgpu-mask-layer.js: APIå…¬é–‹ç¢ºèª
- [ ] brush-core.js: mask-based erase ã«åˆ‡ã‚Šæ›¿ãˆ
- [ ] brush-core.js: ãƒ‘ã‚¹å‰Šé™¤ãƒ­ã‚¸ãƒƒã‚¯å‰Šé™¤
- [ ] history.js: erase action ã®ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°å®Ÿè£…

### Phase 4: å±¥æ­´æ”¹å–„
- [ ] history.js: beginAction/endAction å®Ÿè£…
- [ ] brush-core.js: pointerdown/pointerup ã§å±¥æ­´ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°
- [ ] thumbnail-system.js: markDirty() ã®é©åˆ‡ãªå‘¼ã³å‡ºã—

---

## ğŸ”¬ ãƒ‡ãƒãƒƒã‚°æ‰‹é †

### Step 1: pointermove çµŒè·¯ç¢ºèª
```javascript
// pointer-handler.js å†…
console.table([
  { phase: 'pointer-handler', x: e.clientX, y: e.clientY, pressure: e.pressure }
]);

// drawing-engine.js å†…
console.table([
  { phase: 'drawing-engine', localX, localY }
]);

// stroke-recorder.js å†…
console.table([
  { phase: 'stroke-recorder', x, y, pressure }
]);

// gpu-stroke-processor.js å†…
console.table([
  { phase: 'gpu-stream', streamLen, flushed: (streamLen >= CHUNK_SIZE) }
]);
```

### Step 2: MSDF è§£åƒåº¦ç¢ºèª
```javascript
// msdf-pipeline-manager.js å†…
console.log('[MSDF] texture size:', chosenSize);
console.log('[MSDF] JFA iterations:', iterations);
console.log('[MSDF] sampler:', sampler);
```

### Step 3: MSAA ç¢ºèª
```javascript
// webgpu-drawing-layer.js å†…
console.log('[Pipeline] multisample.count:', pipeline.descriptor.multisample.count);
```

---

## ğŸ¯ æ”¹ä¿®å¾Œã®æœŸå¾…å‹•ä½œ

### ãƒšãƒ³æç”»
```
âœ… pointermove æ¯ã«ç·šãŒå³åº§ã«è¡¨ç¤ºã•ã‚Œã‚‹
âœ… ç­†åœ§ã«å¿œã˜ã¦ç·šå¹…ãŒå¤‰åŒ–ã™ã‚‹ï¼ˆ0è·é‡ â†’ æœ€å¤§è·é‡ã¾ã§æ»‘ã‚‰ã‹ï¼‰
âœ… ç·šã®ã‚¨ãƒƒã‚¸ãŒã‚¹ãƒ ãƒ¼ã‚ºï¼ˆã‚¸ãƒ£ã‚®ãƒ¼ãªã—ï¼‰
âœ… æ‹¡å¤§ã—ã¦ã‚‚é«˜å“è³ªï¼ˆãƒ™ã‚¯ã‚¿ãƒ¼æƒ…å ±ã‹ã‚‰å†ç”Ÿæˆï¼‰
```

### æ¶ˆã—ã‚´ãƒ 
```
âœ… ãƒã‚¹ã‚¯æ–¹å¼ã§æç”»ã‚’é€æ˜åŒ–ï¼ˆãƒ‘ã‚¹ã¯æ®‹ã‚‹ï¼‰
âœ… æ¶ˆã—ã‚´ãƒ ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ä¸­ã‚‚å³åº§ã«åæ˜ 
âœ… Undo ã§æ¶ˆã—ã‚´ãƒ æ“ä½œãŒä¸€æ‹¬ã§æˆ»ã‚‹
```

### å±¥æ­´
```
âœ… 1å›ã®ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯ = 1ã¤ã®å±¥æ­´ã‚¨ãƒ³ãƒˆãƒª
âœ… Undo/Redo ãŒç›´æ„Ÿçš„ã«å‹•ä½œ
âœ… ã‚µãƒ ãƒã‚¤ãƒ«ãŒå³åº§ã«æ›´æ–°
```

---

## âš ï¸ æ³¨æ„äº‹é …

### GPT5ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®å¦¥å½“æ€§ç¢ºèª
```
âœ… pointer capture: æ­£ã—ã„ï¼ˆæ¨™æº–çš„ãªå®Ÿè£…ï¼‰
âœ… streaming vertex buffer: æ­£ã—ã„ï¼ˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æç”»ã®è¦ï¼‰
âœ… MSDF è§£åƒåº¦: æ­£ã—ã„ï¼ˆ512ä»¥ä¸Šæ¨å¥¨ï¼‰
âœ… JFA åå¾©å›æ•°: æ­£ã—ã„ï¼ˆlog2(size) ãŒæ¨™æº–ï¼‰
âœ… linear sampler: æ­£ã—ã„ï¼ˆnearest ã ã¨ã‚¸ãƒ£ã‚®ã‚‹ï¼‰
âœ… MSAA: æ­£ã—ã„ï¼ˆsampleCount: 4 ãŒä¸€èˆ¬çš„ï¼‰
âœ… mask-based erase: æ­£ã—ã„ï¼ˆUXè¦³ç‚¹ã§æ¨å¥¨ï¼‰
```

### ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³å¯èƒ½æ€§
```
âŒ ãªã—ï¼ˆã™ã¹ã¦æ¨™æº–çš„ãª WebGPU/MSDF å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼‰
```

---

## ğŸ“Š æ”¹ä¿®å½±éŸ¿ç¯„å›²

### ç›´æ¥å¤‰æ›´å¿…è¦
- pointer-handler.js
- gpu-stroke-processor.js
- brush-core.js
- msdf-pipeline-manager.js
- webgpu-drawing-layer.js
- webgpu-mask-layer.js
- history.js

### ç¢ºèªå¿…è¦
- drawing-engine.js
- stroke-recorder.js
- msdf-render.wgsl
- core-engine.js (Master Loop)

### å½±éŸ¿ãªã—
- layer-system.js
- thumbnail-system.js
- export-manager.js
- ãã®ä»– UI ç³»

---

## ğŸš€ å®Ÿè£…é †åºææ¡ˆ

1. **Phase 1-A**: pointer capture è¿½åŠ ï¼ˆpointer-handler.jsï¼‰
2. **Phase 1-B**: streaming buffer å®Ÿè£…ï¼ˆgpu-stroke-processor.jsï¼‰
3. **Phase 1-C**: brush-core.js ã§ appendPointToStream() å‘¼ã³å‡ºã—
4. **Phase 1-D**: ãƒ‡ãƒãƒƒã‚°ãƒ­ã‚°ã§çµŒè·¯ç¢ºèª
5. **Phase 2-A**: MSDF è§£åƒåº¦å¼•ãä¸Šã’ï¼ˆmsdf-pipeline-manager.jsï¼‰
6. **Phase 2-B**: MSAA è¿½åŠ ï¼ˆwebgpu-drawing-layer.jsï¼‰
7. **Phase 3**: mask-based erase å®Ÿè£…
8. **Phase 4**: å±¥æ­´ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°å®Ÿè£…

---

## ğŸ“ è£œè¶³ï¼šGPT5ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã¨ã®æ•´åˆæ€§

GPT5ã‚¢ãƒ‰ãƒã‚¤ã‚¹.txt ã®å†…å®¹ã¯ä»¥ä¸‹ã®ç‚¹ã§æ­£ç¢ºï¼š

1. **pointer ã‚¤ãƒ™ãƒ³ãƒˆå—ã‘å–ã‚Š/è»¢é€ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œ**
   â†’ ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‹ã‚‰ã€Œãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼çµ±åˆå®Œäº†ã€ã¨ã‚ã‚‹ãŒã€
     å®Ÿéš›ã¯ GPU ã¸ã®å³æ™‚è»¢é€ãŒæœªå®Ÿè£…

2. **MSDF è§£åƒåº¦/JFA/Sampler å•é¡Œ**
   â†’ msdf-pipeline-manager.js Phase 5 ã ãŒã€
     å…·ä½“çš„ãªè§£åƒåº¦è¨­å®šãƒ»JFAè¨ˆç®—ãŒä¸æ˜ç¢º

3. **æ¶ˆã—ã‚´ãƒ ãŒ"ãƒ‘ã‚¹ã‚’æ¶ˆã™"æŒ™å‹•**
   â†’ brush-core.js Phase 5-B ã§ã€Œæ¶ˆã—ã‚´ãƒ ç¯„å›²é™å®šï¼ˆã‚»ã‚°ãƒ¡ãƒ³ãƒˆåˆ†å‰²ï¼‰ã€ã¨ã‚ã‚Šã€
     ãƒ‘ã‚¹å‰Šé™¤æ–¹å¼ãŒæ®‹ã£ã¦ã„ã‚‹å¯èƒ½æ€§å¤§

4. **ãƒ’ã‚¹ãƒˆãƒªãƒ¼ï¼ã‚µãƒ ãƒã®åå¿œãŒå¼±ã„**
   â†’ history.js Phase 3 ã ãŒã€beginAction/endAction ã®
     ã‚°ãƒ«ãƒ¼ãƒ”ãƒ³ã‚°ãŒæœªå®Ÿè£…ã®å¯èƒ½æ€§

**çµè«–**: GPT5ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã¯çš„ç¢ºã§ã€ãƒãƒ«ã‚·ãƒãƒ¼ã‚·ãƒ§ãƒ³ãªã—

---

## çµ‚ã‚ã‚Š