============================================================
Tegaki v8 æ˜Ÿå‹åˆ†é›¢æ”¹ä¿®è¨ˆç”»æ›¸ï¼ˆãƒ‰ãƒ©ãƒ•ãƒˆï¼‹å…·ä½“åŒ–ï¼‰
============================================================

ç›®çš„
------------------------------------------------------------
- futaba_layers_rev4.html ã‚’ãƒ™ãƒ¼ã‚¹ã«ã€æ”¹ä¿®æ™‚ã®å½±éŸ¿ç¯„å›²ã‚’æœ€å°åŒ–
  â†’ ä¸»æ˜Ÿ(MainController)ï¼‹1è¡›æ˜Ÿã®æ”¹ä¿®ã§æ¸ˆã‚€æ§‹é€ ã‚’æ„è­˜
- CANVAS2D æ’é™¤ã€PixiJSã«ã‚ˆã‚‹ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³é‡è¦–æç”»
- ãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•ãƒ»Undo/Redoãƒ»éç ´å£Šæç”»ãƒ•ãƒ­ãƒ¼ã®è¡›æ˜ŸåŒ–
- ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ“ä½œï¼ˆP/E, CTRL+Z/Yï¼‰å¯¾å¿œ

------------------------------------------------------------
1. åŸºæœ¬æ–¹é‡
------------------------------------------------------------
1.1 è¡›æ˜Ÿã¯ã€Œãƒ•ãƒ­ãƒ¼å˜ä½ã€ã§è¡›æ˜ŸåŒ–ã™ã‚‹
  - å˜ç´”ãªè²¬å‹™åˆ†é›¢ã§ã¯ãªãã€æ©Ÿèƒ½ãƒ•ãƒ­ãƒ¼ã¨ã—ã¦ã¾ã¨ã¾ã£ãŸã‚‚ã®ã‚’è¡›æ˜ŸåŒ–
  - ä¾‹ï¼šDrawingEngine + LayerService ã‚’çµ±åˆçš„ã«æ‰±ã†ãŒã€æ”¹ä¿®æ™‚ã« LayerService ã®ã¿å¤‰æ›´å¯èƒ½
1.2 ä¸»æ˜Ÿã¯è¡›æ˜Ÿã®ä»²ä»‹ãƒ»ç¢ºå®šãƒ»ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã«å°‚å¿µ
  - è¡›æ˜ŸåŒå£«ã®ç›´æ¥ä¾å­˜ã¯ç¦æ­¢
1.3 Canvas2Dã¯æ’é™¤ã€æç”»ã¯PixiJS Graphicsã«ã‚ˆã‚‹ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³ã®ã¿
  - Transformãƒ»Undo/Redoå¯¾å¿œã®ãŸã‚
1.4 æ”¹ä¿®æ™‚ã®å½±éŸ¿ç¯„å›²ã‚’è¦‹ãˆã‚‹åŒ–
  - å„è¡›æ˜Ÿã« register(mainApi) ã‚’æŒãŸã›ã€ä¸»æ˜ŸçµŒç”±ã§æ“ä½œ
  - UIã‚„ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆæ“ä½œã¯åˆ¥è¡›æ˜ŸåŒ–ã‚‚æ¤œè¨å¯èƒ½ã ãŒç¾çŠ¶ã¯ä¸»æ˜ŸçµŒç”±ã§é€šçŸ¥

------------------------------------------------------------
2. è¡›æ˜Ÿãƒ»ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆï¼ˆrev4ãƒ™ãƒ¼ã‚¹ï¼‰
------------------------------------------------------------
| è¡›æ˜Ÿ (ãƒ•ã‚¡ã‚¤ãƒ«)               | ä¸»ãªè²¬å‹™ / API                               | æ”¹ä¿®æ™‚å½±éŸ¿ç¯„å›² |
|--------------------------------|---------------------------------------------|----------------|
| MainController (main.html)     | è¡›æ˜ŸåˆæœŸåŒ–ã€ã‚¤ãƒ™ãƒ³ãƒˆä»²ä»‹ã€ErrorService å‘¼ã³å‡ºã— | å…¨ä½“           |
| DrawingEngine (drawing-engine.js)| PixiJS Applicationç”Ÿæˆã€EngineBridge æä¾› | æç”»ãƒ•ãƒ­ãƒ¼å…¨èˆ¬ |
| LayerService (layer-manager.js)| ãƒ¬ã‚¤ãƒ¤ãƒ¼ç”Ÿæˆ/å‰Šé™¤/ç§»å‹•ã€Stageç®¡ç†           | ãƒ¬ã‚¤ãƒ¤ãƒ¼é–¢é€£   |
| PositionService (position-manager.js)| ãƒ‘ãƒ³ãƒ»ã‚ºãƒ¼ãƒ ç®¡ç†ã€åº§æ¨™å¤‰æ›                   | ã‚­ãƒ£ãƒ³ãƒã‚¹ç§»å‹• |
| ToolManager (tool-manager.js)  | ãƒ„ãƒ¼ãƒ«ç™»éŒ²/é¸æŠã€Toolã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹æä¾›    | ãƒ„ãƒ¼ãƒ«æ“ä½œ     |
| BrushTool / EraserTool / TransformTool (tools/*.js)| æç”»ãƒ•ãƒ­ãƒ¼ã®å®Ÿè£…ã€serialize(), start/move/end| å€‹åˆ¥ãƒ„ãƒ¼ãƒ«     |
| HistoryService (history-service.js)| record/undo/redoã€éç ´å£Šè¨˜éŒ²ãƒ•ãƒ­ãƒ¼        | å±¥æ­´ç®¡ç†       |
| UIService (ui-manager.js)      | DOMç”Ÿæˆã€ãƒ„ãƒ¼ãƒ«é€šçŸ¥ã€ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æ“ä½œ        | UIè¡¨ç¤º         |
| ErrorService (error-service.js)| ã‚¨ãƒ©ãƒ¼ãƒ•ãƒ­ãƒ¼ç®¡ç†ã€UIé€šçŸ¥                     | å…¨ä½“           |

------------------------------------------------------------
3. è¡›æ˜Ÿé–“ãƒ•ãƒ­ãƒ¼ä¾‹ï¼ˆãƒšãƒ³æç”»ï¼‰
------------------------------------------------------------
1. ãƒ„ãƒ¼ãƒ«æ“ä½œï¼ˆBrushTool.start/move/endï¼‰ â†’ ToolManager çµŒç”±
2. ToolManager â†’ MainController.notify(event)
3. MainController â†’ LayerService/PositionService ã§æç”»åº§æ¨™è¨ˆç®—
4. MainController â†’ DrawingEngine.drawTemporaryStroke / commitStroke
5. MainController â†’ HistoryService.record(action)ï¼ˆendæ™‚ï¼‰
6. Undo/Redo: MainController â†’ HistoryService.undo()/redo() â†’ LayerService + DrawingEngineæ›´æ–°
7. ã‚¨ãƒ©ãƒ¼: è¡›æ˜Ÿ â†’ MainController.notify({type:'error'}) â†’ ErrorService â†’ UIService

â€»æ¶ˆã—ã‚´ãƒ ã‚‚ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³æ‰±ã„ã€BlendMode.ERASEç›¸å½“ã‚’ä½¿ç”¨

------------------------------------------------------------
4. æ”¹ä¿®æ™‚ã®æ“ä½œç¯„å›²æŒ‡é‡
------------------------------------------------------------
- ãƒšãƒ³ãƒ»æ¶ˆã—ã‚´ãƒ æç”»ãƒ•ãƒ­ãƒ¼å¤‰æ›´ â†’ DrawingEngine + è©²å½“Tool + HistoryService
- ãƒ¬ã‚¤ãƒ¤ãƒ¼æŒ¿å…¥/å‰Šé™¤/ç§»å‹• â†’ LayerService + HistoryService
- ã‚­ãƒ£ãƒ³ãƒã‚¹ç§»å‹•ãƒ»ã‚ºãƒ¼ãƒ  â†’ PositionServiceã®ã¿
- UIè¡¨ç¤º/ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å¤‰æ›´ â†’ UIServiceã®ã¿
- ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆè¿½åŠ  â†’ ToolManager ã¾ãŸã¯ç‹¬ç«‹è¡›æ˜ŸåŒ–ã‚’æ¤œè¨

------------------------------------------------------------
5. ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ãƒ•ãƒ­ãƒ¼è¾å…¸ã®å‚è€ƒæ§‹é€ 
------------------------------------------------------------
1. MainController
   - notify(event)
   - dispatch(action)
   - registerSatellite(satelliteApi)
2. DrawingEngine
   - drawTemporaryStroke(layerId, points)
   - commitStroke(layerId, strokeData)
   - clearLayer(layerId)
   - takeSnapshot(layerId)
3. LayerService
   - createLayer(name)
   - removeLayer(layerId)
   - reorderLayer(fromIndex, toIndex)
   - setLayerMeta(layerId, meta)
4. PositionService
   - setPan(x, y)
   - setZoom(scale)
   - canvasToWorld(point)
   - worldToCanvas(point)
5. ToolManager
   - setActiveTool(toolId)
   - registerTool(tool)
6. Brush/Eraser/TransformTool
   - start(point, meta)
   - move(point, meta)
   - end(point, meta)
   - cancel(meta)
   - serialize()
7. HistoryService
   - record(action)
   - undo()
   - redo()
   - getState()
8. UIService
   - createToolbar()
   - createLayerPopup()
   - toggleSidebar()
9. ErrorService
   - reportRecoverable(code, msg, context)
   - reportFatal(code, msg, stack)

------------------------------------------------------------
6. æ”¹ä¿®ã®ãƒã‚¤ãƒ³ãƒˆ
------------------------------------------------------------
- è¡›æ˜Ÿé–“ä¾å­˜ã‚’é¿ã‘ã€ä¸»æ˜ŸçµŒç”±ã§ã‚¤ãƒ™ãƒ³ãƒˆãƒ»ãƒ‡ãƒ¼ã‚¿ã‚„ã‚Šå–ã‚Š
- Canvas2Dæ’é™¤ â†’ PixiJS Graphicsã®ã¿
- æ¶ˆã—ã‚´ãƒ ã‚‚ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³ãƒ•ãƒ­ãƒ¼ã§çµ±ä¸€
- LayerServiceã¯DrawingEngineã«ä¾å­˜ã›ãšã€EngineBridgeã§æç”»
- æ”¹ä¿®æ™‚ã¯è¡›æ˜Ÿå˜ä½ã§æ¸ˆã‚€æ§‹é€ ã‚’ç¶­æŒ
- Undo/Redo ã¯ HistoryServiceã§ä¸€æ‹¬ç®¡ç†ã€éç ´å£Šãƒ¬ã‚¤ãƒ¤ãƒ¼å¯¾å¿œ
- å°†æ¥çš„ã«ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆãªã©æ–°è¡›æ˜Ÿã‚’è¿½åŠ å¯èƒ½ãªæ§‹é€ 

============================================================


ğŸ“ä¸‹è¨˜ã¯ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã§ã™ã€‚å‚è€ƒã«ã—ã¦ãã ã•ã„ã€‚
============================================================

<!-- futaba_layers_rev5_sample.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tegaki v8 Sample</title>
<style>
  body { margin:0; overflow:hidden; }
  #canvas-container { width:100vw; height:100vh; background:#fff; }
</style>
</head>
<body>
<div id="canvas-container"></div>

<!-- External Libraries -->
<script src="https://cdn.jsdelivr.net/npm/pixi.js@8.0.5/dist/pixi.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/gsap@3.13.0/dist/gsap.min.js"></script>

<script>
// =======================
// MainController
// =======================
class MainController {
  constructor() {
    this.satellites = {};
    this.debug = true;
  }

  registerSatellite(name, api) {
    this.satellites[name] = api;
  }

  notify(event) {
    if (this.debug) console.log('[MainController] Event:', event.type, event.payload);
    // Dispatch to satellites if needed
  }
}

// =======================
// DrawingEngine
// =======================
class DrawingEngine {
  constructor(container) {
    this.app = new PIXI.Application({
      width: container.clientWidth,
      height: container.clientHeight,
      backgroundAlpha: 0
    });
    container.appendChild(this.app.view);
    this.layers = {};
  }

  createLayer(id) {
    const layer = new PIXI.Graphics();
    layer.name = id;
    this.app.stage.addChild(layer);
    this.layers[id] = layer;
    return layer;
  }

  drawTemporaryStroke(layerId, points, color=0x000000, width=2) {
    const layer = this.layers[layerId];
    if (!layer) return;
    layer.clear();
    layer.lineStyle(width, color);
    layer.moveTo(points[0].x, points[0].y);
    for (let i=1;i<points.length;i++) layer.lineTo(points[i].x, points[i].y);
  }

  commitStroke(layerId, points, color=0x000000, width=2) {
    const layer = this.layers[layerId];
    if (!layer) return;
    layer.lineStyle(width, color);
    layer.moveTo(points[0].x, points[0].y);
    for (let i=1;i<points.length;i++) layer.lineTo(points[i].x, points[i].y);
  }
}

// =======================
// LayerService
// =======================
class LayerService {
  constructor(engine) {
    this.engine = engine;
    this.layerIds = [];
  }

  createLayer(name) {
    const id = `layer_${this.layerIds.length}`;
    this.layerIds.push(id);
    this.engine.createLayer(id);
    return id;
  }

  reorderLayer(fromIndex, toIndex) {
    if (fromIndex < 0 || toIndex < 0) return;
    const [id] = this.layerIds.splice(fromIndex,1);
    this.layerIds.splice(toIndex,0,id);
    // Stage child reordering
    this.engine.app.stage.setChildIndex(this.engine.layers[id], toIndex);
  }
}

// =======================
// ToolManager
// =======================
class ToolManager {
  constructor(main) {
    this.main = main;
    this.tools = {};
    this.activeTool = null;
  }

  registerTool(tool) {
    this.tools[tool.id] = tool;
  }

  setActiveTool(toolId) {
    this.activeTool = this.tools[toolId];
  }
}

// =======================
// Tools
// =======================
class BrushTool {
  constructor(engine, layerService) {
    this.id = 'brush';
    this.engine = engine;
    this.layerService = layerService;
    this.points = [];
    this.currentLayer = null;
  }

  start(point) {
    if (!this.currentLayer) this.currentLayer = this.layerService.layerIds[0];
    this.points = [point];
  }

  move(point) {
    this.points.push(point);
    this.engine.drawTemporaryStroke(this.currentLayer, this.points, 0x000000, 2);
  }

  end() {
    this.engine.commitStroke(this.currentLayer, this.points, 0x000000, 2);
    this.points = [];
  }

  cancel() {
    this.points = [];
  }

  serialize() {
    return { layer: this.currentLayer, points: this.points };
  }
}

class EraserTool {
  constructor(engine, layerService) {
    this.id = 'eraser';
    this.engine = engine;
    this.layerService = layerService;
    this.points = [];
    this.currentLayer = null;
  }

  start(point) {
    if (!this.currentLayer) this.currentLayer = this.layerService.layerIds[0];
    this.points = [point];
  }

  move(point) {
    this.points.push(point);
    this.engine.drawTemporaryStroke(this.currentLayer, this.points, 0xFFFFFF, 10);
  }

  end() {
    this.engine.commitStroke(this.currentLayer, this.points, 0xFFFFFF, 10);
    this.points = [];
  }

  cancel() {
    this.points = [];
  }

  serialize() {
    return { layer: this.currentLayer, points: this.points };
  }
}

// =======================
// HistoryService
// =======================
class HistoryService {
  constructor() {
    this.stack = [];
    this.pointer = -1;
  }

  record(action) {
    this.stack = this.stack.slice(0,this.pointer+1);
    this.stack.push(action);
    this.pointer++;
  }

  undo() {
    if (this.pointer<0) return;
    const action = this.stack[this.pointer];
    this.pointer--;
    return action;
  }

  redo() {
    if (this.pointer+1>=this.stack.length) return;
    this.pointer++;
    return this.stack[this.pointer];
  }
}

// =======================
// Initialization
// =======================
const container = document.getElementById('canvas-container');
const main = new MainController();
const engine = new DrawingEngine(container);
const layerService = new LayerService(engine);
const toolManager = new ToolManager(main);
const history = new HistoryService();

layerService.createLayer('base');

const brush = new BrushTool(engine, layerService);
const eraser = new EraserTool(engine, layerService);

toolManager.registerTool(brush);
toolManager.registerTool(eraser);
toolManager.setActiveTool('brush');

// =======================
// Mouse / Touch Handling
// =======================
let isDrawing = false;
container.addEventListener('pointerdown', e=>{
  isDrawing = true;
  const pt = { x:e.offsetX, y:e.offsetY };
  toolManager.activeTool.start(pt);
});

container.addEventListener('pointermove', e=>{
  if(!isDrawing) return;
  const pt = { x:e.offsetX, y:e.offsetY };
  toolManager.activeTool.move(pt);
});

container.addEventListener('pointerup', e=>{
  if(!isDrawing) return;
  const pt = { x:e.offsetX, y:e.offsetY };
  toolManager.activeTool.end();
  isDrawing=false;
  history.record(toolManager.activeTool.serialize());
});

// =======================
// Shortcuts
// =======================
document.addEventListener('keydown', e=>{
  if(e.ctrlKey && e.key==='z') {
    const action = history.undo();
    if(action) console.log('Undo:', action);
  }
  if(e.ctrlKey && e.key==='y') {
    const action = history.redo();
    if(action) console.log('Redo:', action);
  }
  if(e.key==='p') toolManager.setActiveTool('brush');
  if(e.key==='e') toolManager.setActiveTool('eraser');
});
</script>
</body>
</html>




ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã¯ï¼š

Canvas2Dã¯ä½¿ç”¨ã›ãšã€PixiJS Graphicsã§ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³ãƒ»æ¶ˆã—ã‚´ãƒ ã‚’æç”»

Undo/Redoã¯Ctrl+Z / Ctrl+Yã§æ“ä½œ

ãƒšãƒ³(P)/æ¶ˆã—ã‚´ãƒ (E)ã®åˆ‡æ›¿ã¯ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã®ã¿

LayerService + DrawingEngine + ToolManager + HistoryServiceã®é–¢ä¿‚ã‚’æ•´ç†

æ”¹ä¿®æ™‚ã¯DrawingEngineå†…ã§æç”»ãƒ•ãƒ­ãƒ¼ã‚’åˆ†é›¢ã—ã¦åˆ‡ã‚Šå‡ºã›ã‚‹æ§‹é€ 




â—†1. ãƒšãƒ³æç”»â†’è¨˜éŒ²ãƒ•ãƒ­ãƒ¼

ä»Šã¯ã€ŒToolManager â†’ DrawingEngine â†’ LayerManager/PositionManager â†’ MainController â†’ HistoryServiceã€ã¨ã„ã†æµã‚ŒãŒåŸºæœ¬ã§ã™ãŒã€å®Ÿå‹™ä¸Šã¯ä»¥ä¸‹ã®ã‚ˆã†ã«æ•´ç†ã™ã‚‹ã¨èª¤è§£ãŒå°‘ãªããªã‚Šã¾ã™ï¼š

1.ToolManager

 ç¾åœ¨ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ã®ãƒ„ãƒ¼ãƒ«ãŒ start/move/end ã‚’ç™ºç«

2.DrawingEngineï¼ˆEngineBridgeï¼‰

 æç”»ãƒãƒƒãƒ•ã‚¡ã«ä¸€æ™‚æç”» (drawTemporaryStroke)

 çµ‚äº†æ™‚ã«ç¢ºå®š (commitStroke)

3.LayerManager / PositionManager

 ãƒ¬ã‚¤ãƒ¤ãƒ¼æ§‹é€ ã‚„åº§æ¨™ç³»ã®ç¢ºèª

 å¿…è¦ã«å¿œã˜ã¦ canvasToWorld / worldToCanvas å¤‰æ›

4.MainController

 ç¢ºå®šã‚¤ãƒ™ãƒ³ãƒˆã‚’å—ã‘å–ã‚Šã€HistoryService ã«é€šçŸ¥

5.HistoryService

 action ã‚’ record

 undo/redo å¯¾å¿œç”¨ã«ã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’ä¿æŒ

ãƒã‚¤ãƒ³ãƒˆ

 æ¶ˆã—ã‚´ãƒ ã¯ commitStroke å†…ã§ BLEND_MODE ã‚’åˆ‡ã‚Šæ›¿ãˆã‚‹

 åº§æ¨™ç³»ã¯ å¸¸ã« World åº§æ¨™åŸºæº–ã§å±¥æ­´ã«è¨˜éŒ²

 Canvas åº§æ¨™ã¸ã®å¤‰æ›ã¯æç”»æ™‚ã®ã¿ï¼ˆã‚¹ã‚¯ãƒªãƒ¼ãƒ³ä¾å­˜ãƒ•ãƒ­ãƒ¼ã‚’é¿ã‘ã‚‹ï¼‰

â—†2. Worldåº§æ¨™ã®æ‰±ã„

 Tool â†’ Engine â†’ Layer ã®é–“ã¯ World åº§æ¨™åŸºæº–

 Canvas åº§æ¨™ã¯æç”»ãƒ»ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ™‚ã®ã¿ä½¿ç”¨

 ç„¡é™ã‚­ãƒ£ãƒ³ãƒã‚¹ã‚„ãƒ‘ãƒ³/ã‚ºãƒ¼ãƒ å¯¾å¿œã«å¿…è¦

 ãƒ•ãƒ­ãƒ¼è¾å…¸ã«ã€Œã©ã“ã§ World â†’ Canvas ã«å¤‰æ›ã™ã‚‹ã‹ã€ã‚’æ˜ç¤ºã™ã‚‹ã¨èª¤ç”¨ã‚’é˜²ã’ã‚‹

â—†3. ä»–ã«æŒ‡æ¨™ã¨ã—ã¦æ˜ç¤ºã™ã¹ããƒ•ãƒ­ãƒ¼

1.éç ´å£Šãƒ¬ã‚¤ãƒ¤ãƒ¼ç§»å‹•

 TransformTool â†’ PositionManager â†’ LayerManager â†’ commitStroke / record

 å±¥æ­´ã«åº§æ¨™å·®åˆ†ã ã‘ã‚’æ®‹ã™

2.Undo/Redoãƒ•ãƒ­ãƒ¼

 ã©ã®è¡›æ˜ŸãŒã‚¹ãƒŠãƒƒãƒ—ã‚·ãƒ§ãƒƒãƒˆã‚’å–å¾—ã™ã‚‹ã‹

 DrawingEngine ãŒ canvas â†’ data ã«å¤‰æ›ã™ã‚‹

3.ã‚¨ãƒ©ãƒ¼ä¼æ’­

 Tool ã§ä¾‹å¤–ç™ºç”Ÿ â†’ MainController.notify â†’ ErrorService

4.ã‚µã‚¤ãƒ¬ãƒ³ãƒˆã«éš ã•ãšæ˜ç¤ºçš„ã«ãƒ•ãƒ­ãƒ¼ã‚’é€šã™

 ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆ

 ToolManager ãŒ activeTool ã‚’åˆ‡ã‚Šæ›¿ãˆ

 æç”»ä¸­ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯å¿…ãš currentTool çµŒç”±ã§ã®ã¿ç™ºç«

