# CUTãƒ»ãƒ¬ã‚¤ãƒ¤ãƒ¼2æ¬¡å…ƒãƒãƒˆãƒªã‚¯ã‚¹ä¿®æ­£è¨ˆç”»æ›¸

## ğŸš¨ å•é¡Œè¨ºæ–­

### ç¾çŠ¶ã®é‡å¤§å•é¡Œ
1. **æ–¹å‘ã‚­ãƒ¼å·¦å³é€†è»¢å•é¡Œ**: â†â†’ãŒæœŸå¾…ã¨é€†ã®å‹•ä½œ
2. **CUT-ãƒ¬ã‚¤ãƒ¤ãƒ¼ç‹¬ç«‹æ€§ç ´ç¶»**: æ–°è¦CUTä½œæˆå¾Œã€å…¨CUTã«æç”»ãŒåæ˜ ã•ã‚Œã‚‹
3. **ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆæœªå‹•ä½œ**: CUTæ¯ã®ã‚­ãƒ£ãƒ³ãƒã‚¹åˆæˆç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„
4. **å†ç”Ÿæ™‚ç”»é¢æœªæ›´æ–°**: ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³å†ç”Ÿã§ã‚­ãƒ£ãƒ³ãƒã‚¹æç”»ãŒåˆ‡ã‚Šæ›¿ã‚ã‚‰ãªã„

### æ ¹æœ¬åŸå› åˆ†æ
- **ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚·ã‚¹ãƒ†ãƒ ã®äºŒé‡ç®¡ç†**: LayerSystem â‡” AnimationSystemé–“ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã®åŒæœŸä¸æ•´åˆ
- **CUTãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ä¸å®Œå…¨æ€§**: å„CUTãŒç‹¬ç«‹ã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã‚’ä¿æŒã—ã¦ã„ãªã„
- **æç”»ã‚¨ãƒ³ã‚¸ãƒ³é€£æºä¸å‚™**: æç”»æ™‚ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã¸ã®åæ˜ ãŒå…¨CUTã«æ³¢åŠ
- **ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¿ã‚¤ãƒŸãƒ³ã‚°å•é¡Œ**: ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆæˆâ†’PIXIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°â†’Canvaså¤‰æ›ã®å‡¦ç†ãƒ•ãƒ­ãƒ¼ä¸å‚™

## ğŸ¯ ç›®æ¨™ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£

### CUT-ãƒ¬ã‚¤ãƒ¤ãƒ¼2æ¬¡å…ƒãƒãƒˆãƒªã‚¯ã‚¹æ§‹é€ 
```
CUTè»¸ï¼ˆæ¨ªè»¸ãƒ»æ™‚é–“è»¸ï¼‰
â”œâ”€ CUT1 â”œâ”€ ãƒ¬ã‚¤ãƒ¤ãƒ¼1 â”œâ”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ— 
â”‚         â”œâ”€ ãƒ¬ã‚¤ãƒ¤ãƒ¼2 â”œâ”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ—  
â”‚         â””â”€ èƒŒæ™¯     â””â”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ—
â”œâ”€ CUT2 â”œâ”€ ãƒ¬ã‚¤ãƒ¤ãƒ¼1 â”œâ”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ—
â”‚         â”œâ”€ ãƒ¬ã‚¤ãƒ¤ãƒ¼2 â”œâ”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ—
â”‚         â””â”€ èƒŒæ™¯     â””â”€ ãƒ‘ã‚¹ãƒ‡ãƒ¼ã‚¿é…åˆ—
â””â”€ CUT3...
```

### ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼è¨­è¨ˆ
```mermaid
graph TD
    A[æç”»æ“ä½œ] --> B[LayerSystem]
    B --> C[ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®ã¿æ›´æ–°]
    C --> D[AnimationSystem.updateCurrentCutLayer]
    D --> E[CUTãƒ‡ãƒ¼ã‚¿ä¿å­˜]
    E --> F[ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆãƒˆãƒªã‚¬ãƒ¼]
    F --> G[PIXIãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼åˆæˆ]
    G --> H[Canvaså¤‰æ›]
    H --> I[UIæ›´æ–°]
```

## ğŸ“‹ æ”¹ä¿®ãƒ•ã‚§ãƒ¼ã‚ºè¨ˆç”»

### Phase 1: åŸºç›¤ä¿®æ­£ï¼ˆæœ€å„ªå…ˆãƒ»å³æ™‚å¯¾å¿œï¼‰
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `animation-system.js`
- **CUTç‹¬ç«‹æ€§ç¢ºä¿**: ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã®å®Œå…¨åˆ†é›¢
- **æç”»åæ˜ ãƒ­ã‚¸ãƒƒã‚¯ä¿®æ­£**: ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ã¿ã¸ã®åæ˜ åˆ¶å¾¡
- **æ–¹å‘ã‚­ãƒ¼ä¿®æ­£**: å·¦å³ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³æ­£å¸¸åŒ–

### Phase 2: ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆä¿®æ­£ï¼ˆé«˜å„ªå…ˆï¼‰
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `animation-system.js`, `timeline-ui.js`
- **PIXIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ”¹å–„**: ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆæˆå‡¦ç†ä¿®æ­£
- **Canvaså¤‰æ›æœ€é©åŒ–**: ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒç”Ÿæˆãƒ•ãƒ­ãƒ¼ç¢ºç«‹
- **éåŒæœŸå‡¦ç†åˆ¶å¾¡**: ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã‚¿ã‚¤ãƒŸãƒ³ã‚°èª¿æ•´

### Phase 3: å†ç”Ÿã‚·ã‚¹ãƒ†ãƒ ä¿®æ­£ï¼ˆä¸­å„ªå…ˆï¼‰
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `animation-system.js`, `timeline-ui.js`
- **CUTåˆ‡ã‚Šæ›¿ãˆæç”»æ›´æ–°**: å†ç”Ÿæ™‚ã®ã‚­ãƒ£ãƒ³ãƒã‚¹è¡¨ç¤ºåŒæœŸ
- **LayerSystemé€£æºå¼·åŒ–**: æç”»ã‚¨ãƒ³ã‚¸ãƒ³ã¨ã®çµ±åˆæ”¹å–„
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: é«˜é€ŸCUTåˆ‡ã‚Šæ›¿ãˆå®Ÿç¾

### Phase 4: UIçµ±åˆãƒ»æœ€çµ‚èª¿æ•´ï¼ˆä½å„ªå…ˆï¼‰
**å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«**: `timeline-ui.js`, `ui/ui-panels.js`
- **æ“ä½œä½“é¨“çµ±ä¸€**: ä¸€è²«ã—ãŸæ“ä½œãƒ•ãƒ­ãƒ¼ç¢ºç«‹
- **ã‚¨ãƒ©ãƒ¼å‡¦ç†å¼·åŒ–**: ä¾‹å¤–çŠ¶æ³ã§ã®å®‰å®šå‹•ä½œ
- **ãƒ‡ãƒãƒƒã‚°æƒ…å ±æ‹¡å……**: é–‹ç™ºåŠ¹ç‡å‘ä¸Š

## ğŸ”§ æŠ€è¡“ä»•æ§˜è©³ç´°

### Phase 1: åŸºç›¤ä¿®æ­£ä»•æ§˜

#### 1.1 CUTç‹¬ç«‹ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ 
```javascript
// animation-system.js ä¿®æ­£å¯¾è±¡
class AnimationSystem {
    constructor() {
        // CUTæ¯ã®å®Œå…¨ç‹¬ç«‹ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ç®¡ç†
        this.cutLayerStates = new Map(); // cutId -> layerStateSnapshot
        this.activeLayerSync = false; // åŒæœŸåˆ¶å¾¡ãƒ•ãƒ©ã‚°
    }
    
    // ã€æ–°è¦å®Ÿè£…ã€‘ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ã¿ã«ãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰æ›´ã‚’åæ˜ 
    syncLayerToActiveCutOnly(layerId, layerData) {
        const activeCut = this.getCurrentCut();
        if (!activeCut) return;
        
        // ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã¿æ›´æ–°
        const layerIndex = activeCut.layers.findIndex(l => l.id === layerId);
        if (layerIndex !== -1) {
            activeCut.layers[layerIndex] = { ...layerData };
            this.generateCutThumbnail(this.getCurrentCutIndex());
        }
    }
    
    // ã€ä¿®æ­£å®Ÿè£…ã€‘æ–¹å‘ã‚­ãƒ¼æ­£å¸¸åŒ–
    goToPreviousFrame() {
        // å³ã‚­ãƒ¼ â†’ æ¬¡ã®CUTã«å¤‰æ›´
        let newIndex = this.animationData.playback.currentCutIndex + 1;
        // ... å®Ÿè£…
    }
    
    goToNextFrame() {
        // å·¦ã‚­ãƒ¼ â†’ å‰ã®CUTã«å¤‰æ›´  
        let newIndex = this.animationData.playback.currentCutIndex - 1;
        // ... å®Ÿè£…
    }
}
```

#### 1.2 LayerSystemæç”»åˆ¶å¾¡ä¿®æ­£
```javascript
// layer-system.js é€£æºä»•æ§˜
class LayerSystem {
    // ã€ä¿®æ­£å®Ÿè£…ã€‘æç”»æ™‚ã«ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ã¿æ›´æ–°
    updateLayerPaths(layerIndex, pathData) {
        // å¾“æ¥: å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã‚’æ›´æ–°
        // ä¿®æ­£å¾Œ: ã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ã¿ AnimationSystem çµŒç”±ã§æ›´æ–°
        
        if (this.animationSystem) {
            this.animationSystem.syncLayerToActiveCutOnly(
                this.layers[layerIndex].layerData.id, 
                pathData
            );
        }
    }
}
```

### Phase 2: ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆä¿®æ­£ä»•æ§˜

#### 2.1 PIXIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æœ€é©åŒ–
```javascript
// animation-system.js ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆæ”¹å–„
async generateCutThumbnail(cutIndex) {
    const cut = this.animationData.cuts[cutIndex];
    if (!cut) return;
    
    try {
        // ã€ä¿®æ­£ã€‘ä¸€æ™‚çš„ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹é©ç”¨
        const originalState = this.captureCurrentLayerState();
        await this.temporarilyApplyCutState(cutIndex);
        
        // ã€æ”¹å–„ã€‘é«˜å“è³ªãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        const renderTexture = PIXI.RenderTexture.create({
            width: this.layerSystem.config.canvas.width,
            height: this.layerSystem.config.canvas.height,
            resolution: 2, // é«˜è§£åƒåº¦å¯¾å¿œ
            antialias: true
        });
        
        // ã€ä¿®æ­£ã€‘å…¨ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆæˆãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
        this.app.renderer.render(this.layerSystem.layersContainer, {
            renderTexture,
            clear: true
        });
        
        // ã€æ”¹å–„ã€‘Canvaså¤‰æ›æœ€é©åŒ–
        const canvas = this.app.renderer.extract.canvas(renderTexture);
        
        // ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆ & UIæ›´æ–°
        cut.thumbnail = PIXI.Texture.from(canvas);
        this.eventBus.emit('animation:thumbnail-generated', { cutIndex });
        
        // å…ƒã®çŠ¶æ…‹ã«å¾©å…ƒ
        await this.restoreLayerState(originalState);
        
    } catch (error) {
        console.error('Thumbnail generation failed:', error);
    }
}
```

#### 2.2 UIæ›´æ–°ãƒ•ãƒ­ãƒ¼
```javascript
// timeline-ui.js ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºä¿®æ­£
updateSingleCutThumbnail(cutIndex) {
    const cutItem = this.cutsContainer.querySelector(`[data-cut-index="${cutIndex}"]`);
    const thumbnail = cutItem?.querySelector('.cut-thumbnail');
    
    if (thumbnail && this.animationSystem) {
        const cut = this.animationSystem.getAnimationData().cuts[cutIndex];
        
        if (cut?.thumbnail) {
            // ã€ä¿®æ­£ã€‘Texture â†’ Canvas URLå¤‰æ›
            const canvas = this.app.renderer.extract.canvas(cut.thumbnail);
            thumbnail.innerHTML = `<img src="${canvas.toDataURL()}" alt="CUT${cutIndex + 1}" />`;
        }
    }
}
```

### Phase 3: å†ç”Ÿã‚·ã‚¹ãƒ†ãƒ ä¿®æ­£ä»•æ§˜

#### 3.1 CUTåˆ‡ã‚Šæ›¿ãˆæç”»åŒæœŸ
```javascript
// animation-system.js å†ç”Ÿæ™‚æç”»æ›´æ–°
updatePlayback() {
    // ... æ—¢å­˜ã®æ™‚é–“ç®¡ç†å‡¦ç†
    
    if (elapsed >= currentCut.duration) {
        this.animationData.playback.currentCutIndex++;
        
        // ã€ä¿®æ­£ã€‘CUTåˆ‡ã‚Šæ›¿ãˆæ™‚ã«æç”»ã‚’æ›´æ–°
        await this.switchToActiveCutWithRender(this.animationData.playback.currentCutIndex);
        
        this.animationData.playback.startTime = Date.now();
        
        // UIåŒæœŸæ›´æ–°
        this.eventBus.emit('animation:cut-changed', { 
            cutIndex: this.animationData.playback.currentCutIndex,
            renderUpdated: true
        });
    }
}

// ã€æ–°è¦å®Ÿè£…ã€‘æç”»æ›´æ–°ä»˜ãCUTåˆ‡ã‚Šæ›¿ãˆ
async switchToActiveCutWithRender(cutIndex) {
    // CUTãƒ‡ãƒ¼ã‚¿é©ç”¨
    this.setActiveCut(cutIndex);
    
    // LayerSystemæç”»çŠ¶æ…‹ã‚’å¼·åˆ¶æ›´æ–°
    if (this.layerSystem) {
        this.layerSystem.forceRedrawAllLayers();
    }
    
    // æç”»ã‚¨ãƒ³ã‚¸ãƒ³ã«å†æç”»è¦æ±‚
    if (this.app) {
        this.app.renderer.render(this.layerSystem.layersContainer);
    }
}
```

### Phase 4: æœ€çµ‚çµ±åˆä»•æ§˜

#### 4.1 æ“ä½œçµ±ä¸€ãƒ»ã‚¨ãƒ©ãƒ¼å‡¦ç†
```javascript
// å…¨ãƒ•ã‚¡ã‚¤ãƒ«å…±é€š: ã‚¨ãƒ©ãƒ¼å‡¦ç†ãƒ‘ã‚¿ãƒ¼ãƒ³
const safeAsyncOperation = async (operation, fallback) => {
    try {
        return await operation();
    } catch (error) {
        console.error(`Operation failed:`, error);
        return fallback?.() || null;
    }
};
```

## ğŸ› ï¸ PIXIãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ¨å¥¨æ¡ç”¨

### é«˜å„ªå…ˆæ¡ç”¨å€™è£œ

#### 1. **PIXI-Spine** (ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æœ€é©åŒ–)
```javascript
// ã‚¹ãƒ—ãƒ©ã‚¤ãƒˆã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³é«˜é€ŸåŒ–
import 'pixi-spine';
// ãƒ¬ã‚¤ãƒ¤ãƒ¼å¤‰å½¢ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã®æœ€é©åŒ–ã«ä½¿ç”¨
```

#### 2. **PIXI-Graphics-Smooth** (æç”»å“è³ªå‘ä¸Š)
```javascript
// ã‚¢ãƒ³ãƒã‚¨ã‚¤ãƒªã‚¢ã‚¹æç”»æ”¹å–„
import '@pixi/graphics-smooth';
// ãƒšãƒ³æç”»ã®å“è³ªå‘ä¸Šãƒ»ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆã®é«˜å“è³ªåŒ–
```

#### 3. **PIXI-Tilemap** (å¤§é‡ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæœ€é©åŒ–)
```javascript
// å¤§é‡ãƒ‘ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æç”»æœ€é©åŒ–
import '@pixi/tilemap';
// è¤‡æ•°ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ»å¤šæ•°ãƒ‘ã‚¹ã®é«˜é€Ÿæç”»
```

### ä¸­å„ªå…ˆæ¡ç”¨å€™è£œ

#### 4. **PIXI-Filters** (è¦–è¦šåŠ¹æœ)
```javascript
// ãƒ¬ã‚¤ãƒ¤ãƒ¼åŠ¹æœãƒ»ã‚µãƒ ãƒã‚¤ãƒ«ç”ŸæˆåŠ¹æœ
import '@pixi/filter-blur';
import '@pixi/filter-glow';
// å°†æ¥ã®æ©Ÿèƒ½æ‹¡å¼µã«å‚™ãˆãŸãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ç³»çµ±
```

#### 5. **PIXI-Compressed-Textures** (ãƒ¡ãƒ¢ãƒªæœ€é©åŒ–)
```javascript
// ã‚µãƒ ãƒã‚¤ãƒ«ç”»åƒã®åœ§ç¸®æœ€é©åŒ–
import '@pixi/compressed-textures';
// å¤§é‡CUTã®ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡å‰Šæ¸›
```

## ğŸ“… å®Ÿè£…ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ«

### Week 1: Phase 1 å®Ÿè£…
- Day 1-2: `animation-system.js` CUTç‹¬ç«‹æ€§ä¿®æ­£
- Day 3: `layer-system.js` æç”»åˆ¶å¾¡ä¿®æ­£  
- Day 4: æ–¹å‘ã‚­ãƒ¼ä¿®æ­£ãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ
- Day 5: Phase 1 å®Œæˆãƒ»æ¤œè¨¼

### Week 2: Phase 2 å®Ÿè£…
- Day 1-2: PIXIãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ”¹å–„ãƒ»ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆä¿®æ­£
- Day 3: `timeline-ui.js` ã‚µãƒ ãƒã‚¤ãƒ«è¡¨ç¤ºä¿®æ­£
- Day 4: éåŒæœŸå‡¦ç†æœ€é©åŒ–
- Day 5: Phase 2 å®Œæˆãƒ»æ¤œè¨¼

### Week 3: Phase 3-4 å®Ÿè£…
- Day 1-2: CUTåˆ‡ã‚Šæ›¿ãˆæç”»åŒæœŸä¿®æ­£
- Day 3: å†ç”Ÿã‚·ã‚¹ãƒ†ãƒ æœ€é©åŒ–
- Day 4: UIçµ±åˆãƒ»æœ€çµ‚èª¿æ•´
- Day 5: å…¨Phaseå®Œæˆãƒ»çµ±åˆãƒ†ã‚¹ãƒˆ

## ğŸ§ª ãƒ†ã‚¹ãƒˆè¨ˆç”»

### Phase 1 æ¤œè¨¼é …ç›®
- [ ] æ–°è¦CUTä½œæˆå¾Œã€å„CUTãŒç‹¬ç«‹ã—ãŸãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã‚’ä¿æŒ
- [ ] æç”»æ“ä½œãŒã‚¢ã‚¯ãƒ†ã‚£ãƒ–CUTã®ã¿ã«åæ˜ ã•ã‚Œã‚‹
- [ ] å·¦å³ã‚­ãƒ¼ãŒæ­£å¸¸æ–¹å‘ã§CUTç§»å‹•ã™ã‚‹
- [ ] CUTåˆ‡ã‚Šæ›¿ãˆæ™‚ã«ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒæ¶ˆå¤±ã—ãªã„

### Phase 2 æ¤œè¨¼é …ç›®  
- [ ] CUTæ¯ã«ãƒ¬ã‚¤ãƒ¤ãƒ¼åˆæˆç”»åƒã®ã‚µãƒ ãƒã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹
- [ ] ã‚µãƒ ãƒã‚¤ãƒ«ãŒã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³UIã«æ­£å¸¸è¡¨ç¤ºã•ã‚Œã‚‹
- [ ] æç”»å¤‰æ›´æ™‚ã«ã‚µãƒ ãƒã‚¤ãƒ«ãŒè‡ªå‹•æ›´æ–°ã•ã‚Œã‚‹
- [ ] é«˜è§£åƒåº¦ã§ã‚‚æ€§èƒ½åŠ£åŒ–ã—ãªã„

### Phase 3 æ¤œè¨¼é …ç›®
- [ ] ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³å†ç”Ÿæ™‚ã«ã‚­ãƒ£ãƒ³ãƒã‚¹æç”»ãŒCUTæ¯ã«åˆ‡ã‚Šæ›¿ã‚ã‚‹
- [ ] å†ç”Ÿé€Ÿåº¦ã«é–¢ä¿‚ãªãæç”»ãŒæ­£å¸¸æ›´æ–°ã•ã‚Œã‚‹  
- [ ] åœæ­¢ãƒ»å†é–‹æ™‚ã®æç”»çŠ¶æ…‹ãŒä¸€è²«ã—ã¦ã„ã‚‹
- [ ] å¤§é‡CUTãƒ»é•·æ™‚é–“å†ç”Ÿã§ã‚‚å®‰å®šå‹•ä½œã™ã‚‹

### çµ±åˆæ¤œè¨¼é …ç›®
- [ ] å…¨ã¦ã®æ“ä½œãƒ‘ã‚¿ãƒ¼ãƒ³ã§å®‰å®šå‹•ä½œ
- [ ] ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ãŒç™ºç”Ÿã—ãªã„
- [ ] ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã®é©åˆ‡ãªå¾©æ—§å‹•ä½œ
- [ ] å¾Œç¶šClaudeé–‹ç™ºè€…ã«ã‚ˆã‚‹ç†è§£ãƒ»æ”¹ä¿®å®¹æ˜“æ€§

## ğŸ’¡ å¾Œç¶šClaudeé–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰

### æ”¹ä¿®æ™‚ã®æ³¨æ„ç‚¹
1. **ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ã®åŒæœŸ**: `AnimationSystem.syncLayerToActiveCutOnly()` ã‚’å¿…ãšçµŒç”±ã™ã‚‹
2. **ã‚µãƒ ãƒã‚¤ãƒ«ç”Ÿæˆ**: éåŒæœŸå‡¦ç†ã®ãŸã‚ `await` ã‚’é©åˆ‡ã«ä½¿ç”¨ã™ã‚‹
3. **CUTåˆ‡ã‚Šæ›¿ãˆ**: `switchToActiveCutWithRender()` ã§ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°æ›´æ–°ã‚‚å®Ÿè¡Œã™ã‚‹
4. **æ–¹å‘ã‚­ãƒ¼**: `goToPreviousFrame()` ãŒå®Ÿéš›ã¯æ¬¡ã¸ã€`goToNextFrame()` ãŒå‰ã¸ç§»å‹•ã™ã‚‹ï¼ˆå‘½åæ³¨æ„ï¼‰

### ãƒ‡ãƒãƒƒã‚°æƒ…å ±æ´»ç”¨
```javascript
// ãƒ‡ãƒãƒƒã‚°ç”¨: CUT-ãƒ¬ã‚¤ãƒ¤ãƒ¼çŠ¶æ…‹ç¢ºèª
console.log(animationSystem.debugCutLayerMatrix());

// ãƒ‡ãƒãƒƒã‚°ç”¨: ã‚µãƒ ãƒã‚¤ãƒ«ç”ŸæˆçŠ¶æ³ç¢ºèª  
console.log(animationSystem.debugThumbnailStatus());

// ãƒ‡ãƒãƒƒã‚°ç”¨: æç”»åŒæœŸçŠ¶æ³ç¢ºèª
console.log(layerSystem.debugRenderSyncStatus());
```

### æ‹¡å¼µé–‹ç™ºæŒ‡é‡
- æ–°æ©Ÿèƒ½è¿½åŠ æ™‚ã¯å¿…ãš2æ¬¡å…ƒãƒãƒˆãƒªã‚¯ã‚¹æ§‹é€ ã‚’ç¶­æŒã™ã‚‹
- PIXIãƒ—ãƒ©ã‚°ã‚¤ãƒ³è¿½åŠ æ™‚ã¯æ—¢å­˜ã®æç”»ãƒ•ãƒ­ãƒ¼ã¨ã®æ•´åˆæ€§ã‚’ç¢ºèªã™ã‚‹
- å¤§é‡ãƒ‡ãƒ¼ã‚¿å‡¦ç†æ™‚ã¯ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã‚’æœ€å„ªå…ˆã«è¨­è¨ˆã™ã‚‹

---

**æ”¹ä¿®å®Œäº†åŸºæº–**: å…¨æ¤œè¨¼é …ç›®ãŒãƒ‘ã‚¹ã—ã€å¾Œç¶šé–‹ç™ºè€…ãŒå®¹æ˜“ã«ç†è§£ãƒ»æ”¹ä¿®å¯èƒ½ãªçŠ¶æ…‹