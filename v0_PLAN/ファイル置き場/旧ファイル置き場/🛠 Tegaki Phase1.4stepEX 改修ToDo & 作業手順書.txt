# ğŸ›  Tegaki Phase1.4stepEX æ”¹ä¿®ToDo & ä½œæ¥­æ‰‹é †æ›¸

## ğŸš¨ ç¾åœ¨ã®å•é¡Œåˆ†æ

### ğŸ“Š åº§æ¨™ãƒã‚°ã®æ ¹æœ¬åŸå› 
- **å•é¡Œ**: ãƒšãƒ³æç”»ã§0,0åº§æ¨™ã‹ã‚‰æç”»ä½ç½®ã¸ã®ç›´ç·šãŒæã‹ã‚Œã‚‹
- **åŸå› **: CanvasManager ã¨ PenTool ã®æç”»è²¬ä»»åˆ†ç•ŒãŒæ›–æ˜§
- **å½±éŸ¿**: AbstractTool ã®åº§æ¨™å‡¦ç†ã¨CanvasManagerã®æç”»å‡¦ç†ãŒæ··åœ¨

### ğŸ” ç¾çŠ¶ã®æ§‹é€ å•é¡Œ
1. **åå‰ç©ºé–“çµ±ä¸€ä¸å®Œå…¨**: `window.*` ã¨ `Tegaki.*` ãŒæ··åœ¨
2. **åˆæœŸåŒ–é †åºå•é¡Œ**: ãƒ¬ã‚¸ã‚¹ãƒˆãƒªæ–¹å¼æœªé©ç”¨ã§ä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼
3. **åº§æ¨™å‡¦ç†è²¬ä»»åˆ†æ•£**: åº§æ¨™å¤‰æ›ãŒTool/Manageré–“ã§åˆ†æ•£
4. **catchæ–‡æ§‹æ–‡ã‚¨ãƒ©ãƒ¼**: ä¸€éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æ–‡ä¸æ•´åˆ

## ğŸ“‹ æ”¹ä¿®æˆ¦ç•¥ï¼ˆæŒ‡ç¤ºæ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆæº–æ‹ ï¼‰

### ğŸ¯ Phase1: æ ¹å¹¹Managerå…ˆè¡ŒåˆæœŸåŒ–
**ç›®çš„**: å ‚ã€…å·¡ã‚Šã‚¨ãƒ©ãƒ¼é˜²æ­¢ã®ãŸã‚ã€åŸºç›¤ã‚·ã‚¹ãƒ†ãƒ ã‚’å…ˆã«ç¢ºä¿

#### âœ… Step1: æ ¹å¹¹Managerçµ±ä¸€ï¼ˆæœ€å„ªå…ˆï¼‰
- [ ] ErrorManager â†’ `Tegaki.ErrorManagerInstance`
- [ ] ConfigManager â†’ `Tegaki.ConfigManagerInstance` 
- [ ] StateManager â†’ `Tegaki.StateManagerInstance`
- [ ] EventBus â†’ `Tegaki.EventBusInstance`
- [ ] åˆæœŸåŒ–ãƒ¬ã‚¸ã‚¹ãƒˆãƒª `Tegaki._registry` å°å…¥

#### âœ… Step2: CoordinateManageråº§æ¨™å‡¦ç†çµ±ä¸€
- [ ] åº§æ¨™å¤‰æ›è²¬ä»»ã‚’ CoordinateManager ã«é›†ç´„
- [ ] PenTool ã‹ã‚‰åº§æ¨™å‡¦ç†è²¬ä»»ã‚’åˆ†é›¢
- [ ] CanvasManager ã¯ Graphicsé…ç½®ã®ã¿ã«å°‚å¿µ

### ğŸ¯ Phase2: Tegakiåå‰ç©ºé–“å®Œå…¨çµ±ä¸€
**ç›®çš„**: æ”¹ä¿®æ‰‹é †æ›¸Phase1.4stepEXå®Œå…¨é©ç”¨

#### âœ… Step3: å„ãƒ•ã‚¡ã‚¤ãƒ«ã®åå‰ç©ºé–“çµ±ä¸€
- [ ] å…¨ãƒ•ã‚¡ã‚¤ãƒ«ã« `window.Tegaki = window.Tegaki || {};` è¿½åŠ 
- [ ] ã‚¯ãƒ©ã‚¹å®šç¾© â†’ `Tegaki.ClassName = ClassName;`
- [ ] ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹åŒ– â†’ `Tegaki._registry.push(() => { ... });`

#### âœ… Step4: åº§æ¨™ãƒã‚°å®Œå…¨ä¿®æ­£
- [ ] PenToolåº§æ¨™å‡¦ç†ã‚’CoordinateManagerå§”è­²
- [ ] CanvasManageræç”»ãƒ¡ã‚½ãƒƒãƒ‰æ•´ç†
- [ ] 0,0åº§æ¨™å•é¡Œã®æ ¹æœ¬ä¿®æ­£

### ğŸ¯ Phase3: UIãƒ»ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ä¿æŒ
**ç›®çš„**: æ—¢å­˜æ©Ÿèƒ½ãƒ»ãƒ‡ã‚¶ã‚¤ãƒ³ã®ä¿æŒ

#### âœ… Step5: ãµãŸã°â˜†ã¡ã‚ƒã‚“ã­ã‚‹ã‚«ãƒ©ãƒ¼ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆä¿æŒ
- [ ] CSSå¤‰æ•°ã§ãµãŸã°ã‚«ãƒ©ãƒ¼å®šç¾©ç¶­æŒ
- [ ] @tabler/icons ã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨ç¶™ç¶š
- [ ] ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆæ§‹é€ ä¿æŒ

#### âœ… Step6: ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä¿æŒãƒ»æ”¹è‰¯
- [ ] ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³ãƒ„ãƒ¼ãƒ«è¨­å®šãƒ‘ãƒãƒ«ä¿æŒ
- [ ] ã‚µã‚¤ã‚ºãƒ—ãƒªã‚»ãƒƒãƒˆãƒ»ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½ä¿æŒ
- [ ] ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä¿æŒ

## ğŸ”§ è©³ç´°å®Ÿè£…æ‰‹é †

### ğŸ“‚ ãƒ•ã‚¡ã‚¤ãƒ«åˆ¥æ”¹ä¿®é †åºï¼ˆä¾å­˜é–¢ä¿‚è€ƒæ…®ï¼‰

#### ğŸ¥‡ æœ€å„ªå…ˆãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ï¼ˆæ ¹å¹¹Managerï¼‰
1. **js/utils/error-manager.js**
   - `window.Tegaki` åå‰ç©ºé–“è¿½åŠ 
   - `Tegaki.ErrorManager = ErrorManager;`
   - ãƒ¬ã‚¸ã‚¹ãƒˆãƒªåˆæœŸåŒ–è¿½åŠ 

2. **js/utils/config-manager.js**
   - åŒæ§˜ã®åå‰ç©ºé–“çµ±ä¸€
   - ãµãŸã°ã‚«ãƒ©ãƒ¼è¨­å®šä¿æŒ

3. **js/utils/state-manager.js** 
   - çŠ¶æ…‹ç®¡ç†ã®åå‰ç©ºé–“çµ±ä¸€

4. **js/utils/event-bus.js**
   - ã‚¤ãƒ™ãƒ³ãƒˆé€šä¿¡ã®åå‰ç©ºé–“çµ±ä¸€

#### ğŸ¥ˆ åº§æ¨™å‡¦ç†ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
5. **js/utils/coordinate-manager.js**
   - åº§æ¨™å¤‰æ›è²¬ä»»ã®å®Œå…¨é›†ç´„
   - PenToolç”¨åº§æ¨™ãƒ¡ã‚½ãƒƒãƒ‰å¼·åŒ–

#### ğŸ¥‰ Managerãƒ»UIç³»ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
6. **managers/canvas-manager.js**
   - Graphicsé…ç½®å°‚é–€åŒ–
   - æç”»å‡¦ç†ã‚’Toolå§”è­²
   
7. **managers/tool-manager.js**
   - Toolçµ±åˆåˆ¶å¾¡ã®åå‰ç©ºé–“çµ±ä¸€

8. **js/ui/popup-manager.js**
   - ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—æ©Ÿèƒ½ä¿æŒ

9. **js/ui/slider-manager.js** 
   - ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ©Ÿèƒ½ä¿æŒ

#### ğŸ… Toolå®Ÿè£…ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
10. **tools/abstract-tool.js**
    - çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹ç¢ºç«‹
    - catchæ–‡æ§‹æ–‡ä¿®æ­£

11. **tools/pen-tool.js**
    - åº§æ¨™å‡¦ç†ã‚’CoordinateManagerå§”è­²
    - æç”»è²¬ä»»æ˜ç¢ºåŒ–

#### ğŸ¯ çµ±åˆãƒ»èµ·å‹•ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤
12. **js/main.js**
    - DOMContentLoadedå†…ã§ãƒ¬ã‚¸ã‚¹ãƒˆãƒªå®Ÿè¡Œ
    - åˆæœŸåŒ–é †åºä¿è¨¼

13. **index.html**
    - ã‚¹ã‚¯ãƒªãƒ—ãƒˆèª­ã¿è¾¼ã¿é †åºä¿®æ­£
    - ãµãŸã°ã‚«ãƒ©ãƒ¼ãƒ»@tabler/iconsä¿æŒ

## ğŸ¨ é‡è¦ãªä¿æŒäº‹é …

### ğŸŒˆ ãµãŸã°â˜†ã¡ã‚ƒã‚“ã­ã‚‹ã‚«ãƒ©ãƒ¼å®šç¾©
```css
--futaba-maroon: #800000;     
--futaba-light-maroon: #aa5a56;     
--futaba-medium: #cf9c97;
--futaba-light-medium: #e9c2ba;      
--futaba-cream: #f0e0d6;     
--futaba-background: #ffffee;
```

### ğŸ¨ UIè¦ç´ ä¿æŒé …ç›®
- [ ] ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆå·¦å´ãƒ„ãƒ¼ãƒ«ãƒãƒ¼ï¼‰
- [ ] @tabler/icons ã‚¢ã‚¤ã‚³ãƒ³ä½¿ç”¨
- [ ] ãƒ™ã‚¯ã‚¿ãƒ¼ãƒšãƒ³ãƒ„ãƒ¼ãƒ«è¨­å®šãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
- [ ] ã‚µã‚¤ã‚ºãƒ—ãƒªã‚»ãƒƒãƒˆï¼ˆ1pxã€œ32pxï¼‰
- [ ] ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æ“ä½œï¼ˆã‚µã‚¤ã‚ºãƒ»ä¸é€æ˜åº¦ãƒ»ç­†åœ§ãƒ»ç·šè£œæ­£ï¼‰
- [ ] ãƒ‰ãƒ©ãƒƒã‚°å¯èƒ½ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
- [ ] ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ‘ãƒãƒ«ï¼ˆä¸‹éƒ¨æƒ…å ±è¡¨ç¤ºï¼‰

### ğŸ“± æ©Ÿèƒ½ä¿æŒé …ç›®
- [ ] PixiJS v7 åˆ©ç”¨ç¶™ç¶š
- [ ] GPUåŠ é€Ÿå¯¾å¿œ
- [ ] ç­†åœ§æ„ŸçŸ¥æ©Ÿèƒ½
- [ ] 120Hzå¯¾å¿œ
- [ ] ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ FPS/ãƒ¡ãƒ¢ãƒªè¡¨ç¤º

## âš ï¸ å®Ÿè£…ä¸Šã®æ³¨æ„äº‹é …

### ğŸš« ç¦æ­¢äº‹é …
- [ ] æ¶ç©ºã®ãƒ¡ã‚½ãƒƒãƒ‰ãƒ»ã‚·ãƒ³ãƒœãƒ«å®šç¾©ä½¿ç”¨ç¦æ­¢
- [ ] æ—¢å­˜æ©Ÿèƒ½ã®ç ´å£Šçš„å¤‰æ›´ç¦æ­¢
- [ ] PixiJS v8ã¸ã®å‹æ‰‹ãªç§»è¡Œç¦æ­¢
- [ ] ãµãŸã°ã‚«ãƒ©ãƒ¼ãƒ»ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®å¤‰æ›´ç¦æ­¢

### âœ… å¿…é ˆéµå®ˆäº‹é …
- [ ] æ—¢å­˜ã‚³ãƒ¼ãƒ‰ä¿æŒãƒ»å•é¡Œç®‡æ‰€ã®ã¿ä¿®æ­£
- [ ] è²¬å‹™åˆ†é›¢åŸå‰‡å³å®ˆ
- [ ] çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨å¿…é ˆ
- [ ] ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ã®å¤‰æ›´ç®‡æ‰€æ˜è¨˜

### ğŸ”„ PixiJS v8å¯¾å¿œæº–å‚™
- [ ] å°†æ¥å¯¾å¿œã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆè¿½åŠ 
- [ ] éäº’æ›ãƒ¡ã‚½ãƒƒãƒ‰ç‰¹å®šãƒ»ä»£æ›¿æº–å‚™
- [ ] ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–å¯¾å¿œè¨­è¨ˆ

## ğŸ“Š æˆåŠŸåˆ¤å®šåŸºæº–

### âœ… åŸºæœ¬å‹•ä½œç¢ºèª
- [ ] ãƒšãƒ³æç”»ã§ç›´ç·šãƒã‚°ãŒç™ºç”Ÿã—ãªã„
- [ ] ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] ãƒ„ãƒ¼ãƒ«åˆ‡ã‚Šæ›¿ãˆãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹
- [ ] åˆæœŸåŒ–ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãªã„

### ğŸ“ˆ å“è³ªç¢ºèª
- [ ] catchæ–‡æ§‹æ–‡ã‚¨ãƒ©ãƒ¼ãªã—
- [ ] æœªå®šç¾©å‚ç…§ã‚¨ãƒ©ãƒ¼ãªã—  
- [ ] console.error å‡ºåŠ›ãªã—
- [ ] FPS/ãƒ¡ãƒ¢ãƒªè¡¨ç¤ºæ­£å¸¸

### ğŸ¯ ã‚³ãƒ¼ãƒ‰å“è³ªç¢ºèª
- [ ] è²¬å‹™åˆ†é›¢éµå®ˆç‡100%
- [ ] çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨ç‡100%
- [ ] é‡è¤‡ã‚³ãƒ¼ãƒ‰æ•°0å€‹
- [ ] å¾ªç’°ä¾å­˜æ•°0å€‹

## ğŸ’» å®Ÿè£…å‚è€ƒã‚·ãƒ³ãƒœãƒ«ãƒ»ãƒ¡ã‚½ãƒƒãƒ‰ä¸€è¦§

### ğŸ”§ Tegakiçµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ API
```javascript
// åˆ©ç”¨å¯èƒ½ãªã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ï¼ˆãƒ¬ã‚¸ã‚¹ãƒˆãƒªåˆæœŸåŒ–å¾Œï¼‰
Tegaki.ErrorManagerInstance.handle(error)
Tegaki.ConfigManagerInstance.getDebugInfo()
Tegaki.StateManagerInstance.getState(key), setState(key,val)
Tegaki.EventBusInstance.on(event,cb), emit(event,data)
Tegaki.CoordinateManagerInstance.screenToCanvas(x,y,rect)
Tegaki.CanvasManagerInstance.initialize(container), addLayer(name)
Tegaki.ToolManagerInstance.setTool(name), apply(event)
```

### ğŸ–Šï¸ Toolç³»çµ±ä¸€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
```javascript
// AbstractToolç¶™æ‰¿å¿…é ˆãƒ¡ã‚½ãƒƒãƒ‰
onPointerDown(event, canvasManager, coordinateManager)
onPointerMove(event, canvasManager, coordinateManager)  
onPointerUp(event, canvasManager, coordinateManager)

// PenToolå…·ä½“å®Ÿè£…ãƒ¡ã‚½ãƒƒãƒ‰
startDrawing(x, y, pressure)
updateStroke(x, y, pressure) 
endStroke()
createGraphicsForCanvas()
```

### ğŸ“ CoordinateManageråº§æ¨™API
```javascript
// åº§æ¨™å¤‰æ›çµ±ä¸€APIï¼ˆå¿…é ˆä½¿ç”¨ï¼‰
extractPointerCoordinates(event, rect, app)
screenToCanvas(screenX, screenY, rect)
canvasToPixi(canvasX, canvasY, pixiApp)
validateCoordinateIntegrity(coords)
```

## ğŸ¯ æœ€çµ‚ç›®æ¨™

### ğŸ† æˆåŠŸçŠ¶æ…‹
1. **åº§æ¨™ãƒã‚°å®Œå…¨è§£æ¶ˆ**: 0,0ç›´ç·šå•é¡Œã®æ ¹æœ¬è§£æ±º
2. **è²¬å‹™åˆ†é›¢é”æˆ**: CanvasManagerï¼ˆé…ç½®ï¼‰+ Toolï¼ˆæç”»ï¼‰ã®æ˜ç¢ºåˆ†é›¢
3. **çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ å®Œæˆ**: Tegakiåå‰ç©ºé–“ã§ã®çµ±åˆç®¡ç†
4. **æ—¢å­˜æ©Ÿèƒ½ä¿æŒ**: UIãƒ»ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—ãƒ»ãµãŸã°ãƒ‡ã‚¶ã‚¤ãƒ³å®Œå…¨ä¿æŒ
5. **Phase2æº–å‚™å®Œäº†**: æ¬¡æ®µéšã¸ã®å®‰å…¨ãªç§»è¡ŒåŸºç›¤ç¢ºç«‹

### ğŸ“ˆ å“è³ªæŒ‡æ¨™ç›®æ¨™
- **åº§æ¨™å‡¦ç†ç²¾åº¦**: 100%ï¼ˆ0,0ãƒã‚°ãªã—ï¼‰
- **åˆæœŸåŒ–æˆåŠŸç‡**: 100%ï¼ˆä¾å­˜é–¢ä¿‚ã‚¨ãƒ©ãƒ¼ãªã—ï¼‰
- **UIæ©Ÿèƒ½ä¿æŒç‡**: 100%ï¼ˆæ—¢å­˜æ©Ÿèƒ½å…¨ä¿æŒï¼‰
- **è²¬å‹™åˆ†é›¢éµå®ˆç‡**: 100%ï¼ˆManager/Toolåˆ†é›¢ï¼‰
- **çµ±ä¸€ã‚·ã‚¹ãƒ†ãƒ æ´»ç”¨ç‡**: 100%ï¼ˆTegakiåå‰ç©ºé–“çµ±ä¸€ï¼‰

---

*ğŸ“… ä½œæˆæ—¥: 2025å¹´8æœˆ23æ—¥*  
*ğŸ¯ å¯¾è±¡: Tegaki Phase1.4stepEX åº§æ¨™ãƒã‚°ä¿®æ­£ãƒ»åå‰ç©ºé–“çµ±ä¸€*  
*ğŸ“š å‚è€ƒ: æ”¹ä¿®æ‰‹é †æ›¸Phase1.4stepEX.txt + Claude4ç”¨æŒ‡ç¤ºæ–‡ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ.txt*  
*ğŸ† ç›®æ¨™: åº§æ¨™ãƒã‚°è§£æ¶ˆ + è²¬å‹™åˆ†é›¢é”æˆ + æ—¢å­˜æ©Ÿèƒ½å®Œå…¨ä¿æŒ*