# ğŸš€ Tegaki Phase1.5+ çµ±åˆé€²åŒ–è¨ˆç”»æ›¸
**PixiJS v8åŸºç›¤ - ãƒ—ãƒ­ç´šãƒšãƒ³ãƒ„ãƒ¼ãƒ«ãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»Phase2-3çµ±åˆç‰ˆ**

> **Rev.2025-08-29-çµ±åˆç‰ˆ** - Phase1.5å®Œäº†å¾Œã®åŒ…æ‹¬çš„æ©Ÿèƒ½å®Ÿè£…è¨ˆç”»

---

## ğŸ“‹ **å‰ææ¡ä»¶ãƒ»ã‚¹ã‚³ãƒ¼ãƒ—**

### âœ… **Phase1.5å®Œäº†å¿…é ˆäº‹é …**
- PixiJS v8å®Œå…¨ç§»è¡Œãƒ»WebGPUå¯¾å¿œå®Œäº†
- TPFï¼ˆTegakiPathFormat v0.2ï¼‰éç ´å£Šãƒ‡ãƒ¼ã‚¿ä¿æŒç¢ºç«‹
- ã‚­ãƒ£ãƒ³ãƒã‚¹å¤–æç”»ãƒ»ã‚«ãƒ¡ãƒ©åˆ†é›¢å®Ÿè£…å®Œäº†
- åˆæœŸåŒ–é †åºç¢ºç«‹ãƒ»ã‚¨ãƒ©ãƒ¼å³åœæ­¢åŸå‰‡å¾¹åº•
- 400Ã—400åˆæœŸã‚­ãƒ£ãƒ³ãƒã‚¹ãƒ»ãƒªã‚µã‚¤ã‚ºå¯¾å¿œå®Œäº†

### ğŸ¯ **çµ±åˆè¨ˆç”»ç›®æ¨™**
1. **Phase1.6**: ãƒ—ãƒ­ç´šãƒšãƒ³ãƒ„ãƒ¼ãƒ«ãƒ»120Hzå¯¾å¿œãƒ»ç­†åœ§æ„ŸçŸ¥
2. **Phase1.7**: ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆçµ±åˆ
3. **Phase1.8**: åŸºç›¤å®Œæˆãƒ»Phase2æº–å‚™å®Œäº†
4. **Phase2**: ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ãƒ»é¸æŠå¤‰å½¢ãƒ»é«˜åº¦æç”»
5. **Phase3**: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å‡ºåŠ›ãƒ»æœ€é©åŒ–ãƒ»ãƒ—ãƒ©ã‚°ã‚¤ãƒ³

---

## ğŸ–Šï¸ **Phase1.6 - ãƒ—ãƒ­ç´šãƒšãƒ³ãƒ„ãƒ¼ãƒ«å®Ÿè£…**

### ğŸ”§ **æ–°è¦Managerè¿½åŠ **

#### 1. PressureManagerï¼ˆç­†åœ§ç®¡ç†ï¼‰
```javascript
/**
 * ğŸ–Šï¸ PressureManager - ç­†åœ§æ„ŸçŸ¥ãƒ»æ­£è¦åŒ–ãƒ»è£œæ­£
 * @provides: getPressure(), calibratePressure(), setPressureCurve()
 * @uses: PointerEvent.pressure, pressure.js, ConfigManagerInstance
 * @initflow: 1.ãƒ‡ãƒã‚¤ã‚¹æ¤œå‡º â†’ 2.ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ â†’ 3.æ„Ÿåº¦æ›²ç·šè¨­å®š
 * @forbids: ğŸ’€åŒæ–¹å‘ä¾å­˜ ğŸš«ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ ğŸš«v7/v8äºŒé‡ç®¡ç†
 * @manager-key: window.Tegaki.PressureManagerInstance
 * @dependencies-strict: REQUIRED[ConfigManager], OPTIONAL[pressure.js]
 * @integration-flow: AppCore â†’ CanvasManager â†’ PressureManager
 */
class PressureManager {
    // Apple Pencil/Surface Pen/Wacomè‡ªå‹•èªè­˜
    // æ„Ÿåº¦æ›²ç·šï¼ˆãƒªãƒ‹ã‚¢/äºŒæ¬¡/ã‚«ã‚¹ã‚¿ãƒ ï¼‰
    // ãƒ‡ãƒã‚¤ã‚¹å·®ç•°è‡ªå‹•å¸å
    initialize(): Promise<void>
    detectPressureDevice(): {type, capabilities}
    calibratePressure(samples): void
    getPressure(event): number  // 0-1æ­£è¦åŒ–
    setPressureCurve(type): void
}
```

#### 2. StrokeEngineï¼ˆé«˜é€Ÿæç”»ã‚¨ãƒ³ã‚¸ãƒ³ï¼‰
```javascript
/**
 * ğŸ¨ StrokeEngine - 120Hzå¯¾å¿œãƒ»äºˆæ¸¬æç”»ãƒ»WebGPUæœ€é©åŒ–
 * @provides: startStroke(), addStrokePoint(), endStroke()
 * @uses: PressureManagerInstance, CanvasManagerInstance
 * @initflow: 1.ã‚¨ãƒ³ã‚¸ãƒ³åˆæœŸåŒ– â†’ 2.WebGPUãƒãƒƒãƒ•ã‚¡æº–å‚™ â†’ 3.æç”»ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³æ§‹ç¯‰
 * @forbids: ğŸ’€åŒæ–¹å‘ä¾å­˜ ğŸš«ç›´æ¥Pixiæ“ä½œ ğŸš«åŒæœŸãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°
 * @manager-key: window.Tegaki.StrokeEngineInstance
 * @performance-notes: 16msç›®æ¨™ãƒ»120Hzå¯¾å¿œãƒ»WebGPUæ´»ç”¨
 */
class StrokeEngine {
    // äºˆæ¸¬æç”»ãƒ»å·®åˆ†æ›´æ–°ã‚·ã‚¹ãƒ†ãƒ 
    // 120Hzé«˜é »åº¦ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
    // WebGPUæœ€é©åŒ–ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
    initialize(): Promise<void>
    startStroke(startPoint, pressure): void
    addStrokePoint(point, pressure): void
    endStroke(): void
    enablePredictiveRendering(): void
}
```

#### 3. BrushRendererï¼ˆãƒ–ãƒ©ã‚·ãƒ¬ãƒ³ãƒ€ãƒ©ãƒ¼ï¼‰
```javascript
/**
 * ğŸ–Œï¸ BrushRenderer - ãƒ–ãƒ©ã‚·å½¢çŠ¶ãƒ»ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰å½¢
 * @provides: setBrushShape(), setTexture(), renderBrushPoint()
 * @uses: StrokeEngineInstance, TextureManagerï¼ˆæ–°è¦ï¼‰
 * @initflow: 1.ãƒ–ãƒ©ã‚·ãƒ©ã‚¤ãƒ–ãƒ©ãƒªèª­ã¿è¾¼ã¿ â†’ 2.ã‚·ã‚§ãƒ¼ãƒ€ãƒ¼æº–å‚™ â†’ 3.ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³
 * @forbids: ğŸ’€é‡è¤‡ãƒ†ã‚¯ã‚¹ãƒãƒ£èª­ã¿è¾¼ã¿ ğŸš«ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ ğŸš«ç›´æ¥Graphicsæ“ä½œ
 * @manager-key: window.Tegaki.BrushRendererInstance
 * @state-management: ãƒ†ã‚¯ã‚¹ãƒãƒ£ã¯å¿…ãšcreateTexture()çµŒç”±ã§ç®¡ç†
 */
class BrushRenderer {
    // å††å½¢ãƒ»æ¥•å††ãƒ»ã‚«ã‚¹ã‚¿ãƒ å½¢çŠ¶å¯¾å¿œ
    // ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ–ãƒ©ã‚·ãƒ»ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ«ç”Ÿæˆ
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç­†åœ§é€£å‹•å¤‰å½¢
    initialize(): Promise<void>
    setBrushShape(type, params): void
    setTexture(textureId): void
    renderBrushPoint(point, pressure, size): void
}
```

### ğŸ› ï¸ **PenToolå¤§å¹…æ‹¡å¼µ**
```javascript
/**
 * ğŸ–Šï¸ PenTool - ãƒ—ãƒ­ç´šãƒšãƒ³æ©Ÿèƒ½çµ±åˆ
 * ã€Phase1.6æ–°æ©Ÿèƒ½ã€‘
 * - ç­†åœ§æ„ŸçŸ¥æç”»ï¼ˆ0-1024æ®µéšï¼‰
 * - 120Hzé«˜é€Ÿãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼ˆ8msä»¥ä¸‹ï¼‰
 * - ç·šè£œæ­£ãƒ»ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°ãƒ»æ‰‹ãƒ–ãƒ¬è£œæ­£
 * - äºˆæ¸¬æç”»ãƒ»é…å»¶å‰Šæ¸›
 * - ãƒ–ãƒ©ã‚·ã‚¨ãƒ³ã‚¸ãƒ³çµ±åˆ
 * @uses: PressureManagerInstance, StrokeEngineInstance, BrushRendererInstance
 */
class PenTool extends AbstractTool {
    // ç­†åœ§â†’ç·šå¹…ãƒ»é€æ˜åº¦å¤‰æ›
    // åº§æ¨™ãƒ»ç­†åœ§ã‚¹ãƒ ãƒ¼ã‚¸ãƒ³ã‚°
    // 120Hzå¯¾å¿œã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
}
```

---

## ğŸ—ºï¸ **Phase1.7 - ã‚­ãƒ£ãƒ³ãƒã‚¹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆçµ±åˆ**

### ğŸ§­ **NavigationManageræ‹¡å¼µ**
```javascript
/**
 * ğŸ—ºï¸ NavigationManager - æ‹¡å¼µç‰ˆï¼ˆGPUåŠ é€Ÿãƒ»120Hzå¯¾å¿œï¼‰
 * ã€Phase1.7æ‹¡å¼µæ©Ÿèƒ½ã€‘
 * - GPU TransformåŠ é€Ÿç§»å‹•ãƒ»æ‹¡ç¸®ãƒ»å›è»¢
 * - 120Hzæ»‘ã‚‰ã‹ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
 * - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ»ãƒã‚¦ã‚¹ãƒ»ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼çµ±åˆ
 * - æ…£æ€§ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ãƒ»ã‚¹ãƒ ãƒ¼ã‚ºã‚ºãƒ¼ãƒ 
 * @uses: CoordinateManagerInstance, ShortcutManagerInstance
 * @performance-notes: WebGPU Transformãƒ»60-120FPSç¶­æŒ
 */
class NavigationManager {
    // GPUåŠ é€Ÿã‚«ãƒ¡ãƒ©å¤‰å½¢
    // æ…£æ€§ãƒ»ã‚¤ãƒ¼ã‚¸ãƒ³ã‚°ä»˜ããƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
    // ãƒãƒ«ãƒã‚¿ãƒƒãƒãƒ»ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼å¯¾å¿œ
    panCanvas(deltaX, deltaY, smooth?): void
    zoomCanvas(scale, centerPoint?, smooth?): void  
    rotateCanvas(angle, centerPoint?, smooth?): void
    resetView(smooth?): void
    enableInertialScrolling(): void
}
```

### âŒ¨ï¸ **ShortcutManagerçµ±åˆ**
```javascript
/**
 * âŒ¨ï¸ ShortcutManager - åŒ…æ‹¬çš„ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆç®¡ç†
 * ã€åŸºæœ¬æ“ä½œã€‘Ctrl+Z/Yï¼ˆGPUåŠ é€ŸUndo/Redoï¼‰ã€DELï¼ˆWebGPUæœ€é©åŒ–æ¶ˆå»ï¼‰
 * ã€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã€‘Space+ãƒ‰ãƒ©ãƒƒã‚°ï¼ˆ120Hzè¿½å¾“ç§»å‹•ï¼‰ã€ãƒ›ã‚¤ãƒ¼ãƒ«ï¼ˆGPUæ‹¡ç¸®ï¼‰
 * ã€ãƒ„ãƒ¼ãƒ«ã€‘P/E/I/G/M/Tï¼ˆ0msåˆ‡ã‚Šæ›¿ãˆï¼‰ã€[/]ï¼ˆãƒ—ãƒªã‚»ãƒƒãƒˆç§»å‹•ï¼‰
 * ã€ãƒ¬ã‚¤ãƒ¤ãƒ¼ã€‘â†‘/â†“ï¼ˆGPUæ»‘ã‚‰ã‹ç§»å‹•ï¼‰ã€H/Shift+Hï¼ˆç¬é–“åè»¢ï¼‰
 * @uses: ToolManagerInstance, NavigationManagerInstance, LayerManager
 * @integration-flow: bootstrap â†’ ShortcutManager â†’ å…¨Manageré€£æº
 */
class ShortcutManager {
    // Chrome Scheduling APIé«˜å„ªå…ˆåº¦å‡¦ç†
    // è¤‡åˆã‚­ãƒ¼ãƒ»ã‚¸ã‚§ã‚¹ãƒãƒ£ãƒ¼èªè­˜
    // æ“ä½œç«¶åˆå›é¿ãƒ»å„ªå…ˆåº¦åˆ¶å¾¡
    initializeShortcuts(): void
    registerShortcut(keys, action, priority): void
    handleKeyDown(event): void
    handlePointerGesture(event): void
}
```

### ğŸ›ï¸ **å°‚ç”¨ãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—UI**
```javascript
/**
 * ğŸ›ï¸ UnifiedPopup - TABçµ±åˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—
 * ã€çµ±åˆUIã€‘è‰²ãƒ»ãƒšãƒ³ã‚µã‚¤ã‚ºãƒ»ãƒ„ãƒ¼ãƒ«ã‚¢ã‚¤ã‚³ãƒ³ãƒ»ãƒ¬ã‚¤ãƒ¤ãƒ¼ä¸€è¦§
 * ã€GPUæœ€é©åŒ–ã€‘Chrome APIãƒ»æ»‘ã‚‰ã‹ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
 * @uses: ToolManagerInstance, LayerManager, ConfigManagerInstance
 */
class UnifiedPopup {
    // TABã‚­ãƒ¼ä¸€ç™ºè¡¨ç¤ºãƒ»éè¡¨ç¤º
    // è‰²ãƒ»ã‚µã‚¤ã‚ºãƒ»ãƒ„ãƒ¼ãƒ«çµ±åˆã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹
    // GPUåŠ é€Ÿã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³
    showPopup(): void
    hidePopup(): void
    updateToolSettings(): void
}
```

---

## ğŸ¨ **Phase2 - ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ»å¤‰å½¢ãƒ»é«˜åº¦æç”»ï¼ˆv8æœ€é©åŒ–åŸºç›¤ï¼‰**

### ğŸ“‹ **Phase2.1 - ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **

#### ğŸ¨ LayerManagerï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ¨ LayerManager - v8 Containeréšå±¤æ´»ç”¨ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†
 * @provides: createLayer(), deleteLayer(), reorderLayers(), setLayerProperties()
 * @uses: CanvasManagerInstance, EventBusInstance
 * @initflow: 1.Containeréšå±¤æ§‹ç¯‰ â†’ 2.ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†API â†’ 3.UIé€£æº
 * @forbids: ğŸ’€åŒæ–¹å‘ä¾å­˜ ğŸš«v7 @pixi/layersä¾å­˜ ğŸš«ç›´æ¥Containeræ“ä½œ
 * @manager-key: window.Tegaki.LayerManagerInstance
 * @dependencies-strict: REQUIRED[CanvasManager], OPTIONAL[UnifiedPopup]
 * @integration-flow: AppCore â†’ CanvasManager â†’ LayerManager â†’ LayerPanel
 */
class LayerManager {
    // v8 Containeræ©Ÿèƒ½ãƒ•ãƒ«æ´»ç”¨
    // WebGPUæœ€é©åŒ–ãƒ¬ã‚¤ãƒ¤ãƒ¼æç”»
    // ãƒ–ãƒ¬ãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰ãƒ»ä¸é€æ˜åº¦åˆ¶å¾¡
    createLayer(id, options): PIXI.Container
    deleteLayer(id): boolean
    duplicateLayer(sourceId, newId): PIXI.Container
    reorderLayers(layerIds): boolean
    setLayerBlendMode(id, mode): boolean
    setLayerOpacity(id, opacity): boolean
    mergeLayersDown(layerId): PIXI.Container
}
```

#### ğŸ–¼ï¸ LayerPanelï¼ˆãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—çµ±åˆï¼‰
```javascript
/**
 * ğŸ–¼ï¸ LayerPanel - UnifiedPopupçµ±åˆãƒ¬ã‚¤ãƒ¤ãƒ¼UI
 * @uses: LayerManagerInstance, UnifiedPopup
 * @integration-flow: TAB â†’ UnifiedPopup â†’ LayerPanelè¡¨ç¤º
 */
class LayerPanel {
    // TABãƒãƒƒãƒ—ã‚¢ãƒƒãƒ—å†…ã§ãƒ¬ã‚¤ãƒ¤ãƒ¼ç®¡ç†
    // ãƒ‰ãƒ©ãƒƒã‚°&ãƒ‰ãƒ­ãƒƒãƒ—é †åºå¤‰æ›´
    // è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãƒ»GPUåŠ é€Ÿ
}
```

### ğŸ“‹ **Phase2.2 - é¸æŠãƒ»å¤‰å½¢ã‚·ã‚¹ãƒ†ãƒ **

#### âœ‚ï¸ SelectionManagerï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * âœ‚ï¸ SelectionManager - ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆé¸æŠç®¡ç†
 * @provides: selectRectangle(), selectEllipse(), selectLasso(), getSelectedObjects()
 * @uses: CanvasManagerInstance, CoordinateManagerInstance
 * @initflow: 1.é¸æŠãƒ„ãƒ¼ãƒ«åˆæœŸåŒ– â†’ 2.é¸æŠç¯„å›²ç®—å‡º â†’ 3.TransformToolé€£æº
 * @forbids: ğŸ’€ç›´æ¥Graphicsæ“ä½œ ğŸš«ManagerçµŒç”±ã›ãšå¤‰å½¢ ğŸš«é¸æŠçŠ¶æ…‹ä¸æ•´åˆ
 * @manager-key: window.Tegaki.SelectionManagerInstance
 * @state-management: é¸æŠçŠ¶æ…‹ã¯å¿…ãšupdateSelection()çµŒç”±ã§å¤‰æ›´
 */
class SelectionManager {
    // v8é«˜ç²¾åº¦åº§æ¨™é¸æŠ
    // ãƒãƒ«ãƒé¸æŠãƒ»é¸æŠç¯„å›²ä¿å­˜
    // GPUåŠ é€Ÿé¸æŠãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯
    selectRectangle(x1, y1, x2, y2): Array<PIXI.DisplayObject>
    selectEllipse(centerX, centerY, radiusX, radiusY): Array<PIXI.DisplayObject>
    selectLasso(points): Array<PIXI.DisplayObject>
    selectAll(): Array<PIXI.DisplayObject>
    clearSelection(): boolean
    getSelectionBounds(): PIXI.Rectangle
}
```

#### ğŸ”„ TransformToolï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ”„ TransformTool - é¸æŠã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå¤‰å½¢
 * @provides: transformSelected(), showTransformHandles(), applyTransform()
 * @uses: SelectionManagerInstance, CoordinateManagerInstance
 * @forbids: ğŸš«ç›´æ¥transformæ“ä½œ ğŸš«åº§æ¨™è¨ˆç®—ãƒŸã‚¹ ğŸš«å¤‰å½¢çŠ¶æ…‹ä¸æ•´åˆ
 * @manager-key: window.Tegaki.TransformToolInstance
 * @performance-notes: v8é«˜ç²¾åº¦å¤‰å½¢ãƒ»WebGPUåŠ é€Ÿãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰å½¢
 */
class TransformTool extends AbstractTool {
    // v8é«˜ç²¾åº¦å¤‰å½¢ãƒ»WebGPUåŠ é€Ÿ
    // ç§»å‹•ãƒ»å›è»¢ãƒ»æ‹¡å¤§ç¸®å°ãƒãƒ³ãƒ‰ãƒ«
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰å½¢ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼
    showTransformHandles(selection): void
    startTransform(handleType, startPoint): void
    updateTransform(currentPoint): void
    applyTransform(): void
}
```

### ğŸ“‹ **Phase2.3 - é«˜åº¦æç”»ãƒ„ãƒ¼ãƒ«**

#### ğŸ–Œï¸ BrushToolï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ–Œï¸ BrushTool - ãƒ†ã‚¯ã‚¹ãƒãƒ£å¯¾å¿œãƒ–ãƒ©ã‚·ï¼ˆPenToolæ‹¡å¼µç‰ˆï¼‰
 * @uses: BrushRendererInstance, PressureManagerInstance
 * @integration-flow: BrushRenderer â†’ PenToolæ‹¡å¼µ â†’ BrushToolç‹¬ç«‹
 */
class BrushTool extends AbstractTool {
    // ãƒ†ã‚¯ã‚¹ãƒãƒ£ãƒ–ãƒ©ã‚·ãƒ»åœ§åŠ›æ„ŸçŸ¥
    // ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ãƒ«ç”Ÿæˆãƒ»ãƒ‘ãƒ¼ãƒ†ã‚£ã‚¯ãƒ«
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å¤‰å½¢
}
```

#### ğŸ”º ShapeToolï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ”º ShapeTool - å›³å½¢æç”»ãƒ„ãƒ¼ãƒ«
 * @uses: CanvasManagerInstance, CoordinateManagerInstance
 */
class ShapeTool extends AbstractTool {
    // v8 Graphicsæ´»ç”¨å›³å½¢æç”»
    // ã‚°ãƒªãƒƒãƒ‰ã‚¹ãƒŠãƒƒãƒ—ãƒ»æ¯”ä¾‹ç¶­æŒ
    // çŸ©å½¢ãƒ»æ¥•å††ãƒ»å¤šè§’å½¢ãƒ»ç›´ç·š
}
```

#### ğŸ¨ FillToolï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ¨ FillTool - å¡—ã‚Šã¤ã¶ã—ãƒ»ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
 * @uses: CanvasManagerInstance, ColorManagerï¼ˆæ–°è¦ï¼‰
 */
class FillTool extends AbstractTool {
    // ãƒ•ãƒ©ãƒƒãƒ‰ãƒ•ã‚£ãƒ«ãƒ»ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
    // ãƒ‘ã‚¿ãƒ¼ãƒ³å¡—ã‚Šãƒ»WebGPUæœ€é©åŒ–
    // ç„¡é™ãƒ«ãƒ¼ãƒ—é˜²æ­¢ãƒ»ãƒ¡ãƒ¢ãƒªç®¡ç†
}
```

---

## ğŸš€ **Phase3 - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»å‡ºåŠ›ãƒ»æœ€é©åŒ–ï¼ˆv8æœ€é©åŒ–ï¼‰**

### ğŸ“‹ **Phase3.1 - ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½**

#### ğŸ¬ AnimationManagerï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ¬ AnimationManager - ãƒ•ãƒ¬ãƒ¼ãƒ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç®¡ç†
 * @provides: createFrame(), deleteFrame(), playAnimation(), exportGIF()
 * @uses: CanvasManagerInstance, RecordManagerInstance, @esotericsoftware/spine-pixi-v8
 * @initflow: 1.ãƒ•ãƒ¬ãƒ¼ãƒ ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  â†’ 2.ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³ â†’ 3.Spineç‰©ç†çµ±åˆ
 * @forbids: ğŸ’€ãƒ•ãƒ¬ãƒ¼ãƒ é‡è¤‡ä½œæˆ ğŸš«ãƒ¡ãƒ¢ãƒªãƒªãƒ¼ã‚¯ ğŸš«åŒæœŸãƒ–ãƒ­ãƒƒã‚­ãƒ³ã‚°
 * @manager-key: window.Tegaki.AnimationManagerInstance
 * @performance-notes: v8 RenderTextureæ´»ç”¨ãƒ»ãƒ•ãƒ¬ãƒ¼ãƒ æœ€é©åŒ–ãƒ»60-120FPS
 */
class AnimationManager {
    // ãƒ•ãƒ¬ãƒ¼ãƒ ç®¡ç†ãƒ»ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³åˆ¶å¾¡
    // ã‚ªãƒ‹ã‚ªãƒ³ã‚¹ã‚­ãƒ³ãƒ»Spineçµ±åˆåŸºç›¤
    // GIFãƒ»WebMå‡ºåŠ›
    createFrame(index): AnimationFrame
    duplicateFrame(sourceIndex, targetIndex): AnimationFrame
    playAnimation(startFrame?, endFrame?): void
    exportToGIF(options): Blob
    initializeSpineSupport(): Promise<void>  // Spineçµ±åˆ
}
```

#### ğŸï¸ Timelineï¼ˆã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆçµ±åˆï¼‰
```javascript
/**
 * ğŸï¸ Timeline - ã‚¿ã‚¤ãƒ ãƒ©ã‚¤ãƒ³UIï¼ˆã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆçµ±åˆï¼‰
 * ã€ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å°‚ç”¨ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€‘
 * - â†/â†’ï¼ˆã‚«ãƒƒãƒˆç§»å‹•ï¼‰ã€Shift+â†/â†’ï¼ˆ5ã‚«ãƒƒãƒˆé£›ã°ã—ï¼‰
 * - ALT+Spaceï¼ˆ120FPSå†ç”Ÿ/åœæ­¢ï¼‰ã€ALT+J/Lï¼ˆã‚·ãƒ£ãƒˆãƒ«ï¼‰
 * - ALT+â†/â†’ï¼ˆãƒ•ãƒ¬ãƒ¼ãƒ ç§»å‹•ï¼‰ã€ALT+Oï¼ˆã‚ªãƒ‹ã‚ªãƒ³ã‚¹ã‚­ãƒ³ï¼‰
 * @uses: AnimationManagerInstance, ShortcutManagerInstance
 */
class Timeline {
    // ãƒ•ãƒ¬ãƒ¼ãƒ è¡¨ç¤ºãƒ»ã‚¹ã‚¯ãƒ©ãƒ–ãƒ»ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 
    // WebCodecsçµ±åˆãƒ»120FPSç²¾å¯†åˆ¶å¾¡
    // ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆçµ±åˆãƒ»è¦–è¦šçš„æ“ä½œ
}
```

#### ğŸ§… OnionSkinï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ§… OnionSkin - å‰å¾Œãƒ•ãƒ¬ãƒ¼ãƒ è¡¨ç¤º
 * @uses: AnimationManagerInstance, CanvasManagerInstance
 */
class OnionSkin {
    // v8åŠé€æ˜ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
    // å‰å¾Œãƒ•ãƒ¬ãƒ¼ãƒ åŠé€æ˜è¡¨ç¤º
    // å‹•çš„è¡¨ç¤ºåˆ‡æ›¿ãƒ»è¨­å®šç®¡ç†
}
```

### ğŸ“‹ **Phase3.2 - é«˜å“è³ªå‡ºåŠ›ãƒ»Spineçµ±åˆ**

#### ğŸ“¤ ExportManagerï¼ˆSpineçµ±åˆï¼‰
```javascript
/**
 * ğŸ“¤ ExportManager - é«˜å“è³ªå‡ºåŠ›ãƒ»Spineçµ±åˆ
 * @uses: CanvasManagerInstance, AnimationManagerInstance, @esotericsoftware/spine-pixi-v8
 * @integration-flow: æç”»â†’TPFâ†’Spineå¤‰æ›â†’ç‰©ç†æ¼”ç®—â†’å‡ºåŠ›
 */
class ExportManager {
    // PNGãƒ»JPEGãƒ»GIFãƒ»SVGå‡ºåŠ›
    // Spineå½¢å¼å‡ºåŠ›ãƒ»ç‰©ç†æ¼”ç®—çµ±åˆ
    // é«˜è§£åƒåº¦ãƒ»ãƒãƒƒãƒå‡ºåŠ›
    exportPNG(options): Blob
    exportSpineProject(options): {skeleton, atlas, animations}
    exportWithPhysics(options): Blob  // ç‰©ç†æ¼”ç®—çµ±åˆ
}
```

#### ğŸ¦´ SpineIntegrationï¼ˆæ–°è¦å®Ÿè£…ï¼‰
```javascript
/**
 * ğŸ¦´ SpineIntegration - Spineç‰©ç†æ¼”ç®—çµ±åˆ
 * @uses: @esotericsoftware/spine-pixi-v8, AnimationManagerInstance
 */
class SpineIntegration {
    // æç”»ã‚¹ãƒˆãƒ­ãƒ¼ã‚¯â†’ãƒœãƒ¼ãƒ³å¤‰æ›
    // ç‰©ç†æ¼”ç®—å¯¾å¿œãƒ‡ãƒ¼ã‚¿æ§‹é€ 
    // ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³åˆ¶å¾¡ç‚¹ç”Ÿæˆ
    convertStrokesToSkeleton(strokes): SpineSkeleton
    applyPhysicsSimulation(skeleton, params): void
    exportSpineAnimation(skeleton, timeline): SpineAnimation
}
```

### ğŸ“‹ **Phase3.3 - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**

#### âš¡ PerformanceMonitorï¼ˆçµ±åˆç›£è¦–ï¼‰
```javascript
/**
 * âš¡ PerformanceMonitor - åŒ…æ‹¬çš„æ€§èƒ½ç›£è¦–
 * ã€ç›£è¦–é …ç›®ã€‘FPSãƒ»ãƒ¡ãƒ¢ãƒªãƒ»æç”»æ™‚é–“ãƒ»WebGPUä½¿ç”¨ç‡ãƒ»ç­†åœ§ãƒ¬ã‚¹ãƒãƒ³ã‚¹
 * ã€ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆã€‘Ctrl+Shift+Pï¼ˆæ€§èƒ½ç›£è¦–è¡¨ç¤ºï¼‰
 * @uses: ãªã—ï¼ˆç‹¬ç«‹ç›£è¦–ï¼‰
 */
class PerformanceMonitor {
    // ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ç›£è¦–ãƒ»æœ€é©åŒ–ææ¡ˆ
    // WebGPUä½¿ç”¨ç‡ãƒ»ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡
    // 120Hzå¯¾å¿œãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è¨ˆæ¸¬
    startMonitoring(): void
    getPerformanceReport(): PerformanceReport
    suggestOptimizations(): Array<OptimizationSuggestion>
}
```

---

## ğŸ”„ **å®Ÿè£…é †åºãƒ»çµ±åˆãƒ•ãƒ­ãƒ¼**

### ğŸ“‹ **Phase1.6-1.8 å®Ÿè£…é †åº**
```
Phase1.6: PressureManager â†’ StrokeEngine â†’ BrushRenderer â†’ PenToolæ‹¡å¼µ
    â†“
Phase1.7: NavigationManageræ‹¡å¼µ â†’ ShortcutManager â†’ UnifiedPopup
    â†“  
Phase1.8: çµ±åˆãƒ†ã‚¹ãƒˆãƒ»æœ€é©åŒ–ãƒ»Phase2æº–å‚™å®Œäº†
```

### ğŸ“‹ **Phase2-3 å®Ÿè£…é †åº**
```
Phase2.1: LayerManager â†’ LayerPanelçµ±åˆ
    â†“
Phase2.2: SelectionManager â†’ TransformTool
    â†“
Phase2.3: BrushTool â†’ ShapeTool â†’ FillTool
    â†“
Phase3.1: AnimationManager â†’ Timeline â†’ OnionSkin
    â†“
Phase3.2: ExportManager â†’ SpineIntegration
    â†“
Phase3.3: PerformanceMonitor â†’ æœ€çµ‚çµ±åˆ
```

---

## ğŸ¯ **æŠ€è¡“ä»•æ§˜ãƒ»æˆåŠŸåŸºæº–**

### âš¡ **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›®æ¨™**
- **ç­†åœ§ãƒ¬ã‚¹ãƒãƒ³ã‚¹**: 8msä»¥ä¸‹ï¼ˆ120Hzç’°å¢ƒï¼‰
- **æç”»ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¬ãƒ¼ãƒˆ**: å®‰å®š60FPSã€120Hzç’°å¢ƒã§120FPS
- **ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡**: Phase2ã§+50%ä»¥ä¸‹ã€Phase3ã§+100%ä»¥ä¸‹
- **èµ·å‹•æ™‚é–“**: Phase3å®Œäº†å¾Œã‚‚5ç§’ä»¥å†…

### ğŸ¨ **å“è³ªç›®æ¨™**
- **ç­†åœ§ç²¾åº¦**: 1024æ®µéšæ»‘ã‚‰ã‹ãªå¤‰åŒ–
- **ç·šè£œæ­£**: æ‰‹ãƒ–ãƒ¬80%ä»¥ä¸Šå‰Šæ¸›
- **æ“ä½œãƒ¬ã‚¹ãƒãƒ³ã‚¹**: é…å»¶ã‚’æ„Ÿã˜ãªã„åå¿œé€Ÿåº¦
- **é•·æ™‚é–“å®‰å®šæ€§**: é€£ç¶šæç”»ã§ã‚‚æ€§èƒ½åŠ£åŒ–ãªã—

### ğŸ“Š **æ©Ÿèƒ½é”æˆåŸºæº–**
- **Phase1.8**: ãƒ—ãƒ­ãƒšãƒ³ãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆå®Œå…¨å‹•ä½œ
- **Phase2**: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ»é¸æŠå¤‰å½¢ãƒ»é«˜åº¦æç”»å®Œå…¨å‹•ä½œ
- **Phase3**: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»Spineçµ±åˆãƒ»å‡ºåŠ›æ©Ÿèƒ½å®Œå…¨å‹•ä½œ

---

## ğŸš¨ **å®Ÿè£…åŸå‰‡ãƒ»ç¦æ­¢äº‹é …**

### ğŸ’€ **çµ¶å¯¾ç¦æ­¢ï¼ˆç¶™ç¶šï¼‰**
- Phaseæœªå®Œäº†ã§ã®æ¬¡Phaseç€æ‰‹
- æ¶ç©ºãƒ¡ã‚½ãƒƒãƒ‰å‘¼ã³å‡ºã—ï¼ˆå®Ÿè£…å‰ãƒ¡ã‚½ãƒƒãƒ‰ä½¿ç”¨ç¦æ­¢ï¼‰
- ManagerçµŒç”±ã—ãªã„ç›´æ¥æ“ä½œ
- ã‚¨ãƒ©ãƒ¼æ¡ã‚Šã¤ã¶ã—ãƒ»ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãƒ»ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•
- v7/v8äºŒé‡ç®¡ç†

### âœ… **å¿…é ˆéµå®ˆï¼ˆç¶™ç¶šï¼‰**
- æ®µéšçš„å®Ÿè£…ãƒ»æ—¢å­˜æ©Ÿèƒ½ä¿è­·
- v8æ©Ÿèƒ½ãƒ•ãƒ«æ´»ç”¨ãƒ»WebGPUæœ€é©åŒ–
- çµ±åˆãƒ†ã‚¹ãƒˆå®Ÿæ–½ãƒ»æ€§èƒ½ç›£è¦–ç¶™ç¶š
- TPF v0.2ãƒ‡ãƒ¼ã‚¿å½¢å¼çµ±ä¸€
- å…¨ã‚¯ãƒ©ã‚¹ãƒ»é–¢æ•°ã®window.Tegakiåå‰ç©ºé–“å…¬é–‹

---

## ğŸ“¦ **ä¾å­˜é–¢ä¿‚ãƒ»ãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ§‹æˆ**

### âœ… **æ—¢å­˜package.jsonæ´»ç”¨**
```json
{
  "dependencies": {
    "pixi.js": "^8.0.0",
    "pressure": "^2.2.0"  // ç­†åœ§æ¤œå‡ºå¼·åŒ–
  }
}
```

### ğŸš€ **Phaseåˆ¥è¿½åŠ ãƒ©ã‚¤ãƒ–ãƒ©ãƒª**
```javascript
// Phase1.6-1.7: ãƒ—ãƒ­ãƒšãƒ³ãƒ»ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
// pressure.js: PointerEvent.pressureå¼·åŒ–ï¼ˆæ—¢å­˜package.jsonå¯¾å¿œï¼‰

// Phase2: ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒ»å¤‰å½¢ãƒ»é«˜åº¦æç”»
"@pixi/graphics-extras": "v8å¯¾å¿œç‰ˆ"  // é«˜åº¦å›³å½¢
"@pixi/math-extras": "v8å¯¾å¿œç‰ˆ"      // æ•°å­¦è¨ˆç®—å¼·åŒ–
"@pixi/ui": "^2.1.0"                // UI ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆæ‹¡å¼µ

// Phase3: ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ»Spineçµ±åˆãƒ»å‡ºåŠ›
"@esotericsoftware/spine-pixi-v8": "^4.2.89"  // å…¬å¼Spine v8å¯¾å¿œ
"gif.js": "^0.2.0"                            // GIFç”Ÿæˆæœ€é©åŒ–
"stats.js": "^0.17.0"                         // FPS/ãƒ¡ãƒ¢ãƒªç›£è¦–
```

### ğŸš« **ä½¿ç”¨ç¦æ­¢ï¼ˆç¶™ç¶šï¼‰**
- TypeScriptãƒ»ESMãƒ»ãƒ“ãƒ«ãƒ‰ãƒ„ãƒ¼ãƒ«
- jQueryãƒ»å¤ã„ãƒ©ã‚¤ãƒ–ãƒ©ãƒª
- v8éå¯¾å¿œãƒ©ã‚¤ãƒ–ãƒ©ãƒª

---

**ğŸ¯ çµ±åˆç›®æ¨™**: ãƒ—ãƒ­ã‚¯ãƒªã‚¨ã‚¤ãƒˆç´šæç”»ä½“é¨“ã‚’Webã§å®Ÿç¾ã—ã€Spineç‰©ç†æ¼”ç®—ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ã¸ã®å®Œå…¨å¯¾å¿œã‚’é”æˆã™ã‚‹

**ğŸ“ å®Ÿè£…æ–¹é‡**: æ®µéšçš„å“è³ªå‘ä¸Šãƒ»æ—¢å­˜æ©Ÿèƒ½ä¿è­·ãƒ»ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ç›£è¦–ãƒ»ã‚¨ãƒ©ãƒ¼æ’²æ»…ç¶™ç¶š

**ğŸ’€ åŸºæœ¬åŸå‰‡**: æ€ªç‰©ã‚³ãƒ¼ãƒ‰æ’²æ»…ãƒ»æ¶ç©ºãƒ¡ã‚½ãƒƒãƒ‰æ’²æ»…ãƒ»ã‚¨ãƒ©ãƒ¼éš è”½ç¦æ­¢ãƒ»Managerçµ±ä¸€API

**ğŸš€ æœ€çµ‚æˆæœ**: ãƒ—ãƒ­å“è³ªWebãƒ™ãƒ¼ã‚¹æç”»ãƒ»ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«